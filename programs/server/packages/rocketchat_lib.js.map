{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:lib/lib/core.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/settings.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/RoomTypeConfig.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/roomTypes/conversation.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/roomTypes/direct.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/roomTypes/favorite.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/roomTypes/index.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/roomTypes/private.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/roomTypes/public.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/roomTypes/unread.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/getURL.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/callbacks.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/fileUploadRestrictions.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/getAvatarColor.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/getDefaultSubscriptionPref.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/getValidRoomName.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/placeholders.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/promises.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/RoomTypesCommon.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/slashCommand.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/Message.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/MessageProperties.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/messageBox.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/MessageTypes.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/templateVarHandler.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/getUserNotificationPreference.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/getUserPreference.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/startup/settingsOnLoadSiteUrl.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/debug.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/bugsnag.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/metrics.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/RateLimiter.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/configLogger.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/PushNotification.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/defaultBlockedDomainsList.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/interceptDirectReplyEmails.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/loginErrorMessageOverride.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/notifyUsersOnMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/processDirectEmail.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/roomTypes.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/sendNotificationsOnMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/validateEmailDomain.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/passwordPolicy.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/index.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/PasswordPolicyClass.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/isDocker.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/addUserToDefaultChannels.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/addUserToRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/archiveRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/checkUsernameAvailability.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/checkEmailAvailability.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/createRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/deleteMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/deleteUser.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/getFullUserData.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/getRoomByNameOrIdWithOptionToJoin.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/loadMessageHistory.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/removeUserFromRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/saveUser.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/saveCustomFields.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/saveCustomFieldsWithoutValidation.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/sendMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/settings.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/setUserAvatar.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/setUsername.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/setRealName.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/setEmail.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/unarchiveRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/updateMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/validateCustomFields.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/Notifications.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/notifications/audio.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/notifications/desktop.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/notifications/email.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/notifications/index.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/notifications/mobile.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/_Base.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/Avatars.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/Messages.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/Reports.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/Rooms.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/Settings.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/Subscriptions.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/Uploads.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/Users.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/ExportOperations.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/UserDataFiles.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/_BaseCache.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/_BaseDb.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/oauth/oauth.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/oauth/facebook.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/oauth/twitter.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/oauth/google.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/oauth/proxy.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/startup/statsTracker.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/startup/cache/CacheLoad.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/startup/settingsOnLoadCdnPrefix.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/startup/settingsOnLoadDirectReply.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/startup/settingsOnLoadSMTP.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/startup/oAuthServicesUpdate.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/startup/settings.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/publications/settings.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/addOAuthService.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/refreshOAuthService.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/addUserToRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/addUsersToRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/archiveRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/blockUser.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/checkRegistrationSecretURL.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/checkUsernameAvailability.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/cleanChannelHistory.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/cleanRoomHistory.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/createChannel.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/createToken.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/createPrivateGroup.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/deleteMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/deleteUserOwnAccount.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/executeSlashCommandPreview.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/filterBadWords.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/filterATAllTag.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/filterATHereTag.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/getChannelHistory.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/getFullUserData.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/getRoomJoinCode.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/getRoomRoles.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/getServerInfo.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/getSingleMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/getSlashCommandPreviews.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/getUserRoles.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/insertOrUpdateUser.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/joinDefaultChannels.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/joinRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/leaveRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/removeOAuthService.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/restartServer.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/robotMethods.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/saveSetting.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/sendInvitationEmail.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/sendMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/sendSMTPTestEmail.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/setAdminStatus.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/setRealName.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/setUsername.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/setEmail.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/unarchiveRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/unblockUser.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/updateMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/startup/defaultRoomTypes.js"],"names":["EventEmitter","module","watch","require","default","v","RocketChat","models","_","settings","callbacks","regexCallbacks","ts","Date","get","_id","callback","onload","Meteor","Object","keys","forEach","key","value","isRegExp","test","reduce","items","push","set","call","batchSet","save","setting","editor","actions","map","reduceRight","wrap","err","success","load","initialLoad","item","cbKey","cbValue","regex","concat","k","name","source","export","RoomSettingsEnum","UiTextContext","RoomTypeRouteConfig","RoomTypeConfig","NAME","TOPIC","ANNOUNCEMENT","DESCRIPTION","READ_ONLY","REACT_WHEN_READ_ONLY","ARCHIVE_OR_UNARCHIVE","JOIN_CODE","BROADCAST","SYSTEM_MESSAGES","CLOSE_WARNING","HIDE_WARNING","LEAVE_WARNING","NO_ROOMS_SUBSCRIBED","constructor","path","length","Error","_name","_path","identifier","Random","id","order","icon","header","label","route","_identifier","_order","_icon","_header","_label","_route","getDisplayName","room","allowRoomSettingChange","canBeCreated","isServer","authz","hasAtLeastOnePermission","userId","canBeDeleted","t","supportMembersList","isGroupChat","canAddUser","userDetailShowAll","userDetailShowAdmin","preventRenaming","includeInRoomSearch","enableMembersListProfile","getUiText","ConversationRoomType","condition","getUserPreference","DirectMessageRoomRoute","DirectMessageRoomType","action","params","openRoom","username","link","sub","findRoom","query","subscription","Subscriptions","findOne","rid","ChatRoom","roomName","roomData","fields","fname","secondaryRoomName","groupByType","getUserStatus","roomId","Session","usernames","join","context","FavoriteRoomType","PrivateRoomType","PublicRoomType","UnreadRoomType","PrivateRoomRoute","hasAllPermission","broadcast","ro","PublicRoomRoute","showJoinLink","unread","s","getURL","cdn","full","cdnPrefix","rtrim","trim","pathPrefix","__meteor_runtime_config__","ROOT_URL_PATH_PREFIX","basePath","finalPath","ltrim","isCordova","absoluteUrl","showTime","showTotalTime","priority","HIGH","MEDIUM","LOW","add","hook","isNumber","stack","find","cb","remove","hookName","reject","run","constant","rocketchatHooksEnd","metrics","rocketchatHooks","startTimer","callbacks_length","totalTime","result","sortBy","rocketchatCallbacksEnd","rocketchatCallbacks","time","now","callbackResult","currentTime","statsTracker","timing","split","match","console","log","String","runAsync","defer","fileUploadMediaWhiteList","mediaTypeWhiteList","fileUploadIsValidContentType","type","list","contains","wildCardGlob","wildcards","filter","indexOf","replace","colors","getAvatarColor","getDefaultSubscriptionPref","_getDefaultSubscriptionPref","userPref","desktopNotifications","mobileNotifications","emailNotificationMode","highlights","preferences","Array","isArray","userHighlights","desktopPrefOrigin","mobilePushNotifications","mobilePrefOrigin","emailNotifications","emailPrefOrigin","getValidRoomName","displayName","slugifiedName","Rooms","findOneByDisplayName","archived","function","channel_name","slugify","nameValidation","RegExp","error","findOneByName","tmpName","next","findOneByNameAndNotId","placeholders","str","data","strLeft","strRightBack","email","password","reason","user","unsubscribe","promises","p","Promise","resolve","previousPromise","then","RoomTypesCommon","roomTypes","roomTypesOrder","mainOrder","roomConfig","routeConfig","isClient","triggersExit","roomExit","FlowRouter","hasCustomLink","roomType","getRouteLink","subData","routeData","openRouteLink","queryParams","go","slashCommands","commands","_addingSlashCommand","command","options","providesPreview","previewer","previewCallback","description","permission","clientOnly","_runningSlashCommand","message","getPreviews","_gettingSlashCommandPreviews","previewInfo","slice","executePreview","_executeSlashCommandPreview","preview","methods","slashCommand","method","cmd","msg","Message","parse","language","messageType","MessageTypes","getType","render","template","localStorage","getItem","TAPi18n","__","u","html","escapeHTML","messageProperties","GraphemeSplitter","splitter","countGraphemes","messageWithoutEmojiShortnames","emoji","undefined","messageBox","group","config","actionExists","ret","getById","messageActions","types","registerType","isSystemMessage","system","startup","room_name","user_by","user_added","user_removed","user_left","user_muted","user_unmuted","role","logger","Logger","templateVarHandler","variable","object","templateRegex","exec","tmpVariable","hasOwnProperty","debug","tmplVar","tmplAttrName","attrVal","getUserNotificationPreference","_getUserNotificationPreference","pref","Users","findOneById","preferenceKey","origin","serverValue","defaultValue","preference","host","ROOT_URL","defaultOptions","rootUrl","hostname","process","env","MOBILE_ROOT_URL","MOBILE_DDP_URL","WebAppInternals","generateBoilerplate","publish","Log_Trace_Methods","Log_Trace_Subscriptions","Log_Trace_Methods_Filter","Log_Trace_Subscriptions_Filter","traceConnection","enable","prefix","connection","clientAddress","httpHeaders","wrapMethods","originalHandler","methodsMap","end","meteorMethods","args","prototype","arguments","unblock","apply","originalMeteorMethods","methodMap","each","handler","originalMeteorPublish","func","meteorSubscriptions","originalReady","ready","WebApp","rawConnectHandlers","use","req","res","setHeader","InstanceStatus","bugsnag","register","notify","Info","app","version","info","on","bindEnvironment","originalMeteorDebug","_debug","client","connect","http","promclient","collectDefaultMetrics","Summary","help","labelNames","rocketchatRestApi","messagesSent","Counter","notificationsSent","ddpSessions","Gauge","ddpAthenticatedSessions","ddpConnectedUsers","migration","instanceCount","oplogEnabled","totalUsers","activeUsers","nonActiveUsers","onlineUsers","awayUsers","offlineUsers","totalRooms","totalChannels","totalPrivateGroups","totalDirect","totalLivechat","totalMessages","totalChannelMessages","totalPrivateGroupMessages","totalDirectMessages","totalLivechatMessages","setDefaultLabels","uniqueId","siteUrl","setPrometheusData","date","unique_id","site_url","sessions","values","server","authenticatedSessions","unique","Statistics","statistics","findLast","Migrations","_getControl","enabled","createServer","timer","updatePrometheusConfig","port","listen","BIND_IP","setInterval","close","clearInterval","RateLimiter","limitFunction","fn","numRequests","timeInterval","matchers","TEST_MODE","rateLimiter","addRule","matcher","increment","rateLimitResult","check","allowed","Math","ceil","timeToReset","seconds","limitMethod","methodName","DDPRateLimiter","LoggerManager","showPackage","showFileAndLine","logLevel","parseInt","setTimeout","PushNotification","getNotificationId","serverId","hash","i","charCodeAt","send","usersTo","payload","badge","category","title","url","defaultUrl","from","sound","text","notId","gcm","style","summaryText","image","apn","inc","notification_type","Push","emailDomainDefaultBlackList","IMAPIntercepter","POP3Intercepter","POP3Helper","IMAP","POP3","simpleParser","imap","tls","connTimeout","keepalive","delete","state","openInbox","getEmails","openBox","start","isActive","stop","Function","once","restart","search","newEmails","f","fetch","bodies","struct","markSeen","seqno","stream","headerBuffer","bodyBuffer","chunk","which","toString","body","headers","parseHeader","to","seq","addFlags","processDirectEmail","pop3","enabletls","totalMsgCount","currentMsgCount","login","status","msgcount","retr","quit","msgnumber","mail","initialProcess","dele","messageId","running","max","_runLoginHandlers","Accounts","methodInvocation","messageContainsHighlight","moment","some","highlight","regexp","escapeRegExp","notifyUsersOnMessage","editedAt","abs","diff","incMsgCountById","lastMessage","setLastMessageById","toAll","toHere","mentionIds","highlightsIds","findByRoomWithUserHighlights","mentions","mention","unreadCountDM","incUnreadForRoomIdExcludingUserId","incGroupMentionsAndUnreadForRoomIdExcludingUserId","incUserMentionsAndUnreadForRoomIdAndUserIds","compact","unreadCount","incUnread","includes","incMsgCountAndSetLastMessageById","setAlertForRoomIdExcludingUserId","setOpenForRoomIdExcludingUserId","reply","EmailReplyParser","sendMessage","sentByEmail","groupable","tsDiff","findOneByEmailAddress","prevMessage","Messages","mid","roomInfo","prevMessageLink","findOneByRoomIdAndUserId","blocked","blocker","muted","alias","parse_reply","roomTypesServer","setPublish","setRoomFind","roomFind","getRoomFind","getRoomName","runPublish","scope","callJoinRoom","parseMessageTextPerUser","replaceMentionedUsernamesWithFullNames","sendEmail","shouldNotifyEmail","sendSinglePush","shouldNotifyMobile","notifyDesktopUser","shouldNotifyDesktop","notifyAudioUser","shouldNotifyAudio","sendNotification","sender","hasMentionToAll","hasMentionToHere","notificationMessage","disableAllMessageNotifications","disableNotifications","ignored","hasMentionToUser","muteGroupMentions","receiver","active","isHighlighted","audioNotifications","notificationSent","duration","desktopNotificationDuration","statusConnection","senderUsername","senderName","receiverUsername","emails","verified","emailAddress","address","Sandstorm","sendAllNotifications","mentionIdsWithoutGroups","maxMembersForNotification","$or","$exists","kind","notificationField","$ne","$in","serverField","serverPreference","subscriptions","findNotificationPreferencesByRoom","all","users","dns","emailDomainBlackList","emailDomainWhiteList","useDefaultBlackList","useDNSDomainCheck","domain","validateEmailDomain","emailValidation","emailDomain","substr","lastIndexOf","wrapAsync","resolveMx","e","PasswordPolicy","passwordPolicy","minLength","maxLength","forbidRepeatingCharacters","forbidRepeatingCharactersCount","mustContainAtLeastOneLowercase","mustContainAtLeastOneUppercase","mustContainAtLeastOneNumber","mustContainAtLeastOneSpecialCharacter","throwError","_forbidRepeatingCharactersCount","forbiddingRepeatingCharacters","validate","exportDefault","fs","hasDockerEnv","statSync","hasDockerCGroup","readFileSync","isDocker","addUserToDefaultChannels","silenced","defaultRooms","findByDefaultAndTypes","hasPermission","addUsernameById","createWithRoomAndUser","open","alert","userMentions","groupMentions","createUserJoinWithRoomIdAndUser","addUserToRoom","inviter","createUserAddedWithRoomIdAndUser","archiveRoom","archiveById","archiveByRoomId","checkUsernameAvailability","usernameBlackList","every","restrictedUsername","$regex","checkEmailAvailability","createRoom","owner","members","readOnly","extraData","findOneByUsername","reactWhenReadOnly","assign","msgs","sysMes","Apps","isLoaded","prevent","await","getBridges","getListenerBridge","roomEvent","createWithFullRoomData","member","isTheOwner","muteUsernameByRoomId","extra","ls","addUserRoles","deleteMessage","keepHistory","showDeletedStatus","deletedMsg","messageEvent","cloneAndSaveAsHistoryById","setHiddenById","file","Uploads","update","$set","_hidden","removeById","FileUpload","getStore","deleteById","getLastVisibleMessageSentWithNoTypeByRoomId","setAsDeletedByIdAndUser","Notifications","notifyRoom","deleteUser","messageErasureType","removeByUserId","rocketCat","findById","nameAlias","unlinkUserId","db","findByUserId","removeByRoomId","removeByTypeContainingUsername","removeUsernameFromAll","avatarOrigin","deleteByName","Integrations","disableByUserId","getFullUserData","limit","utcOffset","extend","phone","createdAt","lastLogin","services","requirePasswordChange","requirePasswordChangeReason","roles","customFields","sort","findByUsername","filterReg","findByUsernameNameOrEmailAddress","getRoomByNameOrIdWithOptionToJoin","_getRoomByNameOrIdWithOptionToJoin","currentUserId","nameOrId","tryDirectByUserIdOnly","joinChannel","errorOnEmpty","startsWith","substring","findOneByIdOrName","roomUser","isObject","runAsUser","hideMessagesOfType","index","splice","loadMessageHistory","records","findVisibleByRoomIdBeforeTimestampNotContainingTypes","findVisibleByRoomIdNotContainingTypes","UI_Use_Real_Name","messages","starred","findWhere","unreadNotLoaded","firstUnread","firstMessage","unreadMessages","findVisibleByRoomIdBetweenTimestampsNotContainingTypes","count","removeUserFromRoom","removeUsernameById","removedUser","createUserLeaveWithRoomIdAndUser","createCommandWithRoomIdAndUser","removeByRoomIdAndUserId","saveUser","userData","existingRoles","pluck","getRoles","difference","field","escape","input","createUser","joinDefaultChannels","updateUser","sendWelcomeEmail","footer","subject","lng","Email","gravatarUrl","Gravatar","imageUrl","size","secure","setUserAvatar","setUsername","setRealName","shouldSendVerificationEmailToUser","setEmail","setPassword","saveCustomFields","formData","validateCustomFields","saveCustomFieldsWithoutValidation","customFieldsMeta","JSON","setCustomFields","setCustomFieldsDirectMessagesByUserId","fieldName","modifyRecordField","array","$addToSet","objectMaybeIncluding","Match","Where","validateAttachmentsFields","attachmentFields","short","Boolean","validateAttachment","attachment","color","OneOf","Integer","thumb_url","message_link","collapsed","author_name","author_link","author_icon","title_link","title_link_download","image_url","audio_url","video_url","Any","validateBodyAttachments","attachments","upsert","avatar","updated_room","parseUrls","Markdown","code","urls","mountTokensBack","tokens","sandstormSessionId","insert","blockedSettings","SETTINGS_BLOCKED","settingId","hiddenSettings","SETTINGS_HIDDEN","_sorter","packageValue","valueSource","hidden","sorter","enableQuery","stringify","i18nDefaultQuery","toLowerCase","processEnvValue","meteorSettingsValue","i18nLabel","i18nDescription","autocomplete","updateOperations","$setOnInsert","force","section","$unset","existantSetting","Settings","addGroup","isFunction","updateById","updateValueAndEditorById","updateValueById","updateOptionsById","clearById","init","observe","added","record","changed","removed","afterInitialLoad","onAfterInitialLoad","dataURI","contentType","service","encoding","setAvatarOrigin","HTTP","npmRequestOptions","response","statusCode","content","fileData","RocketChatFile","dataURIParse","buffer","Buffer","fileStore","notifyLogged","_setUsername","previousUsername","sendEnrollmentEmail","avatarSuggestions","getAvatarSuggestionForUser","gravatar","avatarData","blob","updateAllUsernamesByUserId","updateUsernameOfEditByUserId","findByMention","updatedMsg","updateUsernameAndMessageOfMentionByIdAndOldUsername","replaceUsername","replaceMutedUsername","replaceUsernameOfUserByUserId","setUserUsernameByUserId","setNameForDirectRoomsWithOldName","LivechatDepartmentAgents","replaceUsernameOfAgentByUserId","model","updateFileNameById","_setRealName","setName","_setEmail","shouldSendVerificationEmail","unarchiveRoom","unarchiveById","unarchiveByRoomId","updateMessage","editedBy","tempid","fieldValue","required","streamAll","Streamer","streamLogged","streamRoom","streamRoomUsers","streamUser","allowWrite","eventName","findByRoomIdAndNotUserId","notifyUser","allowRead","warn","token","notifyAll","unshift","emit","notifyAllInThisInstance","emitWithoutBroadcast","notifyLoggedInThisInstance","notifyRoomInThisInstance","notifyUserInThisInstance","typing","contentHeader","contentFooter","divisorMessage","getEmailContent","userName","channel","messageContent","fileHeader","getMessageLink","roomPath","emailSubject","replyto","messageText","image_type","CATEGORY_MESSAGE","CATEGORY_MESSAGE_NOREPLY","alwaysNotifyMobileBoolean","SubscriptionRaw","rawCollection","getBadgeCount","aggregate","$match","$group","total","$sum","toArray","canSendMessageToRoom","ModelsBaseDb","ModelsBaseCache","_CacheControl","EnvironmentVariable","ModelsBase","nameOrModel","useCache","_db","collectionName","_useCache","cache","bind","getDynamicView","processQueryOptionsOnResult","arrayToCursor","setUpdatedAt","findOneByIds","ids","insertOrUpsert","allow","deny","ensureIndex","dropIndex","tryEnsureIndex","tryDropIndex","trashFind","trashFindDeletedAfter","_Base","Avatars","before","doc","instanceId","insertAvatarFileInit","store","complete","uploading","progress","extension","uploadedAt","updateFileComplete","fileId","direct","updateFileCompleteByNameAndUserId","deleteFile","sparse","expireAfterSeconds","countVisibleByRoomIdBetweenTimestampsInclusive","afterTimestamp","beforeTimestamp","$gte","$lte","findVisibleByMentionAndRoomId","findVisibleByRoomId","$nin","findInvisibleByRoomId","findVisibleByRoomIdAfterTimestamp","timestamp","$gt","findForUpdates","_updatedAt","findVisibleByRoomIdBeforeTimestamp","$lt","findVisibleByRoomIdBeforeTimestampInclusive","findVisibleByRoomIdBetweenTimestamps","findVisibleByRoomIdBetweenTimestampsInclusive","findVisibleCreatedOrEditedAfterTimestamp","findStarredByUserAtRoom","findPinnedByRoom","pinned","findSnippetedByRoom","snippeted","getLastTimestamp","findByRoomIdAndMessageIds","messageIds","findOneBySlackBotIdAndSlackTs","slackBotId","slackTs","findOneBySlackTs","findByRoomIdAndType","findByRoomId","me","parent","reactions","setPinnedByIdAndUserId","pinnedBy","pinnedAt","setSnippetedByIdAndUserId","snippetName","snippetedBy","snippetedAt","setUrlsById","multi","oldUsername","newUsername","newMessage","updateUserStarById","$pull","upgradeEtsToEditAt","ets","$rename","setMessageAttachments","setSlackBotIdAndSlackTs","newUserId","newNameAlias","createWithTypeRoomIdMessageAndUser","createNavigationHistoryWithRoomIdMessageAndUser","createUserRemovedWithRoomIdAndUser","createUserMutedWithRoomIdAndUser","createUserUnmutedWithRoomIdAndUser","createNewModeratorWithRoomIdAndUser","createModeratorRemovedWithRoomIdAndUser","createNewOwnerWithRoomIdAndUser","createOwnerRemovedWithRoomIdAndUser","createNewLeaderWithRoomIdAndUser","createLeaderRemovedWithRoomIdAndUser","createSubscriptionRoleAddedWithRoomIdAndUser","createSubscriptionRoleRemovedWithRoomIdAndUser","getMessageByFileId","fileID","setAsRead","until","setAsReadById","findUnreadMessagesByRoomAndDate","after","Reports","createWithMessageDescriptionAndUserId","ModelRooms","ignoreUpdatedFields","_idOrName","findOneByImportId","importIds","findOneByNameAndType","findOneByIdContainingUsername","findOneByNameAndTypeNotContainingUsername","findWithUsername","findByIds","roomIds","findByType","findByTypes","findBySubscriptionUserId","_room","findBySubscriptionUserIdUpdatedAfter","findByNameContaining","nameRegex","findByNameContainingTypesWithUsername","obj","findContainingTypesWithUsername","findByNameContainingAndTypes","findByNameAndType","findByNameAndTypeNotDefault","findByNameAndTypesNotContainingUsername","findByNameStartingAndTypes","findByTypeContainingUsername","findByTypeContainingUsernames","$all","findByTypesAndNotUserIdContainingUsername","uid","findByContainingUsername","findByTypeAndName","findByIndex","findByTypeAndNameContainingUsername","findByTypeAndArchivationState","archivationstate","addImportIds","$each","addUsernamesById","addUsernameByName","removeUsernamesById","removeUsernameByName","setNameById","setFnameById","$inc","lastMessageTimestamp","lm","setJoinCodeById","joinCode","joinCodeRequired","setUserById","setTypeById","setTopicById","topic","setAnnouncementById","announcement","announcementDetails","setCustomFieldsById","unmuteUsernameByRoomId","saveDefaultById","setTopicAndTagsById","tags","setData","unsetData","isEmpty","tag","createWithTypeNameUserAndUsernames","createWithIdTypeAndName","ModelSettings","findOneNotHiddenById","findByRole","findPublic","public","findNotHiddenPublic","findNotHiddenPublicUpdatedAfter","updatedAt","findNotHiddenPrivate","findNotHidden","findNotHiddenUpdatedAfter","findSetupWizardSettings","wizard","updateValueNotHiddenById","createWithIdAndValue","_createdAt","ModelSubscriptions","findOneByRoomNameAndUserId","findByUserIdUpdatedAfter","findByRoomIdAndRoles","findByTypeAndUserId","findByTypeNameAndUserId","getLastSeen","findByRoomIdAndUserIds","userIds","findByRoomIdAndUserIdsOrAllMessages","findUnreadByUserId","getMinimumLastSeenByRoomId","hideByRoomIdAndUserId","openByRoomIdAndUserId","setAsReadByRoomIdAndUserId","setAsUnreadByRoomIdAndUserId","firstMessageUnreadTimestamp","setFavoriteByRoomIdAndUserId","favorite","updateNameAndAlertByRoomId","updateDisplayNameByRoomId","oldName","incGroup","incUser","ignoreUser","ignoredUser","ignore","setBlockedByRoomId","query2","update2","unsetBlockedByRoomId","updateCustomFieldsByRoomId","cfields","updateTypeByRoomId","addRoleById","removeRoleById","setArchivedByUsername","clearDesktopNotificationUserPreferences","updateDesktopNotificationUserPreferences","clearMobileNotificationUserPreferences","updateMobileNotificationUserPreferences","clearEmailNotificationUserPreferences","updateEmailNotificationUserPreferences","updateUserHighlights","findNotHiddenFilesOfRoom","fileQuery","fileOptions","insertFileInit","ModelUsers","findOneAdmin","admin","findOneByIdAndLoginToken","_hashLoginToken","findUsersNotOffline","findUsersByUsernamesWithHighlights","findActiveByUsernameOrNameRegexWithExceptions","searchTerm","exceptions","termRegex","$and","findByActiveUsersExcept","orStmt","acc","el","findUsersByNameOrUsername","nameOrUsername","usernameNameOrEmailAddress","findLDAPUsers","ldap","findCrowdUsers","crowd","getLastLogin","findUsersByUsernames","findUsersByIds","updateLastLoginById","setServiceId","serviceName","serviceId","serviceIdKey","setEmailVerified","$elemMatch","unsetAvatarOrigin","setUserActive","setAllUsersActive","unsetLoginTokens","unsetRequirePasswordChange","resetPasswordAndSetRequirePasswordChange","setLanguage","setProfile","profile","clearSettings","setPreferences","setUtcOffset","saveUserById","phoneNumber","setReason","unsetReason","addBannerById","banner","removeBannerById","create","getUsersToSendOfflineEmail","usersIds","ExportOperations","ModelExportOperations","findLastOperationByUser","fullExport","findPendingByUser","findAllPending","updateOperation","roomList","fileList","generatedFile","exportOperation","UserDataFiles","ModelUserDataFiles","findLastFileByUser","userDataFile","loki","objectPath","lokiEq","LokiOps","$eq","lokiNe","a","b","lokiIn","subA","subB","traceMethodCalls","target","_stats","property","calls","avg","origMethod","loaded","startTime","round","_getStatsAvg","stats","Adapter","loadDatabase","saveDatabase","deleteDatabase","adapter","indexes","joins","collection","addCollection","hasOne","hasMany","processRemoteJoinInserted","remote","processRemoteJoinRemoved","localRecord","processLocalJoinInserted","local","localRecords","_findByIndex","where","mutableRecord","transform","addToAllIndexes","indexName","addToIndex","removeFromAllIndexes","removeFromIndex","startSync","updateDiffById","r","direction","valueA","valueB","skip","fieldsToRemove","fieldsToGet","pickFields","picked","omit","processQuery","parentField","and","subValue","observeChanges","_publishCursor","cursor","addDynamicView","updatedFields","without","updateRecord","topLevelFields","del","$min","curValue","$max","$mul","$pullAll","$pop","shift","pop","valueItem","removeWhere","baseName","trash","Mongo","Collection","_ensureIndex","_deletedAt","isOplogAvailable","MongoInternals","defaultRemoteCollectionDriver","mongo","_oplogHandle","onOplogEntry","isOplogEnabled","baseModel","wrapModel","event","processOplogRecord","_defineTooFarBehind","Number","MAX_SAFE_INTEGER","originals","self","defineSyncStrategy","modifier","cacheAllowedModifiers","notAllowedModifiers","placeholderFields","updateHasPositionalOperator","op","o","oplog","listenerCount","strategy","findOptions","insertedId","_returnObject","__collection__","_dropIndex","deletedAt","AccessTokenServices","registerAccessTokenService","handleAccessTokenRequest","registerLoginHandler","accessToken","ObjectIncluding","ServiceConfiguration","configurations","ConfigError","oauth","serviceNames","LoginCancelledError","numericError","oauthResult","updateOrCreateUserFromExternalService","serviceData","OAuth","crypto","Npm","whitelisted","FB_API_VERSION","FB_URL","getIdentity","secret","hmac","createHmac","openSecret","access_token","appsecret_proof","digest","expiresIn","identity","Maybe","expiresAt","pick","Twit","whitelistedFields","appId","appSecret","accessTokenSecret","Twitter","consumer_key","consumer_secret","access_token_secret","syncTwitter","getScopes","idToken","scopes","Google","refreshToken","_redirectUri","proxy","StatsD","StatsTracker","dogstatsd","track","hrtime","decrement","histogram","gauge","arr","applyFind","$size","testWebAppInternals","isString","setBundledJsCssPrefix","startEmailIntercepter","debounce","buildMailURL","MAIL_URL","encodeURIComponent","oauth_updated","_OAuthServicesUpdate","clientId","custom","serverURL","tokenPath","identityPath","authorizePath","buttonLabelText","buttonLabelColor","loginStyle","buttonColor","tokenSentVia","identityTokenSentVia","usernameField","mergeUsers","CustomOAuth","consumerKey","OAuthServicesUpdate","OAuthServicesRemove","DEPLOYMENT_ID","readonly","step","actionText","multiline","placeholder","addOAuthService","capitalize","persistent","refreshOAuthService","addUsersToRoom","userInRoom","newUser","blockUser","subscription2","checkRegistrationSecretURL","cleanChannelHistory","latest","oldest","inclusive","cleanRoomHistory","createChannel","Optional","createToken","_generateStampedLoginToken","_insertLoginToken","authToken","createPrivateGroup","tokenpass","balance","originalMessage","forceDelete","deleteAllowed","deleteOwn","blockDeleteInMinutes","msgTs","currentTsDiff","deleteUserOwnAccount","bcrypt","_checkPassword","algorithm","executeSlashCommandPreview","theCmd","Filter","badWordsList","clean","getChannelHistory","unreads","fromUserId","isUndefined","isDate","firstMsg","getRoomJoinCode","getRoomRoles","Roles","getServerInfo","getSingleMessage","msgId","getSlashCommandPreviews","getUserRoles","roleIds","findUsersInRoles","intersection","insertOrUpdateUser","joinRoom","balances","updateUserTokenpassBalances","Tokenpass","validateAccess","leaveRoom","hasRole","numOwners","getUsersInRole","removeOAuthService","restart_server","abort","exit","m","saveSetting","sendInvitationEmail","rfcMailPattern","validEmails","message_ts","server_ts","getTime","adjustedMessage","sandstorm","sendSMTPTestEmail","setAdminStatus","param","joinDefaultChannelsSilenced","unblockUser","editAllowed","editOwn","blockEditInMinutes"],"mappings":"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","file":"/packages/rocketchat_lib.js","sourcesContent":["import EventEmitter from 'wolfy87-eventemitter';\nRocketChat = new EventEmitter();\n/*\n* Kick off the global namespace for RocketChat.\n* @namespace RocketChat\n*/\nRocketChat.models = {};\n","import _ from 'underscore';\n\n/*\n* RocketChat.settings holds all packages settings\n* @namespace RocketChat.settings\n*/\nRocketChat.settings = {\n\tcallbacks: {},\n\tregexCallbacks: {},\n\tts: new Date,\n\tget(_id, callback) {\n\t\tif (callback != null) {\n\t\t\tRocketChat.settings.onload(_id, callback);\n\t\t\tif (!Meteor.settings) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (_id === '*') {\n\t\t\t\treturn Object.keys(Meteor.settings).forEach(key => {\n\t\t\t\t\tconst value = Meteor.settings[key];\n\t\t\t\t\tcallback(key, value);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (_.isRegExp(_id) && Meteor.settings) {\n\t\t\t\treturn Object.keys(Meteor.settings).forEach(key => {\n\t\t\t\t\tif (!_id.test(key)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst value = Meteor.settings[key];\n\t\t\t\t\tcallback(key, value);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn Meteor.settings[_id] != null && callback(_id, Meteor.settings[_id]);\n\t\t} else {\n\t\t\tif (!Meteor.settings) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (_.isRegExp(_id)) {\n\t\t\t\treturn Object.keys(Meteor.settings).reduce((items, key) => {\n\t\t\t\t\tconst value = Meteor.settings[key];\n\t\t\t\t\tif (_id.test(key)) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\tvalue\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn items;\n\t\t\t\t}, []);\n\t\t\t}\n\t\t\treturn Meteor.settings && Meteor.settings[_id];\n\t\t}\n\t},\n\tset(_id, value, callback) {\n\t\treturn Meteor.call('saveSetting', _id, value, callback);\n\t},\n\tbatchSet(settings, callback) {\n\t\t// async -> sync\n\t\t// http://daemon.co.za/2012/04/simple-async-with-only-underscore/\n\t\tconst save = function(setting) {\n\t\t\treturn function(callback) {\n\t\t\t\treturn Meteor.call('saveSetting', setting._id, setting.value, setting.editor, callback);\n\t\t\t};\n\t\t};\n\t\tconst actions = _.map(settings, (setting) => save(setting));\n\t\treturn _(actions).reduceRight(_.wrap, (err, success) => callback(err, success))();\n\t},\n\tload(key, value, initialLoad) {\n\t\t['*', key].forEach(item => {\n\t\t\tif (RocketChat.settings.callbacks[item]) {\n\t\t\t\tRocketChat.settings.callbacks[item].forEach(callback => callback(key, value, initialLoad));\n\t\t\t}\n\t\t});\n\t\tObject.keys(RocketChat.settings.regexCallbacks).forEach(cbKey => {\n\t\t\tconst cbValue = RocketChat.settings.regexCallbacks[cbKey];\n\t\t\tif (!cbValue.regex.test(key)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcbValue.callbacks.forEach(callback => callback(key, value, initialLoad));\n\t\t});\n\t},\n\tonload(key, callback) {\n\t\t// if key is '*'\n\t\t// \tfor key, value in Meteor.settings\n\t\t// \t\tcallback key, value, false\n\t\t// else if Meteor.settings?[_id]?\n\t\t// \tcallback key, Meteor.settings[_id], false\n\t\tconst keys = [].concat(key);\n\t\tkeys.forEach(k => {\n\t\t\tif (_.isRegExp(k)) {\n\t\t\t\tRocketChat.settings.regexCallbacks[name = k.source] = RocketChat.settings.regexCallbacks[name = k.source] || {\n\t\t\t\t\tregex: k,\n\t\t\t\t\tcallbacks: []\n\t\t\t\t};\n\t\t\t\tRocketChat.settings.regexCallbacks[k.source].callbacks.push(callback);\n\t\t\t} else {\n\t\t\t\tRocketChat.settings.callbacks[k] = RocketChat.settings.callbacks[k] || [];\n\t\t\t\tRocketChat.settings.callbacks[k].push(callback);\n\t\t\t}\n\t\t});\n\t}\n};\n","export const RoomSettingsEnum = {\n\tNAME: 'roomName',\n\tTOPIC: 'roomTopic',\n\tANNOUNCEMENT: 'roomAnnouncement',\n\tDESCRIPTION: 'roomDescription',\n\tREAD_ONLY: 'readOnly',\n\tREACT_WHEN_READ_ONLY: 'reactWhenReadOnly',\n\tARCHIVE_OR_UNARCHIVE: 'archiveOrUnarchive',\n\tJOIN_CODE: 'joinCode',\n\tBROADCAST: 'broadcast',\n\tSYSTEM_MESSAGES: 'systemMessages'\n};\n\nexport const UiTextContext = {\n\tCLOSE_WARNING: 'closeWarning',\n\tHIDE_WARNING: 'hideWarning',\n\tLEAVE_WARNING: 'leaveWarning',\n\tNO_ROOMS_SUBSCRIBED: 'noRoomsSubscribed'\n};\n\nexport class RoomTypeRouteConfig {\n\tconstructor({ name, path }) {\n\t\tif (typeof name !== 'undefined' && (typeof name !== 'string' || name.length === 0)) {\n\t\t\tthrow new Error('The name must be a string.');\n\t\t}\n\n\t\tif (typeof path !== 'undefined' && (typeof path !== 'string' || path.length === 0)) {\n\t\t\tthrow new Error('The path must be a string.');\n\t\t}\n\n\t\tthis._name = name;\n\t\tthis._path = path;\n\t}\n\n\tget name() {\n\t\treturn this._name;\n\t}\n\n\tget path() {\n\t\treturn this._path;\n\t}\n}\n\nexport class RoomTypeConfig {\n\tconstructor({\n\t\tidentifier = Random.id(),\n\t\torder,\n\t\ticon,\n\t\theader,\n\t\tlabel,\n\t\troute\n\t}) {\n\t\tif (typeof identifier !== 'string' || identifier.length === 0) {\n\t\t\tthrow new Error('The identifier must be a string.');\n\t\t}\n\n\t\tif (typeof order !== 'number') {\n\t\t\tthrow new Error('The order must be a number.');\n\t\t}\n\n\t\tif (typeof icon !== 'undefined' && (typeof icon !== 'string' || icon.length === 0)) {\n\t\t\tthrow new Error('The icon must be a string.');\n\t\t}\n\n\t\tif (typeof header !== 'undefined' && (typeof header !== 'string' || header.length === 0)) {\n\t\t\tthrow new Error('The header must be a string.');\n\t\t}\n\n\t\tif (typeof label !== 'undefined' && (typeof label !== 'string' || label.length === 0)) {\n\t\t\tthrow new Error('The label must be a string.');\n\t\t}\n\n\t\tif (typeof route !== 'undefined' && !(route instanceof RoomTypeRouteConfig)) {\n\t\t\tthrow new Error('Room\\'s route is not a valid route configuration. Must be an instance of \"RoomTypeRouteConfig\".');\n\t\t}\n\n\t\tthis._identifier = identifier;\n\t\tthis._order = order;\n\t\tthis._icon = icon;\n\t\tthis._header = header;\n\t\tthis._label = label;\n\t\tthis._route = route;\n\t}\n\n\t/**\n\t * The room type's internal identifier.\n\t */\n\tget identifier() {\n\t\treturn this._identifier;\n\t}\n\n\t/**\n\t * The order of this room type for the display.\n\t */\n\tget order() {\n\t\treturn this._order;\n\t}\n\n\t/**\n\t * Sets the order of this room type for the display.\n\t *\n\t * @param {number} order the number value for the order\n\t */\n\tset order(order) {\n\t\tif (typeof order !== 'number') {\n\t\t\tthrow new Error('The order must be a number.');\n\t\t}\n\n\t\tthis._order = order;\n\t}\n\n\t/**\n\t * The icon class, css, to use as the visual aid.\n\t */\n\tget icon() {\n\t\treturn this._icon;\n\t}\n\n\t/**\n\t * The header name of this type.\n\t */\n\tget header() {\n\t\treturn this._header;\n\t}\n\n\t/**\n\t * The i18n label for this room type.\n\t */\n\tget label() {\n\t\treturn this._label;\n\t}\n\n\t/**\n\t * The route config for this room type.\n\t */\n\tget route() {\n\t\treturn this._route;\n\t}\n\n\t/**\n\t * Gets the room's name to display in the UI.\n\t *\n\t * @param {object} room\n\t */\n\tgetDisplayName(room) {\n\t\treturn room.name;\n\t}\n\n\tallowRoomSettingChange(/* room, setting */) {\n\t\treturn true;\n\t}\n\n\tcanBeCreated() {\n\t\treturn Meteor.isServer ?\n\t\t\tRocketChat.authz.hasAtLeastOnePermission(Meteor.userId(), [`create-${ this._identifier }`]) :\n\t\t\tRocketChat.authz.hasAtLeastOnePermission([`create-${ this._identifier }`]);\n\t}\n\n\tcanBeDeleted(room) {\n\t\treturn Meteor.isServer ?\n\t\t\tRocketChat.authz.hasAtLeastOnePermission(Meteor.userId(), [`delete-${ room.t }`], room._id) :\n\t\t\tRocketChat.authz.hasAtLeastOnePermission([`delete-${ room.t }`], room._id);\n\t}\n\n\tsupportMembersList(/* room */) {\n\t\treturn true;\n\t}\n\n\tisGroupChat() {\n\t\treturn false;\n\t}\n\n\tcanAddUser(/* userId, room */) {\n\t\treturn false;\n\t}\n\n\tuserDetailShowAll(/* room */) {\n\t\treturn true;\n\t}\n\n\tuserDetailShowAdmin(/* room */) {\n\t\treturn true;\n\t}\n\n\tpreventRenaming(/* room */) {\n\t\treturn false;\n\t}\n\n\tincludeInRoomSearch() {\n\t\treturn false;\n\t}\n\n\tenableMembersListProfile() {\n\t\treturn false;\n\t}\n\n\t/**\n\t * Returns a text which can be used in generic UIs.\n\t * @param context The role of the text in the UI-Element\n\t * @return {string} A text or a translation key - the consumers of this method will pass the\n\t * returned value to an internationalization library\n\t */\n\tgetUiText(/* context */) {\n\t\treturn '';\n\t}\n}\n","import { RoomTypeConfig } from '../RoomTypeConfig';\n\nexport class ConversationRoomType extends RoomTypeConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tidentifier: 'merged',\n\t\t\torder: 30,\n\t\t\tlabel: 'Conversations'\n\t\t});\n\t}\n\n\tcondition() {\n\t\t// returns true only if sidebarGroupByType is not set\n\t\treturn !RocketChat.getUserPreference(Meteor.userId(), 'sidebarGroupByType');\n\t}\n}\n","/* globals openRoom */\nimport {RoomTypeConfig, RoomTypeRouteConfig, RoomSettingsEnum, UiTextContext} from '../RoomTypeConfig';\n\nexport class DirectMessageRoomRoute extends RoomTypeRouteConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tname: 'direct',\n\t\t\tpath: '/direct/:username'\n\t\t});\n\t}\n\n\taction(params) {\n\t\treturn openRoom('d', params.username);\n\t}\n\n\tlink(sub) {\n\t\treturn {username: sub.name};\n\t}\n}\n\nexport class DirectMessageRoomType extends RoomTypeConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tidentifier: 'd',\n\t\t\torder: 50,\n\t\t\tlabel: 'Direct_Messages',\n\t\t\troute: new DirectMessageRoomRoute()\n\t\t});\n\t}\n\n\tfindRoom(identifier) {\n\t\tconst query = {\n\t\t\tt: 'd',\n\t\t\tname: identifier\n\t\t};\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOne(query);\n\t\tif (subscription && subscription.rid) {\n\t\t\treturn ChatRoom.findOne(subscription.rid);\n\t\t}\n\t}\n\n\troomName(roomData) {\n\t\tconst subscription = RocketChat.models.Subscriptions.findOne({rid: roomData._id}, {fields: {name: 1, fname: 1}});\n\t\tif (!subscription) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (RocketChat.settings.get('UI_Use_Real_Name') && subscription.fname) {\n\t\t\treturn subscription.fname;\n\t\t}\n\n\t\treturn subscription.name;\n\t}\n\n\tsecondaryRoomName(roomData) {\n\t\tif (RocketChat.settings.get('UI_Use_Real_Name')) {\n\t\t\tconst subscription = RocketChat.models.Subscriptions.findOne({rid: roomData._id}, {fields: {name: 1}});\n\t\t\treturn subscription && subscription.name;\n\t\t}\n\t}\n\n\tcondition() {\n\t\tconst groupByType = RocketChat.getUserPreference(Meteor.userId(), 'sidebarGroupByType');\n\t\treturn groupByType && RocketChat.authz.hasAtLeastOnePermission(['view-d-room', 'view-joined-room']);\n\t}\n\n\tgetUserStatus(roomId) {\n\t\tconst subscription = RocketChat.models.Subscriptions.findOne({rid: roomId});\n\t\tif (subscription == null) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn Session.get(`user_${ subscription.name }_status`);\n\t}\n\n\tgetDisplayName(room) {\n\t\treturn room.usernames.join(' x ');\n\t}\n\n\tallowRoomSettingChange(room, setting) {\n\t\tswitch (setting) {\n\t\t\tcase RoomSettingsEnum.NAME:\n\t\t\tcase RoomSettingsEnum.SYSTEM_MESSAGES:\n\t\t\tcase RoomSettingsEnum.DESCRIPTION:\n\t\t\tcase RoomSettingsEnum.READ_ONLY:\n\t\t\tcase RoomSettingsEnum.REACT_WHEN_READ_ONLY:\n\t\t\tcase RoomSettingsEnum.ARCHIVE_OR_UNARCHIVE:\n\t\t\tcase RoomSettingsEnum.JOIN_CODE:\n\t\t\t\treturn false;\n\t\t\tdefault:\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\tenableMembersListProfile() {\n\t\treturn true;\n\t}\n\n\tuserDetailShowAll(/* room */) {\n\t\treturn false;\n\t}\n\n\tgetUiText(context) {\n\t\tswitch (context) {\n\t\t\tcase UiTextContext.HIDE_WARNING:\n\t\t\t\treturn 'Hide_Private_Warning';\n\t\t\tcase UiTextContext.LEAVE_WARNING:\n\t\t\t\treturn 'Leave_Private_Warning';\n\t\t\tdefault:\n\t\t\t\treturn '';\n\t\t}\n\t}\n}\n","import { RoomTypeConfig } from '../RoomTypeConfig';\n\nexport class FavoriteRoomType extends RoomTypeConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tidentifier: 'f',\n\t\t\torder: 20,\n\t\t\theader: 'favorite',\n\t\t\ticon: 'star',\n\t\t\tlabel: 'Favorites'\n\t\t});\n\t}\n\tcondition() {\n\t\treturn RocketChat.settings.get('Favorite_Rooms') && RocketChat.getUserPreference(Meteor.userId(), 'sidebarShowFavorites');\n\t}\n}\n","import { ConversationRoomType } from './conversation';\nimport { DirectMessageRoomType } from './direct';\nimport { FavoriteRoomType } from './favorite';\nimport { PrivateRoomType } from './private';\nimport { PublicRoomType } from './public';\nimport { UnreadRoomType } from './unread';\n\nexport {\n\tConversationRoomType,\n\tDirectMessageRoomType,\n\tFavoriteRoomType,\n\tPrivateRoomType,\n\tPublicRoomType,\n\tUnreadRoomType\n};\n","/* globals openRoom */\nimport {RoomSettingsEnum, RoomTypeConfig, RoomTypeRouteConfig, UiTextContext} from '../RoomTypeConfig';\n\nexport class PrivateRoomRoute extends RoomTypeRouteConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tname: 'group',\n\t\t\tpath: '/group/:name'\n\t\t});\n\t}\n\n\taction(params) {\n\t\treturn openRoom('p', params.name);\n\t}\n}\n\nexport class PrivateRoomType extends RoomTypeConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tidentifier: 'p',\n\t\t\torder: 40,\n\t\t\ticon: 'lock',\n\t\t\tlabel: 'Private_Groups',\n\t\t\troute: new PrivateRoomRoute()\n\t\t});\n\t}\n\n\tfindRoom(identifier) {\n\t\tconst query = {\n\t\t\tt: 'p',\n\t\t\tname: identifier\n\t\t};\n\n\t\treturn ChatRoom.findOne(query);\n\t}\n\n\troomName(roomData) {\n\t\tif (RocketChat.settings.get('UI_Allow_room_names_with_special_chars')) {\n\t\t\treturn roomData.fname || roomData.name;\n\t\t}\n\n\t\treturn roomData.name;\n\t}\n\n\tcondition() {\n\t\tconst groupByType = RocketChat.getUserPreference(Meteor.userId(), 'sidebarGroupByType');\n\t\treturn groupByType && RocketChat.authz.hasAllPermission('view-p-room');\n\t}\n\n\tisGroupChat() {\n\t\treturn true;\n\t}\n\n\tcanAddUser(room) {\n\t\treturn RocketChat.authz.hasAtLeastOnePermission(['add-user-to-any-p-room', 'add-user-to-joined-room'], room._id);\n\t}\n\n\tallowRoomSettingChange(room, setting) {\n\t\tswitch (setting) {\n\t\t\tcase RoomSettingsEnum.JOIN_CODE:\n\t\t\t\treturn false;\n\t\t\tcase RoomSettingsEnum.BROADCAST:\n\t\t\t\treturn room.broadcast;\n\t\t\tcase RoomSettingsEnum.READ_ONLY:\n\t\t\t\treturn !room.broadcast;\n\t\t\tcase RoomSettingsEnum.REACT_WHEN_READ_ONLY:\n\t\t\t\treturn !room.broadcast && room.ro;\n\t\t\tcase RoomSettingsEnum.SYSTEM_MESSAGES:\n\t\t\tdefault:\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\tenableMembersListProfile() {\n\t\treturn true;\n\t}\n\n\tgetUiText(context) {\n\t\tswitch (context) {\n\t\t\tcase UiTextContext.HIDE_WARNING:\n\t\t\t\treturn 'Hide_Group_Warning';\n\t\t\tcase UiTextContext.LEAVE_WARNING:\n\t\t\t\treturn 'Leave_Group_Warning';\n\t\t\tdefault:\n\t\t\t\treturn '';\n\t\t}\n\t}\n}\n","/* globals openRoom */\nimport { RoomTypeConfig, RoomTypeRouteConfig, RoomSettingsEnum, UiTextContext } from '../RoomTypeConfig';\n\nexport class PublicRoomRoute extends RoomTypeRouteConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tname: 'channel',\n\t\t\tpath: '/channel/:name'\n\t\t});\n\t}\n\n\taction(params) {\n\t\treturn openRoom('c', params.name);\n\t}\n}\n\nexport class PublicRoomType extends RoomTypeConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tidentifier: 'c',\n\t\t\torder: 30,\n\t\t\ticon: 'hashtag',\n\t\t\tlabel: 'Channels',\n\t\t\troute: new PublicRoomRoute()\n\t\t});\n\t}\n\n\tfindRoom(identifier) {\n\t\tconst query = {\n\t\t\tt: 'c',\n\t\t\tname: identifier\n\t\t};\n\t\treturn ChatRoom.findOne(query);\n\t}\n\n\troomName(roomData) {\n\t\tif (RocketChat.settings.get('UI_Allow_room_names_with_special_chars')) {\n\t\t\treturn roomData.fname || roomData.name;\n\t\t}\n\t\treturn roomData.name;\n\t}\n\n\tcondition() {\n\t\tconst groupByType = RocketChat.getUserPreference(Meteor.userId(), 'sidebarGroupByType');\n\t\treturn groupByType && (RocketChat.authz.hasAtLeastOnePermission(['view-c-room', 'view-joined-room']) || RocketChat.settings.get('Accounts_AllowAnonymousRead') === true);\n\t}\n\n\tshowJoinLink(roomId) {\n\t\treturn !!ChatRoom.findOne({_id: roomId, t: 'c'});\n\t}\n\n\tincludeInRoomSearch() {\n\t\treturn true;\n\t}\n\n\tisGroupChat() {\n\t\treturn true;\n\t}\n\n\tcanAddUser(room) {\n\t\treturn RocketChat.authz.hasAtLeastOnePermission(['add-user-to-any-c-room', 'add-user-to-joined-room'], room._id);\n\t}\n\n\tenableMembersListProfile() {\n\t\treturn true;\n\t}\n\n\tallowRoomSettingChange(room, setting) {\n\t\tswitch (setting) {\n\t\t\tcase RoomSettingsEnum.BROADCAST:\n\t\t\t\treturn room.broadcast;\n\t\t\tcase RoomSettingsEnum.READ_ONLY:\n\t\t\t\treturn !room.broadcast;\n\t\t\tcase RoomSettingsEnum.REACT_WHEN_READ_ONLY:\n\t\t\t\treturn !room.broadcast && room.ro;\n\t\t\tcase RoomSettingsEnum.SYSTEM_MESSAGES:\n\t\t\tdefault:\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\tgetUiText(context) {\n\t\tswitch (context) {\n\t\t\tcase UiTextContext.HIDE_WARNING:\n\t\t\t\treturn 'Hide_Room_Warning';\n\t\t\tcase UiTextContext.LEAVE_WARNING:\n\t\t\t\treturn 'Leave_Room_Warning';\n\t\t\tdefault:\n\t\t\t\treturn '';\n\t\t}\n\t}\n}\n","import { RoomTypeConfig } from '../RoomTypeConfig';\n\nexport class UnreadRoomType extends RoomTypeConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tidentifier: 'unread',\n\t\t\torder: 10,\n\t\t\tlabel: 'Unread'\n\t\t});\n\n\t\tthis.unread = true;\n\t}\n\n\tcondition() {\n\t\treturn RocketChat.getUserPreference(Meteor.userId(), 'sidebarShowUnread');\n\t}\n}\n","import s from 'underscore.string';\n\nRocketChat.getURL = (path, { cdn = true, full = false } = {}) => {\n\tconst cdnPrefix = s.rtrim(s.trim(RocketChat.settings.get('CDN_PREFIX') || ''), '/');\n\tconst pathPrefix = s.rtrim(s.trim(__meteor_runtime_config__.ROOT_URL_PATH_PREFIX || ''), '/');\n\n\tlet basePath;\n\n\tconst finalPath = s.ltrim(s.trim(path), '/');\n\n\tif (cdn && cdnPrefix !== '') {\n\t\tbasePath = cdnPrefix + pathPrefix;\n\t} else if (full || Meteor.isCordova) {\n\t\treturn Meteor.absoluteUrl(finalPath);\n\t} else {\n\t\tbasePath = pathPrefix;\n\t}\n\n\treturn `${ basePath }/${ finalPath }`;\n};\n","import _ from 'underscore';\n\n/*\n* Callback hooks provide an easy way to add extra steps to common operations.\n* @namespace RocketChat.callbacks\n*/\n\nRocketChat.callbacks = {};\n\nif (Meteor.isServer) {\n\tRocketChat.callbacks.showTime = true;\n\tRocketChat.callbacks.showTotalTime = true;\n} else {\n\tRocketChat.callbacks.showTime = false;\n\tRocketChat.callbacks.showTotalTime = false;\n}\n\n\n/*\n* Callback priorities\n*/\n\nRocketChat.callbacks.priority = {\n\tHIGH: -1000,\n\tMEDIUM: 0,\n\tLOW: 1000\n};\n\n\n/*\n* Add a callback function to a hook\n* @param {String} hook - The name of the hook\n* @param {Function} callback - The callback function\n*/\n\nRocketChat.callbacks.add = function(hook, callback, priority, id) {\n\tif (priority == null) {\n\t\tpriority = RocketChat.callbacks.priority.MEDIUM;\n\t}\n\tif (!_.isNumber(priority)) {\n\t\tpriority = RocketChat.callbacks.priority.MEDIUM;\n\t}\n\tcallback.priority = priority;\n\tcallback.id = id || Random.id();\n\tRocketChat.callbacks[hook] = RocketChat.callbacks[hook] || [];\n\tif (RocketChat.callbacks.showTime === true) {\n\t\tconst err = new Error;\n\t\tcallback.stack = err.stack;\n\t}\n\tif (RocketChat.callbacks[hook].find((cb) => cb.id === callback.id)) {\n\t\treturn;\n\t}\n\tRocketChat.callbacks[hook].push(callback);\n};\n\n\n/*\n* Remove a callback from a hook\n* @param {string} hook - The name of the hook\n* @param {string} id - The callback's id\n*/\n\nRocketChat.callbacks.remove = function(hookName, id) {\n\tRocketChat.callbacks[hookName] = _.reject(RocketChat.callbacks[hookName], (callback) => callback.id === id);\n};\n\n\n/*\n* Successively run all of a hook's callbacks on an item\n* @param {String} hook - The name of the hook\n* @param {Object} item - The post, comment, modifier, etc. on which to run the callbacks\n* @param {Object} [constant] - An optional constant that will be passed along to each callback\n* @returns {Object} Returns the item after it's been through all the callbacks for this hook\n*/\n\nRocketChat.callbacks.run = function(hook, item, constant) {\n\tconst callbacks = RocketChat.callbacks[hook];\n\tif (callbacks && callbacks.length) {\n\n\t\tlet rocketchatHooksEnd;\n\t\tif (Meteor.isServer) {\n\t\t\trocketchatHooksEnd = RocketChat.metrics.rocketchatHooks.startTimer({hook, callbacks_length: callbacks.length});\n\t\t}\n\n\t\tlet totalTime = 0;\n\t\tconst result = _.sortBy(callbacks, function(callback) {\n\t\t\treturn callback.priority || RocketChat.callbacks.priority.MEDIUM;\n\t\t}).reduce(function(result, callback) {\n\t\t\tlet rocketchatCallbacksEnd;\n\t\t\tif (Meteor.isServer) {\n\t\t\t\trocketchatCallbacksEnd = RocketChat.metrics.rocketchatCallbacks.startTimer({hook, callback: callback.id});\n\t\t\t}\n\t\t\tlet time = 0;\n\t\t\tif (RocketChat.callbacks.showTime === true || RocketChat.callbacks.showTotalTime === true) {\n\t\t\t\ttime = Date.now();\n\t\t\t}\n\t\t\tconst callbackResult = callback(result, constant);\n\t\t\tif (RocketChat.callbacks.showTime === true || RocketChat.callbacks.showTotalTime === true) {\n\t\t\t\tconst currentTime = Date.now() - time;\n\t\t\t\ttotalTime += currentTime;\n\t\t\t\tif (RocketChat.callbacks.showTime === true) {\n\t\t\t\t\tif (Meteor.isServer) {\n\t\t\t\t\t\trocketchatCallbacksEnd();\n\t\t\t\t\t\tRocketChat.statsTracker.timing('callbacks.time', currentTime, [`hook:${ hook }`, `callback:${ callback.id }`]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet stack = callback.stack && typeof callback.stack.split === 'function' && callback.stack.split('\\n');\n\t\t\t\t\t\tstack = stack && stack[2] && (stack[2].match(/\\(.+\\)/)||[])[0];\n\t\t\t\t\t\tconsole.log(String(currentTime), hook, callback.id, stack);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn (typeof callbackResult === 'undefined') ? result : callbackResult;\n\t\t}, item);\n\n\t\tif (Meteor.isServer) {\n\t\t\trocketchatHooksEnd();\n\t\t}\n\n\t\tif (RocketChat.callbacks.showTotalTime === true) {\n\t\t\tif (Meteor.isServer) {\n\t\t\t\tRocketChat.statsTracker.timing('callbacks.totalTime', totalTime, [`hook:${ hook }`]);\n\t\t\t} else {\n\t\t\t\tconsole.log(`${ hook }:`, totalTime);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t} else {\n\t\treturn item;\n\t}\n};\n\n\n/*\n* Successively run all of a hook's callbacks on an item, in async mode (only works on server)\n* @param {String} hook - The name of the hook\n* @param {Object} item - The post, comment, modifier, etc. on which to run the callbacks\n* @param {Object} [constant] - An optional constant that will be passed along to each callback\n*/\n\nRocketChat.callbacks.runAsync = function(hook, item, constant) {\n\tconst callbacks = RocketChat.callbacks[hook];\n\tif (Meteor.isServer && callbacks && callbacks.length) {\n\t\tMeteor.defer(function() {\n\t\t\t_.sortBy(callbacks, (callback) => callback.priority || RocketChat.callbacks.priority.MEDIUM).forEach((callback) => callback(item, constant));\n\t\t});\n\t} else {\n\t\treturn item;\n\t}\n};\n","import _ from 'underscore';\n\nRocketChat.fileUploadMediaWhiteList = function() {\n\tconst mediaTypeWhiteList = RocketChat.settings.get('FileUpload_MediaTypeWhiteList');\n\n\tif (!mediaTypeWhiteList || mediaTypeWhiteList === '*') {\n\t\treturn;\n\t}\n\treturn _.map(mediaTypeWhiteList.split(','), function(item) {\n\t\treturn item.trim();\n\t});\n};\n\nRocketChat.fileUploadIsValidContentType = function(type) {\n\tconst list = RocketChat.fileUploadMediaWhiteList();\n\tif (!list) {\n\t\treturn true;\n\t}\n\n\tif (!type) {\n\t\treturn false;\n\t}\n\n\tif (_.contains(list, type)) {\n\t\treturn true;\n\t} else {\n\t\tconst wildCardGlob = '/*';\n\t\tconst wildcards = _.filter(list, function(item) {\n\t\t\treturn item.indexOf(wildCardGlob) > 0;\n\t\t});\n\t\tif (_.contains(wildcards, type.replace(/(\\/.*)$/, wildCardGlob))) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n};\n","const colors = ['#F44336', '#E91E63', '#9C27B0', '#673AB7', '#3F51B5', '#2196F3', '#03A9F4', '#00BCD4', '#009688', '#4CAF50', '#8BC34A', '#CDDC39', '#FFC107', '#FF9800', '#FF5722', '#795548', '#9E9E9E', '#607D8B'];\n\nRocketChat.getAvatarColor = function(name) {\n\treturn colors[name.length % colors.length];\n};\n","RocketChat.getDefaultSubscriptionPref = function _getDefaultSubscriptionPref(userPref) {\n\tconst subscription = {};\n\n\tconst {\n\t\tdesktopNotifications,\n\t\tmobileNotifications,\n\t\temailNotificationMode,\n\t\thighlights\n\t} = (userPref.settings && userPref.settings.preferences) || {};\n\n\tif (Array.isArray(highlights) && highlights.length) {\n\t\tsubscription.userHighlights = highlights;\n\t}\n\n\tif (desktopNotifications && desktopNotifications !== 'default') {\n\t\tsubscription.desktopNotifications = desktopNotifications;\n\t\tsubscription.desktopPrefOrigin = 'user';\n\t}\n\n\tif (mobileNotifications && mobileNotifications !== 'default') {\n\t\tsubscription.mobilePushNotifications = mobileNotifications;\n\t\tsubscription.mobilePrefOrigin = 'user';\n\t}\n\n\tif (emailNotificationMode && emailNotificationMode !== 'default') {\n\t\tsubscription.emailNotifications = emailNotificationMode;\n\t\tsubscription.emailPrefOrigin = 'user';\n\t}\n\n\treturn subscription;\n};\n","import s from 'underscore.string';\n\nRocketChat.getValidRoomName = function getValidRoomName(displayName, rid = '') {\n\tlet slugifiedName = displayName;\n\n\tif (RocketChat.settings.get('UI_Allow_room_names_with_special_chars')) {\n\t\tconst room = RocketChat.models.Rooms.findOneByDisplayName(displayName);\n\t\tif (room && room._id !== rid) {\n\t\t\tif (room.archived) {\n\t\t\t\tthrow new Meteor.Error('error-archived-duplicate-name', `There's an archived channel with name ${ displayName }`, { function: 'RocketChat.getValidRoomName', channel_name: displayName });\n\t\t\t} else {\n\t\t\t\tthrow new Meteor.Error('error-duplicate-channel-name', `A channel with name '${ displayName }' exists`, { function: 'RocketChat.getValidRoomName', channel_name: displayName });\n\t\t\t}\n\t\t}\n\t\tslugifiedName = s.slugify(displayName);\n\t}\n\n\tlet nameValidation;\n\ttry {\n\t\tnameValidation = new RegExp(`^${ RocketChat.settings.get('UTF8_Names_Validation') }$`);\n\t} catch (error) {\n\t\tnameValidation = new RegExp('^[0-9a-zA-Z-_.]+$');\n\t}\n\tif (!nameValidation.test(slugifiedName)) {\n\t\tthrow new Meteor.Error('error-invalid-room-name', `${ slugifiedName } is not a valid room name.`, {\n\t\t\t'function': 'RocketChat.getValidRoomName',\n\t\t\tchannel_name: slugifiedName\n\t\t});\n\t}\n\n\tconst room = RocketChat.models.Rooms.findOneByName(slugifiedName);\n\tif (room && room._id !== rid) {\n\t\tif (RocketChat.settings.get('UI_Allow_room_names_with_special_chars')) {\n\t\t\tlet tmpName = slugifiedName;\n\t\t\tlet next = 0;\n\t\t\twhile (RocketChat.models.Rooms.findOneByNameAndNotId(tmpName, rid)) {\n\t\t\t\ttmpName = `${ slugifiedName }-${ ++next }`;\n\t\t\t}\n\t\t\tslugifiedName = tmpName;\n\t\t} else if (room.archived) {\n\t\t\tthrow new Meteor.Error('error-archived-duplicate-name', `There's an archived channel with name ${ slugifiedName }`, { function: 'RocketChat.getValidRoomName', channel_name: slugifiedName });\n\t\t} else {\n\t\t\tthrow new Meteor.Error('error-duplicate-channel-name', `A channel with name '${ slugifiedName }' exists`, { function: 'RocketChat.getValidRoomName', channel_name: slugifiedName });\n\t\t}\n\t}\n\n\treturn slugifiedName;\n};\n","import s from 'underscore.string';\n\nRocketChat.placeholders = {};\n\nRocketChat.placeholders.replace = function(str, data) {\n\tif (!str) {\n\t\treturn '';\n\t}\n\n\tstr = str.replace(/\\[Site_Name\\]/g, RocketChat.settings.get('Site_Name') || '');\n\tstr = str.replace(/\\[Site_URL\\]/g, RocketChat.settings.get('Site_Url') || '');\n\n\tif (data) {\n\t\tstr = str.replace(/\\[name\\]/g, data.name || '');\n\t\tstr = str.replace(/\\[fname\\]/g, s.strLeft(data.name, ' ') || '');\n\t\tstr = str.replace(/\\[lname\\]/g, s.strRightBack(data.name, ' ') || '');\n\t\tstr = str.replace(/\\[email\\]/g, data.email || '');\n\t\tstr = str.replace(/\\[password\\]/g, data.password || '');\n\t\tstr = str.replace(/\\[reason\\]/g, data.reason || '');\n\t\tstr = str.replace(/\\[User\\]/g, data.user || '');\n\t\tstr = str.replace(/\\[Room\\]/g, data.room || '');\n\n\t\tif (data.unsubscribe) {\n\t\t\tstr = str.replace(/\\[unsubscribe\\]/g, data.unsubscribe);\n\t\t}\n\t}\n\n\tstr = str.replace(/([^>\\r\\n]?)(\\r\\n|\\n\\r|\\r|\\n)/g, '$1' + '<br>' + '$2');\n\n\n\treturn str;\n};\n","import _ from 'underscore';\n\n/*\n* Callback hooks provide an easy way to add extra steps to common operations.\n* @namespace RocketChat.promises\n*/\n\nRocketChat.promises = {};\n\n\n/*\n* Callback priorities\n*/\n\nRocketChat.promises.priority = {\n\tHIGH: -1000,\n\tMEDIUM: 0,\n\tLOW: 1000\n};\n\n\n/*\n* Add a callback function to a hook\n* @param {String} hook - The name of the hook\n* @param {Function} callback - The callback function\n*/\n\nRocketChat.promises.add = function(hook, callback, p = RocketChat.promises.priority.MEDIUM, id) {\n\tconst priority = !_.isNumber(p) ? RocketChat.promises.priority.MEDIUM : p;\n\tcallback.priority = priority;\n\tcallback.id = id || Random.id();\n\tRocketChat.promises[hook] = RocketChat.promises[hook] || [];\n\tif (RocketChat.promises[hook].find(cb => cb.id === callback.id)) {\n\t\treturn;\n\t}\n\tRocketChat.promises[hook].push(callback);\n};\n\n\n/*\n* Remove a callback from a hook\n* @param {string} hook - The name of the hook\n* @param {string} id - The callback's id\n*/\n\nRocketChat.promises.remove = function(hookName, id) {\n\tRocketChat.promises[hookName] = _.reject(RocketChat.promises[hookName], (callback) => callback.id === id);\n};\n\n\n/*\n* Successively run all of a hook's callbacks on an item\n* @param {String} hook - The name of the hook\n* @param {Object} item - The post, comment, modifier, etc. on which to run the callbacks\n* @param {Object} [constant] - An optional constant that will be passed along to each callback\n* @returns {Object} Returns the item after it's been through all the callbacks for this hook\n*/\n\nRocketChat.promises.run = function(hook, item, constant) {\n\tlet callbacks = RocketChat.promises[hook];\n\tif (callbacks == null || callbacks.length === 0) {\n\t\treturn Promise.resolve(item);\n\t}\n\tcallbacks = _.sortBy(callbacks, (callback) => callback.priority || RocketChat.promises.priority.MEDIUM);\n\treturn callbacks.reduce(function(previousPromise, callback) {\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\treturn previousPromise.then((result) => callback(result, constant).then(resolve, reject));\n\t\t});\n\t}, Promise.resolve(item));\n};\n\n\n/*\n* Successively run all of a hook's callbacks on an item, in async mode (only works on server)\n* @param {String} hook - The name of the hook\n* @param {Object} item - The post, comment, modifier, etc. on which to run the callbacks\n* @param {Object} [constant] - An optional constant that will be passed along to each callback\n*/\n\nRocketChat.promises.runAsync = function(hook, item, constant) {\n\tconst callbacks = RocketChat.promises[hook];\n\tif (!Meteor.isServer || callbacks == null || callbacks.length === 0) {\n\t\treturn item;\n\t}\n\tMeteor.defer(() => {\n\t\t_.sortBy(callbacks, (callback) => callback.priority || RocketChat.promises.priority.MEDIUM).forEach(function(callback) {\n\t\t\tcallback(item, constant);\n\t\t});\n\t});\n};\n","/* globals roomExit */\nimport { RoomTypeConfig } from './RoomTypeConfig';\n\nexport class RoomTypesCommon {\n\tconstructor() {\n\t\tthis.roomTypes = {};\n\t\tthis.roomTypesOrder = [];\n\t\tthis.mainOrder = 1;\n\t}\n\n\t/**\n\t * Adds a room type to the application.\n\t *\n\t * @param {RoomTypeConfig} roomConfig\n\t * @returns {void}\n\t */\n\tadd(roomConfig) {\n\t\tif (!(roomConfig instanceof RoomTypeConfig)) {\n\t\t\tthrow new Error('Invalid Room Configuration object, it must extend \"RoomTypeConfig\"');\n\t\t}\n\n\t\tif (this.roomTypes[roomConfig.identifier]) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!roomConfig.order) {\n\t\t\troomConfig.order = this.mainOrder + 10;\n\t\t\tthis.mainOrder += 10;\n\t\t}\n\n\t\tthis.roomTypesOrder.push({\n\t\t\tidentifier: roomConfig.identifier,\n\t\t\torder: roomConfig.order\n\t\t});\n\n\t\tthis.roomTypes[roomConfig.identifier] = roomConfig;\n\n\t\tif (roomConfig.route && roomConfig.route.path && roomConfig.route.name && roomConfig.route.action) {\n\t\t\tconst routeConfig = {\n\t\t\t\tname: roomConfig.route.name,\n\t\t\t\taction: roomConfig.route.action\n\t\t\t};\n\n\t\t\tif (Meteor.isClient) {\n\t\t\t\trouteConfig.triggersExit = [roomExit];\n\t\t\t}\n\n\t\t\treturn FlowRouter.route(roomConfig.route.path, routeConfig);\n\t\t}\n\t}\n\n\thasCustomLink(roomType) {\n\t\treturn this.roomTypes[roomType] && this.roomTypes[roomType].route && this.roomTypes[roomType].route.link != null;\n\t}\n\n\t/**\n\t * @param {string} roomType room type (e.g.: c (for channels), d (for direct channels))\n\t * @param {object} subData the user's subscription data\n\t */\n\tgetRouteLink(roomType, subData) {\n\t\tif (!this.roomTypes[roomType]) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet routeData = {};\n\t\tif (this.roomTypes[roomType] && this.roomTypes[roomType].route && this.roomTypes[roomType].route.link) {\n\t\t\trouteData = this.roomTypes[roomType].route.link(subData);\n\t\t} else if (subData && subData.name) {\n\t\t\trouteData = {\n\t\t\t\tname: subData.name\n\t\t\t};\n\t\t}\n\n\t\treturn FlowRouter.path(this.roomTypes[roomType].route.name, routeData);\n\t}\n\n\topenRouteLink(roomType, subData, queryParams) {\n\t\tif (!this.roomTypes[roomType]) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet routeData = {};\n\t\tif (this.roomTypes[roomType] && this.roomTypes[roomType].route && this.roomTypes[roomType].route.link) {\n\t\t\trouteData = this.roomTypes[roomType].route.link(subData);\n\t\t} else if (subData && subData.name) {\n\t\t\trouteData = {\n\t\t\t\tname: subData.name\n\t\t\t};\n\t\t}\n\n\t\treturn FlowRouter.go(this.roomTypes[roomType].route.name, routeData, queryParams);\n\t}\n}\n","RocketChat.slashCommands = {\n\tcommands: {}\n};\n\nRocketChat.slashCommands.add = function _addingSlashCommand(command, callback, options = {}, result, providesPreview = false, previewer, previewCallback) {\n\tRocketChat.slashCommands.commands[command] = {\n\t\tcommand,\n\t\tcallback,\n\t\tparams: options.params,\n\t\tdescription: options.description,\n\t\tpermission: options.permission,\n\t\tclientOnly: options.clientOnly || false,\n\t\tresult,\n\t\tprovidesPreview,\n\t\tpreviewer,\n\t\tpreviewCallback\n\t};\n};\n\nRocketChat.slashCommands.run = function _runningSlashCommand(command, params, message) {\n\tif (RocketChat.slashCommands.commands[command] && typeof RocketChat.slashCommands.commands[command].callback === 'function') {\n\t\tif (!message || !message.rid) {\n\t\t\tthrow new Meteor.Error('invalid-command-usage', 'Executing a command requires at least a message with a room id.');\n\t\t}\n\n\t\treturn RocketChat.slashCommands.commands[command].callback(command, params, message);\n\t}\n};\n\nRocketChat.slashCommands.getPreviews = function _gettingSlashCommandPreviews(command, params, message) {\n\tif (RocketChat.slashCommands.commands[command] && typeof RocketChat.slashCommands.commands[command].previewer === 'function') {\n\t\tif (!message || !message.rid) {\n\t\t\tthrow new Meteor.Error('invalid-command-usage', 'Executing a command requires at least a message with a room id.');\n\t\t}\n\n\t\t// { i18nTitle, items: [{ id, type, value }] }\n\t\tconst previewInfo = RocketChat.slashCommands.commands[command].previewer(command, params, message);\n\n\t\tif (typeof previewInfo !== 'object' || !Array.isArray(previewInfo.items) || previewInfo.items.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\t// A limit of ten results, to save time and bandwidth\n\t\tif (previewInfo.items.length >= 10) {\n\t\t\tpreviewInfo.items = previewInfo.items.slice(0, 10);\n\t\t}\n\n\t\treturn previewInfo;\n\t}\n};\n\nRocketChat.slashCommands.executePreview = function _executeSlashCommandPreview(command, params, message, preview) {\n\tif (RocketChat.slashCommands.commands[command] && typeof RocketChat.slashCommands.commands[command].previewCallback === 'function') {\n\t\tif (!message || !message.rid) {\n\t\t\tthrow new Meteor.Error('invalid-command-usage', 'Executing a command requires at least a message with a room id.');\n\t\t}\n\n\t\t// { id, type, value }\n\t\tif (!preview.id || !preview.type || !preview.value) {\n\t\t\tthrow new Meteor.Error('error-invalid-preview', 'Preview Item must have an id, type, and value.');\n\t\t}\n\n\t\treturn RocketChat.slashCommands.commands[command].previewCallback(command, params, message, preview);\n\t}\n};\n\nMeteor.methods({\n\tslashCommand(command) {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'slashCommand'\n\t\t\t});\n\t\t}\n\n\t\tif (!command || !command.cmd || !RocketChat.slashCommands.commands[command.cmd]) {\n\t\t\tthrow new Meteor.Error('error-invalid-command', 'Invalid Command Provided', {\n\t\t\t\tmethod: 'executeSlashCommandPreview'\n\t\t\t});\n\t\t}\n\n\t\treturn RocketChat.slashCommands.run(command.cmd, command.params, command.msg);\n\t}\n});\n","import s from 'underscore.string';\n\nRocketChat.Message = {\n\tparse(msg, language) {\n\t\tconst messageType = RocketChat.MessageTypes.getType(msg);\n\t\tif (messageType) {\n\t\t\tif (messageType.render) {\n\t\t\t\treturn messageType.render(msg);\n\t\t\t} else if (messageType.template) {\n\t\t\t\t// Render message\n\t\t\t\treturn;\n\t\t\t} else if (messageType.message) {\n\t\t\t\tif (!language && typeof localStorage !== 'undefined') {\n\t\t\t\t\tlanguage = localStorage.getItem('userLanguage');\n\t\t\t\t}\n\t\t\t\tconst data = (typeof messageType.data === 'function' && messageType.data(msg)) || {};\n\t\t\t\treturn TAPi18n.__(messageType.message, data, language);\n\t\t\t}\n\t\t}\n\t\tif (msg.u && msg.u.username === RocketChat.settings.get('Chatops_Username')) {\n\t\t\tmsg.html = msg.msg;\n\t\t\treturn msg.html;\n\t\t}\n\t\tmsg.html = msg.msg;\n\t\tif (s.trim(msg.html) !== '') {\n\t\t\tmsg.html = s.escapeHTML(msg.html);\n\t\t}\n\t\tmsg.html = msg.html.replace(/\\n/gm, '<br/>');\n\t\treturn msg.html;\n\t}\n};\n","import GraphemeSplitter from 'grapheme-splitter';\n\nconst splitter = new GraphemeSplitter();\n\nexport const messageProperties = {\n\n\tlength: (message => {\n\t\treturn splitter.countGraphemes(message);\n\t}),\n\n\tmessageWithoutEmojiShortnames: (message => {\n\t\treturn message.replace(/:\\w+:/gm, (match) => {\n\t\t\tif (RocketChat.emoji.list[match] !== undefined) {\n\t\t\t\treturn ' ';\n\t\t\t}\n\t\t\treturn match;\n\t\t});\n\t})\n};\n\n// check for tests\nif (typeof RocketChat !== 'undefined') {\n\tRocketChat.messageProperties = messageProperties;\n}\n","RocketChat.messageBox = {};\n\nRocketChat.messageBox.actions = new class {\n\tconstructor() {\n\t\tthis.actions = {};\n\t}\n\n\t/* Add a action to messagebox\n\t@param group\n\t@param label\n\t@param config\n\ticon: icon class\n\taction: action function\n\tcondition: condition to display the action\n\t*/\n\n\tadd(group, label, config) {\n\t\tif (!group && !label && !config) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.actions[group]) {\n\t\t\tthis.actions[group] = [];\n\t\t}\n\n\t\tconst actionExists = this.actions[group].find((action) => {\n\t\t\treturn action.label === label;\n\t\t});\n\n\t\tif (actionExists) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.actions[group].push({...config, label});\n\t}\n\n\tget(group) {\n\t\tif (!group) {\n\t\t\treturn Object.keys(this.actions).reduce((ret, key) => {\n\t\t\t\tconst actions = this.actions[key].filter(action => !action.condition || action.condition());\n\t\t\t\tif (actions.length) {\n\t\t\t\t\tret[key] = actions;\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t\t}, {});\n\t\t}\n\n\t\treturn this.actions[group].filter(action => !action.condition || action.condition());\n\t}\n\n\tgetById(id) {\n\t\tconst messageActions = this.actions;\n\t\tlet actions = [];\n\t\tObject.keys(messageActions).forEach(function(action) {\n\t\t\tactions = actions.concat(messageActions[action]);\n\t\t});\n\n\t\treturn actions.filter(action => action.id === id);\n\t}\n};\n","RocketChat.MessageTypes = new class {\n\tconstructor() {\n\t\tthis.types = {};\n\t}\n\n\tregisterType(options) {\n\t\treturn this.types[options.id] = options;\n\t}\n\n\tgetType(message) {\n\t\treturn this.types[message && message.t];\n\t}\n\n\tisSystemMessage(message) {\n\t\tconst type = this.types[message && message.t];\n\t\treturn type && type.system;\n\t}\n\n};\n\nMeteor.startup(function() {\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'r',\n\t\tsystem: true,\n\t\tmessage: 'Room_name_changed',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\troom_name: message.msg,\n\t\t\t\tuser_by: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'au',\n\t\tsystem: true,\n\t\tmessage: 'User_added_by',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_added: message.msg,\n\t\t\t\tuser_by: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'ru',\n\t\tsystem: true,\n\t\tmessage: 'User_removed_by',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_removed: message.msg,\n\t\t\t\tuser_by: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'ul',\n\t\tsystem: true,\n\t\tmessage: 'User_left',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_left: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'uj',\n\t\tsystem: true,\n\t\tmessage: 'User_joined_channel',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'wm',\n\t\tsystem: true,\n\t\tmessage: 'Welcome',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'rm',\n\t\tsystem: true,\n\t\tmessage: 'Message_removed',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'rtc',\n\t\trender(message) {\n\t\t\treturn RocketChat.callbacks.run('renderRtcMessage', message);\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'user-muted',\n\t\tsystem: true,\n\t\tmessage: 'User_muted_by',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_muted: message.msg,\n\t\t\t\tuser_by: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'user-unmuted',\n\t\tsystem: true,\n\t\tmessage: 'User_unmuted_by',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_unmuted: message.msg,\n\t\t\t\tuser_by: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'subscription-role-added',\n\t\tsystem: true,\n\t\tmessage: '__username__was_set__role__by__user_by_',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tusername: message.msg,\n\t\t\t\trole: message.role,\n\t\t\t\tuser_by: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'subscription-role-removed',\n\t\tsystem: true,\n\t\tmessage: '__username__is_no_longer__role__defined_by__user_by_',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tusername: message.msg,\n\t\t\t\trole: message.role,\n\t\t\t\tuser_by: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'room-archived',\n\t\tsystem: true,\n\t\tmessage: 'This_room_has_been_archived_by__username_',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tusername: message.u.username\n\t\t\t};\n\t\t}\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'room-unarchived',\n\t\tsystem: true,\n\t\tmessage: 'This_room_has_been_unarchived_by__username_',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tusername: message.u.username\n\t\t\t};\n\t\t}\n\t});\n});\n","let logger;\n\nif (Meteor.isServer) {\n\tlogger = new Logger('TemplateVarHandler', {});\n}\n\nRocketChat.templateVarHandler = function(variable, object) {\n\n\tconst templateRegex = /#{([\\w\\-]+)}/gi;\n\tlet match = templateRegex.exec(variable);\n\tlet tmpVariable = variable;\n\n\tif (match == null) {\n\t\tif (!object.hasOwnProperty(variable)) {\n\t\t\tlogger && logger.debug(`user does not have attribute: ${ variable }`);\n\t\t\treturn;\n\t\t}\n\t\treturn object[variable];\n\t} else {\n\t\tlogger && logger.debug('template found. replacing values');\n\t\twhile (match != null) {\n\t\t\tconst tmplVar = match[0];\n\t\t\tconst tmplAttrName = match[1];\n\n\t\t\tif (!object.hasOwnProperty(tmplAttrName)) {\n\t\t\t\tlogger && logger.debug(`user does not have attribute: ${ tmplAttrName }`);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst attrVal = object[tmplAttrName];\n\t\t\tlogger && logger.debug(`replacing template var: ${ tmplVar } with value: ${ attrVal }`);\n\t\t\ttmpVariable = tmpVariable.replace(tmplVar, attrVal);\n\t\t\tmatch = templateRegex.exec(variable);\n\t\t}\n\t\treturn tmpVariable;\n\t}\n};\n","RocketChat.getUserNotificationPreference = function _getUserNotificationPreference(user, pref) {\n\tif (typeof user === 'string') {\n\t\tuser = RocketChat.models.Users.findOneById(user);\n\t}\n\n\tlet preferenceKey;\n\tswitch (pref) {\n\t\tcase 'desktop': preferenceKey = 'desktopNotifications'; break;\n\t\tcase 'mobile': preferenceKey = 'mobileNotifications'; break;\n\t\tcase 'email': preferenceKey = 'emailNotificationMode'; break;\n\t}\n\n\tif (user && user.settings && user.settings.preferences && user.settings.preferences[preferenceKey] !== 'default') {\n\t\treturn {\n\t\t\tvalue: user.settings.preferences[preferenceKey],\n\t\t\torigin: 'user'\n\t\t};\n\t}\n\tconst serverValue = RocketChat.settings.get(`Accounts_Default_User_Preferences_${ preferenceKey }`);\n\tif (serverValue) {\n\t\treturn {\n\t\t\tvalue: serverValue,\n\t\t\torigin: 'server'\n\t\t};\n\t}\n\n\treturn null;\n};\n","/**\n * Tries to retrieve the user preference falling back to a default system\n * value or to a default value if it is passed as argument\n*/\nRocketChat.getUserPreference = function(user, key, defaultValue=undefined) {\n\tlet preference;\n\tif (typeof user === typeof '') {\n\t\tuser = RocketChat.models.Users.findOne(user, {fields: {[`settings.preferences.${ key }`]: 1}});\n\t}\n\tif (user && user.settings && user.settings.preferences &&\n\t\tuser.settings.preferences.hasOwnProperty(key)) {\n\t\tpreference = user.settings.preferences[key];\n\t} else if (defaultValue === undefined) {\n\t\tpreference = RocketChat.settings.get(`Accounts_Default_User_Preferences_${ key }`);\n\t}\n\n\treturn preference !== undefined ? preference : defaultValue;\n};\n","/* globals WebAppInternals */\nRocketChat.settings.get('Site_Url', function(key, value) {\n\tif (value == null || value.trim() === '') {\n\t\treturn;\n\t}\n\tlet host = value.replace(/\\/$/, '');\n\t// let prefix = '';\n\tconst match = value.match(/([^\\/]+\\/{2}[^\\/]+)(\\/.+)/);\n\tif (match != null) {\n\t\thost = match[1];\n\t\t// prefix = match[2].replace(/\\/$/, '');\n\t}\n\t__meteor_runtime_config__.ROOT_URL = value;\n\n\tif (Meteor.absoluteUrl.defaultOptions && Meteor.absoluteUrl.defaultOptions.rootUrl) {\n\t\tMeteor.absoluteUrl.defaultOptions.rootUrl = value;\n\t}\n\tif (Meteor.isServer) {\n\t\tRocketChat.hostname = host.replace(/^https?:\\/\\//, '');\n\t\tprocess.env.MOBILE_ROOT_URL = host;\n\t\tprocess.env.MOBILE_DDP_URL = host;\n\t\tif (typeof WebAppInternals !== 'undefined' && WebAppInternals.generateBoilerplate) {\n\t\t\treturn WebAppInternals.generateBoilerplate();\n\t\t}\n\t}\n});\n","/* global InstanceStatus */\nimport _ from 'underscore';\n\nconst logger = new Logger('Meteor', {\n\tmethods: {\n\t\tmethod: {\n\t\t\ttype: 'debug'\n\t\t},\n\t\tpublish: {\n\t\t\ttype: 'debug'\n\t\t}\n\t}\n});\n\nlet Log_Trace_Methods;\nlet Log_Trace_Subscriptions;\nRocketChat.settings.get('Log_Trace_Methods', (key, value) => Log_Trace_Methods = value);\nRocketChat.settings.get('Log_Trace_Subscriptions', (key, value) => Log_Trace_Subscriptions = value);\n\nlet Log_Trace_Methods_Filter;\nlet Log_Trace_Subscriptions_Filter;\nRocketChat.settings.get('Log_Trace_Methods_Filter', (key, value) => Log_Trace_Methods_Filter = value ? new RegExp(value) : undefined);\nRocketChat.settings.get('Log_Trace_Subscriptions_Filter', (key, value) => Log_Trace_Subscriptions_Filter = value ? new RegExp(value) : undefined);\n\nconst traceConnection = (enable, filter, prefix, name, connection, userId) => {\n\tif (!enable) {\n\t\treturn;\n\t}\n\n\tif (filter && !filter.test(name)) {\n\t\treturn;\n\t}\n\n\tif (connection) {\n\t\tconsole.log(name, {\n\t\t\tid: connection.id,\n\t\t\tclientAddress: connection.clientAddress,\n\t\t\thttpHeaders: connection.httpHeaders,\n\t\t\tuserId\n\t\t});\n\t} else {\n\t\tconsole.log(name, 'no-connection');\n\t}\n};\n\nconst wrapMethods = function(name, originalHandler, methodsMap) {\n\tmethodsMap[name] = function() {\n\t\ttraceConnection(Log_Trace_Methods, Log_Trace_Methods_Filter, 'method', name, this.connection, this.userId);\n\t\tconst end = RocketChat.metrics.meteorMethods.startTimer({method: name});\n\t\tconst args = name === 'ufsWrite' ? Array.prototype.slice.call(arguments, 1) : arguments;\n\t\tlogger.method(name, '-> userId:', Meteor.userId(), ', arguments: ', args);\n\n\t\tthis.unblock();\n\t\tconst result = originalHandler.apply(this, arguments);\n\t\tend();\n\t\treturn result;\n\t};\n};\n\nconst originalMeteorMethods = Meteor.methods;\n\nMeteor.methods = function(methodMap) {\n\t_.each(methodMap, function(handler, name) {\n\t\twrapMethods(name, handler, methodMap);\n\t});\n\toriginalMeteorMethods(methodMap);\n};\n\nconst originalMeteorPublish = Meteor.publish;\n\nMeteor.publish = function(name, func) {\n\treturn originalMeteorPublish(name, function() {\n\t\ttraceConnection(Log_Trace_Subscriptions, Log_Trace_Subscriptions_Filter, 'subscription', name, this.connection, this.userId);\n\t\tlogger.publish(name, '-> userId:', this.userId, ', arguments: ', arguments);\n\t\tconst end = RocketChat.metrics.meteorSubscriptions.startTimer({subscription: name});\n\n\t\tconst originalReady = this.ready;\n\t\tthis.ready = function() {\n\t\t\tend();\n\t\t\treturn originalReady.apply(this, arguments);\n\t\t};\n\n\t\treturn func.apply(this, arguments);\n\t});\n};\n\nWebApp.rawConnectHandlers.use(function(req, res, next) {\n\tres.setHeader('X-Instance-ID', InstanceStatus.id());\n\treturn next();\n});\n","import bugsnag from 'bugsnag';\n\nRocketChat.bugsnag = bugsnag;\n\nRocketChat.settings.get('Bugsnag_api_key', (key, value) => {\n\tif (value) {\n\t\tbugsnag.register(value);\n\t}\n});\n\nconst notify = function(message, stack) {\n\tif (typeof stack === 'string') {\n\t\tmessage += ` ${ stack }`;\n\t}\n\tlet options = {};\n\tif (RocketChat.Info) {\n\t\toptions = { app: { version: RocketChat.Info.version, info: RocketChat.Info } };\n\t}\n\tconst error = new Error(message);\n\terror.stack = stack;\n\tRocketChat.bugsnag.notify(error, options);\n};\n\nprocess.on('uncaughtException', Meteor.bindEnvironment((error) => {\n\tnotify(error.message, error.stack);\n\tthrow error;\n}));\n\nconst originalMeteorDebug = Meteor._debug;\nMeteor._debug = function() {\n\tnotify(...arguments);\n\treturn originalMeteorDebug(...arguments);\n};\n","import client from 'prom-client';\nimport connect from 'connect';\nimport http from 'http';\nimport _ from 'underscore';\n\nRocketChat.promclient = client;\nclient.collectDefaultMetrics();\n\nRocketChat.metrics = {};\n\n// one sample metrics only - a counter\n\nRocketChat.metrics.meteorMethods = new client.Summary({\n\tname: 'rocketchat_meteor_methods',\n\thelp: 'summary of meteor methods count and time',\n\tlabelNames: ['method']\n});\n\nRocketChat.metrics.rocketchatCallbacks = new client.Summary({\n\tname: 'rocketchat_callbacks',\n\thelp: 'summary of rocketchat callbacks count and time',\n\tlabelNames: ['hook', 'callback']\n});\n\nRocketChat.metrics.rocketchatHooks = new client.Summary({\n\tname: 'rocketchat_hooks',\n\thelp: 'summary of rocketchat hooks count and time',\n\tlabelNames: ['hook', 'callbacks_length']\n});\n\nRocketChat.metrics.rocketchatRestApi = new client.Summary({\n\tname: 'rocketchat_rest_api',\n\thelp: 'summary of rocketchat rest api count and time',\n\tlabelNames: ['method', 'entrypoint', 'user_agent', 'status', 'version']\n});\n\nRocketChat.metrics.meteorSubscriptions = new client.Summary({\n\tname: 'rocketchat_meteor_subscriptions',\n\thelp: 'summary of meteor subscriptions count and time',\n\tlabelNames: ['subscription']\n});\n\nRocketChat.metrics.messagesSent = new client.Counter({'name': 'rocketchat_message_sent', 'help': 'cumulated number of messages sent'});\nRocketChat.metrics.notificationsSent = new client.Counter({'name': 'rocketchat_notification_sent', labelNames: ['notification_type'], 'help': 'cumulated number of notifications sent'});\n\nRocketChat.metrics.ddpSessions = new client.Gauge({'name': 'rocketchat_ddp_sessions_count', 'help': 'number of open ddp sessions'});\nRocketChat.metrics.ddpAthenticatedSessions = new client.Gauge({'name': 'rocketchat_ddp_sessions_auth', 'help': 'number of authenticated open ddp sessions'});\nRocketChat.metrics.ddpConnectedUsers = new client.Gauge({'name': 'rocketchat_ddp_connected_users', 'help': 'number of unique connected users'});\n\nRocketChat.metrics.version = new client.Gauge({'name': 'rocketchat_version', labelNames: ['version'], 'help': 'Rocket.Chat version'});\nRocketChat.metrics.migration = new client.Gauge({'name': 'rocketchat_migration', 'help': 'migration versoin'});\nRocketChat.metrics.instanceCount = new client.Gauge({'name': 'rocketchat_instance_count', 'help': 'instances running'});\nRocketChat.metrics.oplogEnabled = new client.Gauge({'name': 'rocketchat_oplog_enabled', labelNames: ['enabled'], 'help': 'oplog enabled'});\n\n// User statistics\nRocketChat.metrics.totalUsers = new client.Gauge({'name': 'rocketchat_users_total', 'help': 'total of users'});\nRocketChat.metrics.activeUsers = new client.Gauge({'name': 'rocketchat_users_active', 'help': 'total of active users'});\nRocketChat.metrics.nonActiveUsers = new client.Gauge({'name': 'rocketchat_users_non_active', 'help': 'total of non active users'});\nRocketChat.metrics.onlineUsers = new client.Gauge({'name': 'rocketchat_users_online', 'help': 'total of users online'});\nRocketChat.metrics.awayUsers = new client.Gauge({'name': 'rocketchat_users_away', 'help': 'total of users away'});\nRocketChat.metrics.offlineUsers = new client.Gauge({'name': 'rocketchat_users_offline', 'help': 'total of users offline'});\n\n// Room statistics\nRocketChat.metrics.totalRooms = new client.Gauge({'name': 'rocketchat_rooms_total', 'help': 'total of rooms'});\nRocketChat.metrics.totalChannels = new client.Gauge({'name': 'rocketchat_channels_total', 'help': 'total of public rooms/channels'});\nRocketChat.metrics.totalPrivateGroups = new client.Gauge({'name': 'rocketchat_private_groups_total', 'help': 'total of private rooms'});\nRocketChat.metrics.totalDirect = new client.Gauge({'name': 'rocketchat_direct_total', 'help': 'total of direct rooms'});\nRocketChat.metrics.totalLivechat = new client.Gauge({'name': 'rocketchat_livechat_total', 'help': 'total of livechat rooms'});\n\n// Message statistics\nRocketChat.metrics.totalMessages = new client.Gauge({'name': 'rocketchat_messages_total', 'help': 'total of messages'});\nRocketChat.metrics.totalChannelMessages = new client.Gauge({'name': 'rocketchat_channel_messages_total', 'help': 'total of messages in public rooms'});\nRocketChat.metrics.totalPrivateGroupMessages = new client.Gauge({'name': 'rocketchat_private_group_messages_total', 'help': 'total of messages in private rooms'});\nRocketChat.metrics.totalDirectMessages = new client.Gauge({'name': 'rocketchat_direct_messages_total', 'help': 'total of messages in direct rooms'});\nRocketChat.metrics.totalLivechatMessages = new client.Gauge({'name': 'rocketchat_livechat_messages_total', 'help': 'total of messages in livechat rooms'});\n\nclient.register.setDefaultLabels({\n\tuniqueId: RocketChat.settings.get('uniqueID'),\n\tsiteUrl: RocketChat.settings.get('Site_Url')\n});\n\nconst setPrometheusData = () => {\n\tconst date = new Date();\n\n\tclient.register.setDefaultLabels({\n\t\tunique_id: RocketChat.settings.get('uniqueID'),\n\t\tsite_url: RocketChat.settings.get('Site_Url'),\n\t\tversion: RocketChat.Info.version\n\t});\n\n\tconst sessions = Object.values(Meteor.server.sessions);\n\tconst authenticatedSessions = sessions.filter(s => s.userId);\n\tRocketChat.metrics.ddpSessions.set(sessions.length, date);\n\tRocketChat.metrics.ddpAthenticatedSessions.set(authenticatedSessions.length, date);\n\tRocketChat.metrics.ddpConnectedUsers.set(_.unique(authenticatedSessions.map(s => s.userId)).length, date);\n\n\tif (!RocketChat.models.Statistics) {\n\t\treturn;\n\t}\n\n\tconst statistics = RocketChat.models.Statistics.findLast();\n\tif (!statistics) {\n\t\treturn;\n\t}\n\n\tRocketChat.metrics.version.set({version: statistics.version}, 1, date);\n\tRocketChat.metrics.migration.set(RocketChat.Migrations._getControl().version, date);\n\tRocketChat.metrics.instanceCount.set(statistics.instanceCount, date);\n\tRocketChat.metrics.oplogEnabled.set({enabled: statistics.oplogEnabled}, 1, date);\n\n\t// User statistics\n\tRocketChat.metrics.totalUsers.set(statistics.totalUsers, date);\n\tRocketChat.metrics.activeUsers.set(statistics.activeUsers, date);\n\tRocketChat.metrics.nonActiveUsers.set(statistics.nonActiveUsers, date);\n\tRocketChat.metrics.onlineUsers.set(statistics.onlineUsers, date);\n\tRocketChat.metrics.awayUsers.set(statistics.awayUsers, date);\n\tRocketChat.metrics.offlineUsers.set(statistics.offlineUsers, date);\n\n\t// Room statistics\n\tRocketChat.metrics.totalRooms.set(statistics.totalRooms, date);\n\tRocketChat.metrics.totalChannels.set(statistics.totalChannels, date);\n\tRocketChat.metrics.totalPrivateGroups.set(statistics.totalPrivateGroups, date);\n\tRocketChat.metrics.totalDirect.set(statistics.totalDirect, date);\n\tRocketChat.metrics.totalLivechat.set(statistics.totalLivechat, date);\n\n\t// Message statistics\n\tRocketChat.metrics.totalMessages.set(statistics.totalMessages, date);\n\tRocketChat.metrics.totalChannelMessages.set(statistics.totalChannelMessages, date);\n\tRocketChat.metrics.totalPrivateGroupMessages.set(statistics.totalPrivateGroupMessages, date);\n\tRocketChat.metrics.totalDirectMessages.set(statistics.totalDirectMessages, date);\n\tRocketChat.metrics.totalLivechatMessages.set(statistics.totalLivechatMessages, date);\n};\n\nconst app = connect();\n\n// const compression = require('compression');\n// app.use(compression());\n\napp.use('/metrics', (req, res) => {\n\tres.setHeader('Content-Type', 'text/plain');\n\tres.end(RocketChat.promclient.register.metrics());\n});\n\nconst server = http.createServer(app);\n\nlet timer;\nconst updatePrometheusConfig = () => {\n\tconst port = RocketChat.settings.get('Prometheus_Port');\n\tconst enabled = RocketChat.settings.get('Prometheus_Enabled');\n\n\tif (port == null || enabled == null) {\n\t\treturn;\n\t}\n\n\tif (enabled === true) {\n\t\tserver.listen({\n\t\t\tport,\n\t\t\thost: process.env.BIND_IP || '0.0.0.0'\n\t\t});\n\t\ttimer = Meteor.setInterval(setPrometheusData, 5000);\n\t} else {\n\t\tserver.close();\n\t\tMeteor.clearInterval(timer);\n\t}\n};\n\nRocketChat.settings.get('Prometheus_Enabled', updatePrometheusConfig);\nRocketChat.settings.get('Prometheus_Port', updatePrometheusConfig);\n","/* globals RateLimiter */\nimport _ from 'underscore';\n\nRocketChat.RateLimiter = new class {\n\tlimitFunction(fn, numRequests, timeInterval, matchers) {\n\t\tif (process.env.TEST_MODE === 'true') {\n\t\t\treturn fn;\n\t\t}\n\t\tconst rateLimiter = new RateLimiter();\n\t\trateLimiter.addRule(matchers, numRequests, timeInterval);\n\t\treturn function(...args) {\n\t\t\tconst match = {};\n\t\t\t_.each(matchers, function(matcher, key) {\n\t\t\t\treturn match[key] = args[key];\n\t\t\t});\n\t\t\trateLimiter.increment(match);\n\t\t\tconst rateLimitResult = rateLimiter.check(match);\n\t\t\tif (rateLimitResult.allowed) {\n\t\t\t\treturn fn.apply(null, arguments);\n\t\t\t} else {\n\t\t\t\tthrow new Meteor.Error('error-too-many-requests', `Error, too many requests. Please slow down. You must wait ${ Math.ceil(rateLimitResult.timeToReset / 1000) } seconds before trying again.`, {\n\t\t\t\t\ttimeToReset: rateLimitResult.timeToReset,\n\t\t\t\t\tseconds: Math.ceil(rateLimitResult.timeToReset / 1000)\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tlimitMethod(methodName, numRequests, timeInterval, matchers) {\n\t\tif (process.env.TEST_MODE === 'true') {\n\t\t\treturn;\n\t\t}\n\t\tconst match = {\n\t\t\ttype: 'method',\n\t\t\tname: methodName\n\t\t};\n\t\t_.each(matchers, function(matcher, key) {\n\t\t\treturn match[key] = matchers[key];\n\t\t});\n\t\treturn DDPRateLimiter.addRule(match, numRequests, timeInterval);\n\t}\n\n};\n","/* globals LoggerManager */\nRocketChat.settings.get('Log_Package', function(key, value) {\n\treturn LoggerManager.showPackage = value;\n});\n\nRocketChat.settings.get('Log_File', function(key, value) {\n\treturn LoggerManager.showFileAndLine = value;\n});\n\nRocketChat.settings.get('Log_Level', function(key, value) {\n\tif (value != null) {\n\t\tLoggerManager.logLevel = parseInt(value);\n\t\tMeteor.setTimeout(() => {\n\t\t\treturn LoggerManager.enable(true);\n\t\t}, 200);\n\t}\n});\n","/* globals Push */\nclass PushNotification {\n\tgetNotificationId(roomId) {\n\t\tconst serverId = RocketChat.settings.get('uniqueID');\n\t\treturn this.hash(`${ serverId }|${ roomId }`); // hash\n\t}\n\n\thash(str) {\n\t\tlet hash = 0;\n\t\tlet i = str.length;\n\n\t\twhile (i) {\n\t\t\thash = ((hash << 5) - hash) + str.charCodeAt(--i);\n\t\t\thash = hash & hash; // Convert to 32bit integer\n\t\t}\n\t\treturn hash;\n\t}\n\n\tsend({ roomName, roomId, username, message, usersTo, payload, badge = 1, category }) {\n\t\tlet title;\n\t\tif (roomName && roomName !== '') {\n\t\t\ttitle = `${ roomName }`;\n\t\t\tmessage = `${ username }: ${ message }`;\n\t\t} else {\n\t\t\ttitle = `${ username }`;\n\t\t}\n\t\tconst icon = RocketChat.settings.get('Assets_favicon_192').url || RocketChat.settings.get('Assets_favicon_192').defaultUrl;\n\t\tconst config = {\n\t\t\tfrom: 'push',\n\t\t\tbadge,\n\t\t\tsound: 'default',\n\t\t\ttitle,\n\t\t\ttext: message,\n\t\t\tpayload,\n\t\t\tquery: usersTo,\n\t\t\tnotId: this.getNotificationId(roomId),\n\t\t\tgcm: {\n\t\t\t\tstyle: 'inbox',\n\t\t\t\tsummaryText: '%n% new messages',\n\t\t\t\timage: RocketChat.getURL(icon, { full: true })\n\t\t\t}\n\t\t};\n\n\t\tif (category !== '') {\n\t\t\tconfig.apn = {\n\t\t\t\tcategory\n\t\t\t};\n\t\t}\n\n\t\tRocketChat.metrics.notificationsSent.inc({ notification_type: 'mobile' });\n\t\treturn Push.send(config);\n\t}\n}\n\nRocketChat.PushNotification = new PushNotification();\n","RocketChat.emailDomainDefaultBlackList = [\n\t'0-mail.com',\n\t'0815.ru',\n\t'0815.su',\n\t'0clickemail.com',\n\t'0wnd.net',\n\t'0wnd.org',\n\t'10mail.org',\n\t'10minut.com.pl',\n\t'10minutemail.co.za',\n\t'10minutemail.com',\n\t'10minutemail.de',\n\t'123-m.com',\n\t'1chuan.com',\n\t'1fsdfdsfsdf.tk',\n\t'1pad.de',\n\t'1zhuan.com',\n\t'20email.eu',\n\t'20mail.eu',\n\t'20mail.it',\n\t'20minutemail.com',\n\t'21cn.com',\n\t'2fdgdfgdfgdf.tk',\n\t'2prong.com',\n\t'30minutemail.com',\n\t'33mail.com',\n\t'3d-painting.com',\n\t'3trtretgfrfe.tk',\n\t'4gfdsgfdgfd.tk',\n\t'4warding.com',\n\t'4warding.net',\n\t'4warding.org',\n\t'5ghgfhfghfgh.tk',\n\t'60minutemail.com',\n\t'675hosting.com',\n\t'675hosting.net',\n\t'675hosting.org',\n\t'6hjgjhgkilkj.tk',\n\t'6ip.us',\n\t'6paq.com',\n\t'6url.com',\n\t'75hosting.com',\n\t'75hosting.net',\n\t'75hosting.org',\n\t'7days-printing.com',\n\t'7tags.com',\n\t'99experts.com',\n\t'9ox.net',\n\t'a-bc.net',\n\t'a45.in',\n\t'abcmail.email',\n\t'abyssmail.com',\n\t'acentri.com',\n\t'advantimo.com',\n\t'afrobacon.com',\n\t'ag.us.to',\n\t'agedmail.com',\n\t'ahk.jp',\n\t'ajaxapp.net',\n\t'alivance.com',\n\t'ama-trade.de',\n\t'amail.com',\n\t'amilegit.com',\n\t'amiri.net',\n\t'amiriindustries.com',\n\t'anappthat.com',\n\t'ano-mail.net',\n\t'anonbox.net',\n\t'anonmails.de',\n\t'anonymail.dk',\n\t'anonymbox.com',\n\t'antichef.com',\n\t'antichef.net',\n\t'antireg.ru',\n\t'antispam.de',\n\t'antispammail.de',\n\t'appixie.com',\n\t'armyspy.com',\n\t'artman-conception.com',\n\t'aver.com',\n\t'azmeil.tk',\n\t'baxomale.ht.cx',\n\t'beddly.com',\n\t'beefmilk.com',\n\t'bigprofessor.so',\n\t'bigstring.com',\n\t'binkmail.com',\n\t'bio-muesli.net',\n\t'blogmyway.org',\n\t'bobmail.info',\n\t'bofthew.com',\n\t'bootybay.de',\n\t'boun.cr',\n\t'bouncr.com',\n\t'boxformail.in',\n\t'breakthru.com',\n\t'brefmail.com',\n\t'brennendesreich.de',\n\t'broadbandninja.com',\n\t'bsnow.net',\n\t'bspamfree.org',\n\t'bu.mintemail.com',\n\t'buffemail.com',\n\t'bugmenot.com',\n\t'bumpymail.com',\n\t'bund.us',\n\t'bundes-li.ga',\n\t'burnthespam.info',\n\t'burstmail.info',\n\t'buymoreplays.com',\n\t'buyusedlibrarybooks.org',\n\t'byom.de',\n\t'c2.hu',\n\t'cachedot.net',\n\t'card.zp.ua',\n\t'casualdx.com',\n\t'cbair.com',\n\t'cek.pm',\n\t'cellurl.com',\n\t'centermail.com',\n\t'centermail.net',\n\t'chammy.info',\n\t'cheatmail.de',\n\t'childsavetrust.org',\n\t'chogmail.com',\n\t'choicemail1.com',\n\t'chong-mail.com',\n\t'chong-mail.net',\n\t'chong-mail.org',\n\t'clixser.com',\n\t'cmail.com',\n\t'cmail.net',\n\t'cmail.org',\n\t'coldemail.info',\n\t'consumerriot.com',\n\t'cool.fr.nf',\n\t'correo.blogos.net',\n\t'cosmorph.com',\n\t'courriel.fr.nf',\n\t'courrieltemporaire.com',\n\t'crapmail.org',\n\t'crazymailing.com',\n\t'cubiclink.com',\n\t'curryworld.de',\n\t'cust.in',\n\t'cuvox.de',\n\t'd3p.dk',\n\t'dacoolest.com',\n\t'daintly.com',\n\t'dandikmail.com',\n\t'dayrep.com',\n\t'dbunker.com',\n\t'dcemail.com',\n\t'deadaddress.com',\n\t'deadspam.com',\n\t'deagot.com',\n\t'dealja.com',\n\t'delikkt.de',\n\t'despam.it',\n\t'despammed.com',\n\t'devnullmail.com',\n\t'dfgh.net',\n\t'digitalsanctuary.com',\n\t'dingbone.com',\n\t'discard.email',\n\t'discardmail.com',\n\t'discardmail.de',\n\t'disposableaddress.com',\n\t'disposableemailaddresses.com',\n\t'disposableemailaddresses.emailmiser.com',\n\t'disposableinbox.com',\n\t'dispose.it',\n\t'disposeamail.com',\n\t'disposemail.com',\n\t'dispostable.com',\n\t'dlemail.ru',\n\t'dm.w3internet.co.uk',\n\t'dm.w3internet.co.ukexample.com',\n\t'dodgeit.com',\n\t'dodgit.com',\n\t'dodgit.org',\n\t'doiea.com',\n\t'domozmail.com',\n\t'donemail.ru',\n\t'dontreg.com',\n\t'dontsendmespam.de',\n\t'dotmsg.com',\n\t'drdrb.com',\n\t'drdrb.net',\n\t'droplar.com',\n\t'dropmail.me',\n\t'dt.com',\n\t'duam.net',\n\t'dudmail.com',\n\t'dump-email.info',\n\t'dumpandjunk.com',\n\t'dumpmail.de',\n\t'dumpyemail.com',\n\t'duskmail.com',\n\t'e-mail.com',\n\t'e-mail.org',\n\t'e4ward.com',\n\t'easytrashmail.com',\n\t'einmalmail.de',\n\t'einrot.com',\n\t'einrot.de',\n\t'eintagsmail.de',\n\t'email60.com',\n\t'emaildienst.de',\n\t'emailgo.de',\n\t'emailias.com',\n\t'emailigo.de',\n\t'emailinfive.com',\n\t'emaillime.com',\n\t'emailmiser.com',\n\t'emailproxsy.com',\n\t'emailsensei.com',\n\t'emailtemporanea.com',\n\t'emailtemporanea.net',\n\t'emailtemporar.ro',\n\t'emailtemporario.com.br',\n\t'emailthe.net',\n\t'emailtmp.com',\n\t'emailto.de',\n\t'emailwarden.com',\n\t'emailx.at.hm',\n\t'emailxfer.com',\n\t'emeil.in',\n\t'emeil.ir',\n\t'emil.com',\n\t'emz.net',\n\t'enterto.com',\n\t'ephemail.net',\n\t'ero-tube.org',\n\t'etranquil.com',\n\t'etranquil.net',\n\t'etranquil.org',\n\t'evopo.com',\n\t'explodemail.com',\n\t'express.net.ua',\n\t'eyepaste.com',\n\t'fakeinbox.com',\n\t'fakeinformation.com',\n\t'fakemail.fr',\n\t'fakemailz.com',\n\t'fammix.com',\n\t'fansworldwide.de',\n\t'fantasymail.de',\n\t'fastacura.com',\n\t'fastchevy.com',\n\t'fastchrysler.com',\n\t'fastkawasaki.com',\n\t'fastmazda.com',\n\t'fastmitsubishi.com',\n\t'fastnissan.com',\n\t'fastsubaru.com',\n\t'fastsuzuki.com',\n\t'fasttoyota.com',\n\t'fastyamaha.com',\n\t'fatflap.com',\n\t'fdfdsfds.com',\n\t'fightallspam.com',\n\t'figjs.com',\n\t'fiifke.de',\n\t'filzmail.com',\n\t'fivemail.de',\n\t'fixmail.tk',\n\t'fizmail.com',\n\t'fleckens.hu',\n\t'flemail.ru',\n\t'flyspam.com',\n\t'footard.com',\n\t'forgetmail.com',\n\t'fr33mail.info',\n\t'frapmail.com',\n\t'freundin.ru',\n\t'friendlymail.co.uk',\n\t'front14.org',\n\t'fuckingduh.com',\n\t'fudgerub.com',\n\t'fux0ringduh.com',\n\t'fyii.de',\n\t'garliclife.com',\n\t'gehensiemirnichtaufdensack.de',\n\t'gelitik.in',\n\t'get1mail.com',\n\t'get2mail.fr',\n\t'getairmail.com',\n\t'getmails.eu',\n\t'getonemail.com',\n\t'getonemail.net',\n\t'ghosttexter.de',\n\t'giantmail.de',\n\t'girlsundertheinfluence.com',\n\t'gishpuppy.com',\n\t'gmial.com',\n\t'goemailgo.com',\n\t'gorillaswithdirtyarmpits.com',\n\t'gotmail.com',\n\t'gotmail.net',\n\t'gotmail.org',\n\t'gotti.otherinbox.com',\n\t'gowikibooks.com',\n\t'gowikicampus.com',\n\t'gowikicars.com',\n\t'gowikifilms.com',\n\t'gowikigames.com',\n\t'gowikimusic.com',\n\t'gowikimusic.great-host.in',\n\t'gowikinetwork.com',\n\t'gowikitravel.com',\n\t'gowikitv.com',\n\t'grandmamail.com',\n\t'grandmasmail.com',\n\t'great-host.in',\n\t'greensloth.com',\n\t'grr.la',\n\t'gsrv.co.uk',\n\t'guerillamail.biz',\n\t'guerillamail.com',\n\t'guerillamail.net',\n\t'guerillamail.org',\n\t'guerrillamail.biz',\n\t'guerrillamail.com',\n\t'guerrillamail.de',\n\t'guerrillamail.info',\n\t'guerrillamail.net',\n\t'guerrillamail.org',\n\t'guerrillamailblock.com',\n\t'gustr.com',\n\t'h.mintemail.com',\n\t'h8s.org',\n\t'hacccc.com',\n\t'haltospam.com',\n\t'harakirimail.com',\n\t'hartbot.de',\n\t'hat-geld.de',\n\t'hatespam.org',\n\t'hellodream.mobi',\n\t'herp.in',\n\t'hidemail.de',\n\t'hidzz.com',\n\t'hmamail.com',\n\t'hochsitze.com',\n\t'hopemail.biz',\n\t'hotpop.com',\n\t'hulapla.de',\n\t'iaoss.com',\n\t'ieatspam.eu',\n\t'ieatspam.info',\n\t'ieh-mail.de',\n\t'ihateyoualot.info',\n\t'iheartspam.org',\n\t'ikbenspamvrij.nl',\n\t'imails.info',\n\t'imgof.com',\n\t'imstations.com',\n\t'inbax.tk',\n\t'inbox.si',\n\t'inboxalias.com',\n\t'inboxclean.com',\n\t'inboxclean.org',\n\t'inboxproxy.com',\n\t'incognitomail.com',\n\t'incognitomail.net',\n\t'incognitomail.org',\n\t'infocom.zp.ua',\n\t'inoutmail.de',\n\t'inoutmail.eu',\n\t'inoutmail.info',\n\t'inoutmail.net',\n\t'insorg-mail.info',\n\t'instant-mail.de',\n\t'ip6.li',\n\t'ipoo.org',\n\t'irish2me.com',\n\t'iwi.net',\n\t'jamit.com.au',\n\t'jetable.com',\n\t'jetable.fr.nf',\n\t'jetable.net',\n\t'jetable.org',\n\t'jnxjn.com',\n\t'jourrapide.com',\n\t'jsrsolutions.com',\n\t'junk1e.com',\n\t'kasmail.com',\n\t'kaspop.com',\n\t'keepmymail.com',\n\t'killmail.com',\n\t'killmail.net',\n\t'kimsdisk.com',\n\t'kingsq.ga',\n\t'kir.ch.tc',\n\t'klassmaster.com',\n\t'klassmaster.net',\n\t'klzlk.com',\n\t'kook.ml',\n\t'koszmail.pl',\n\t'kulturbetrieb.info',\n\t'kurzepost.de',\n\t'l33r.eu',\n\t'lackmail.net',\n\t'lags.us',\n\t'lawlita.com',\n\t'lazyinbox.com',\n\t'letthemeatspam.com',\n\t'lhsdv.com',\n\t'lifebyfood.com',\n\t'link2mail.net',\n\t'litedrop.com',\n\t'loadby.us',\n\t'login-email.ml',\n\t'lol.ovpn.to',\n\t'lolfreak.net',\n\t'lookugly.com',\n\t'lopl.co.cc',\n\t'lortemail.dk',\n\t'lovemeleaveme.com',\n\t'lr78.com',\n\t'lroid.com',\n\t'lukop.dk',\n\t'm21.cc',\n\t'm4ilweb.info',\n\t'maboard.com',\n\t'mail-filter.com',\n\t'mail-temporaire.fr',\n\t'mail.by',\n\t'mail.mezimages.net',\n\t'mail.zp.ua',\n\t'mail114.net',\n\t'mail1a.de',\n\t'mail21.cc',\n\t'mail2rss.org',\n\t'mail333.com',\n\t'mail4trash.com',\n\t'mailbidon.com',\n\t'mailbiz.biz',\n\t'mailblocks.com',\n\t'mailbucket.org',\n\t'mailcat.biz',\n\t'mailcatch.com',\n\t'mailde.de',\n\t'mailde.info',\n\t'maildrop.cc',\n\t'maildx.com',\n\t'maileater.com',\n\t'mailed.ro',\n\t'maileimer.de',\n\t'mailexpire.com',\n\t'mailfa.tk',\n\t'mailforspam.com',\n\t'mailfreeonline.com',\n\t'mailfs.com',\n\t'mailguard.me',\n\t'mailimate.com',\n\t'mailin8r.com',\n\t'mailinater.com',\n\t'mailinator.com',\n\t'mailinator.net',\n\t'mailinator.org',\n\t'mailinator.us',\n\t'mailinator2.com',\n\t'mailincubator.com',\n\t'mailismagic.com',\n\t'mailmate.com',\n\t'mailme.ir',\n\t'mailme.lv',\n\t'mailme24.com',\n\t'mailmetrash.com',\n\t'mailmetrash.comilzilla.org',\n\t'mailmoat.com',\n\t'mailms.com',\n\t'mailnator.com',\n\t'mailnesia.com',\n\t'mailnull.com',\n\t'mailorg.org',\n\t'mailpick.biz',\n\t'mailproxsy.com',\n\t'mailquack.com',\n\t'mailrock.biz',\n\t'mailscrap.com',\n\t'mailshell.com',\n\t'mailsiphon.com',\n\t'mailslapping.com',\n\t'mailslite.com',\n\t'mailtemp.info',\n\t'mailtome.de',\n\t'mailtothis.com',\n\t'mailtrash.net',\n\t'mailtv.net',\n\t'mailtv.tv',\n\t'mailzilla.com',\n\t'mailzilla.org',\n\t'mailzilla.orgmbx.cc',\n\t'makemetheking.com',\n\t'manifestgenerator.com',\n\t'manybrain.com',\n\t'mbx.cc',\n\t'mega.zik.dj',\n\t'meinspamschutz.de',\n\t'meltmail.com',\n\t'messagebeamer.de',\n\t'mezimages.net',\n\t'mierdamail.com',\n\t'migumail.com',\n\t'ministry-of-silly-walks.de',\n\t'mintemail.com',\n\t'misterpinball.de',\n\t'mjukglass.nu',\n\t'mmailinater.com',\n\t'moakt.com',\n\t'mobi.web.id',\n\t'mobileninja.co.uk',\n\t'moburl.com',\n\t'mohmal.com',\n\t'moncourrier.fr.nf',\n\t'monemail.fr.nf',\n\t'monmail.fr.nf',\n\t'monumentmail.com',\n\t'msa.minsmail.com',\n\t'mt2009.com',\n\t'mt2014.com',\n\t'mx0.wwwnew.eu',\n\t'my10minutemail.com',\n\t'mycard.net.ua',\n\t'mycleaninbox.net',\n\t'myemailboxy.com',\n\t'mymail-in.net',\n\t'mymailoasis.com',\n\t'mynetstore.de',\n\t'mypacks.net',\n\t'mypartyclip.de',\n\t'myphantomemail.com',\n\t'mysamp.de',\n\t'myspaceinc.com',\n\t'myspaceinc.net',\n\t'myspaceinc.org',\n\t'myspacepimpedup.com',\n\t'myspamless.com',\n\t'mytemp.email',\n\t'mytempemail.com',\n\t'mytempmail.com',\n\t'mytrashmail.com',\n\t'nabuma.com',\n\t'neomailbox.com',\n\t'nepwk.com',\n\t'nervmich.net',\n\t'nervtmich.net',\n\t'netmails.com',\n\t'netmails.net',\n\t'netzidiot.de',\n\t'neverbox.com',\n\t'nice-4u.com',\n\t'nincsmail.com',\n\t'nincsmail.hu',\n\t'nnh.com',\n\t'no-spam.ws',\n\t'noblepioneer.com',\n\t'nobulk.com',\n\t'noclickemail.com',\n\t'nogmailspam.info',\n\t'nomail.pw',\n\t'nomail.xl.cx',\n\t'nomail2me.com',\n\t'nomorespamemails.com',\n\t'nonspam.eu',\n\t'nonspammer.de',\n\t'noref.in',\n\t'nospam.ze.tc',\n\t'nospam4.us',\n\t'nospamfor.us',\n\t'nospammail.net',\n\t'nospamthanks.info',\n\t'notmailinator.com',\n\t'notsharingmy.info',\n\t'nowhere.org',\n\t'nowmymail.com',\n\t'nurfuerspam.de',\n\t'nus.edu.sg',\n\t'nwldx.com',\n\t'objectmail.com',\n\t'obobbo.com',\n\t'odaymail.com',\n\t'odnorazovoe.ru',\n\t'one-time.email',\n\t'oneoffemail.com',\n\t'oneoffmail.com',\n\t'one2mail.info',\n\t'onewaymail.com',\n\t'onlatedotcom.info',\n\t'online.ms',\n\t'oopi.org',\n\t'opayq.com',\n\t'ordinaryamerican.net',\n\t'otherinbox.codupmyspace.com',\n\t'otherinbox.com',\n\t'ourklips.com',\n\t'outlawspam.com',\n\t'ovpn.to',\n\t'owlpic.com',\n\t'pancakemail.com',\n\t'paplease.com',\n\t'pcusers.otherinbox.com',\n\t'pepbot.com',\n\t'pfui.ru',\n\t'pimpedupmyspace.com',\n\t'pjjkp.com',\n\t'plexolan.de',\n\t'poczta.onet.pl',\n\t'politikerclub.de',\n\t'pooae.com',\n\t'poofy.org',\n\t'pookmail.com',\n\t'privacy.net',\n\t'privatdemail.net',\n\t'privy-mail.com',\n\t'privymail.de',\n\t'proxymail.eu',\n\t'prtnx.com',\n\t'prtz.eu',\n\t'punkass.com',\n\t'putthisinyourspamdatabase.com',\n\t'pwrby.com',\n\t'quickinbox.com',\n\t'quickmail.nl',\n\t'rcpt.at',\n\t'reallymymail.com',\n\t'realtyalerts.ca',\n\t'recode.me',\n\t'recursor.net',\n\t'recyclemail.dk',\n\t'regbypass.com',\n\t'regbypass.comsafe-mail.net',\n\t'rejectmail.com',\n\t'reliable-mail.com',\n\t'rhyta.com',\n\t'rklips.com',\n\t'rmqkr.net',\n\t'royal.net',\n\t'rppkn.com',\n\t'rtrtr.com',\n\t's0ny.net',\n\t'safe-mail.net',\n\t'safersignup.de',\n\t'safetymail.info',\n\t'safetypost.de',\n\t'sandelf.de',\n\t'saynotospams.com',\n\t'schafmail.de',\n\t'schrott-email.de',\n\t'secretemail.de',\n\t'secure-mail.biz',\n\t'selfdestructingmail.com',\n\t'selfdestructingmail.org',\n\t'sendspamhere.com',\n\t'sendspamhere.com',\n\t'senseless-entertainment.com',\n\t'services391.com',\n\t'sharedmailbox.org',\n\t'sharklasers.com',\n\t'shieldedmail.com',\n\t'shieldemail.com',\n\t'shiftmail.com',\n\t'shitmail.me',\n\t'shitmail.org',\n\t'shitware.nl',\n\t'shmeriously.com',\n\t'shortmail.net',\n\t'shotmail.ru',\n\t'showslow.de',\n\t'sibmail.com',\n\t'sinnlos-mail.de',\n\t'siteposter.net',\n\t'skeefmail.com',\n\t'slapsfromlastnight.com',\n\t'slaskpost.se',\n\t'slipry.net',\n\t'slopsbox.com',\n\t'slushmail.com',\n\t'smashmail.de',\n\t'smellfear.com',\n\t'smellrear.com',\n\t'snakemail.com',\n\t'sneakemail.com',\n\t'sneakmail.de',\n\t'snkmail.com',\n\t'sofimail.com',\n\t'sofort-mail.de',\n\t'softpls.asia',\n\t'sogetthis.com',\n\t'sohu.com',\n\t'solvemail.info',\n\t'soodonims.com',\n\t'spa.com',\n\t'spaereplease.com',\n\t'spam.la',\n\t'spam.su',\n\t'spam4.me',\n\t'spamail.de',\n\t'spamarrest.com',\n\t'spamavert.com',\n\t'spambob.com',\n\t'spambob.net',\n\t'spambob.org',\n\t'spambog.com',\n\t'spambog.de',\n\t'spambog.net',\n\t'spambog.ru',\n\t'spambox.info',\n\t'spambox.irishspringrealty.com',\n\t'spambox.us',\n\t'spamcannon.com',\n\t'spamcannon.net',\n\t'spamcero.com',\n\t'spamcon.org',\n\t'spamcorptastic.com',\n\t'spamcowboy.com',\n\t'spamcowboy.net',\n\t'spamcowboy.org',\n\t'spamday.com',\n\t'spamex.com',\n\t'spamfree.eu',\n\t'spamfree24.com',\n\t'spamfree24.de',\n\t'spamfree24.eu',\n\t'spamfree24.info',\n\t'spamfree24.net',\n\t'spamfree24.org',\n\t'spamgoes.in',\n\t'spamgourmet.com',\n\t'spamgourmet.net',\n\t'spamgourmet.org',\n\t'spamherelots.com',\n\t'spamhereplease.com',\n\t'spamhole.com',\n\t'spamify.com',\n\t'spaminator.de',\n\t'spamkill.info',\n\t'spaml.com',\n\t'spaml.de',\n\t'spammotel.com',\n\t'spamobox.com',\n\t'spamoff.de',\n\t'spamsalad.in',\n\t'spamslicer.com',\n\t'spamspot.com',\n\t'spamstack.net',\n\t'spamthis.co.uk',\n\t'spamthisplease.com',\n\t'spamtrail.com',\n\t'spamtroll.net',\n\t'speed.1s.fr',\n\t'spikio.com',\n\t'spoofmail.de',\n\t'squizzy.de',\n\t'ssoia.com',\n\t'startkeys.com',\n\t'stinkefinger.net',\n\t'stop-my-spam.com',\n\t'stuffmail.de',\n\t'super-auswahl.de',\n\t'supergreatmail.com',\n\t'supermailer.jp',\n\t'superrito.com',\n\t'superstachel.de',\n\t'suremail.info',\n\t'svk.jp',\n\t'sweetxxx.de',\n\t'tagyourself.com',\n\t'talkinator.com',\n\t'tapchicuoihoi.com',\n\t'teewars.org',\n\t'teleosaurs.xyz',\n\t'teleworm.com',\n\t'teleworm.us',\n\t'temp-mail.org',\n\t'temp-mail.ru',\n\t'temp.emeraldwebmail.com',\n\t'temp.headstrong.de',\n\t'tempalias.com',\n\t'tempe-mail.com',\n\t'tempemail.biz',\n\t'tempemail.co.za',\n\t'tempemail.com',\n\t'tempemail.net',\n\t'tempemail.net',\n\t'tempinbox.co.uk',\n\t'tempinbox.com',\n\t'tempmail.eu',\n\t'tempmail.it',\n\t'tempmail2.com',\n\t'tempmaildemo.com',\n\t'tempmailer.com',\n\t'tempmailer.de',\n\t'tempomail.fr',\n\t'temporarily.de',\n\t'temporarioemail.com.br',\n\t'temporaryemail.net',\n\t'temporaryemail.us',\n\t'temporaryforwarding.com',\n\t'temporaryinbox.com',\n\t'temporarymailaddress.com',\n\t'tempsky.com',\n\t'tempthe.net',\n\t'tempymail.com',\n\t'thanksnospam.info',\n\t'thankyou2010.com',\n\t'thc.st',\n\t'thecloudindex.com',\n\t'thelimestones.com',\n\t'thisisnotmyrealemail.com',\n\t'thismail.net',\n\t'thrma.com',\n\t'throwawayemailaddress.com',\n\t'tilien.com',\n\t'tittbit.in',\n\t'tizi.com',\n\t'tmail.ws',\n\t'tmailinator.com',\n\t'toiea.com',\n\t'toomail.biz',\n\t'topranklist.de',\n\t'tradermail.info',\n\t'trash-amil.com',\n\t'trash-mail.at',\n\t'trash-mail.com',\n\t'trash-mail.de',\n\t'trash2009.com',\n\t'trash2010.com',\n\t'trash2011.com',\n\t'trashdevil.com',\n\t'trashdevil.de',\n\t'trashemail.de',\n\t'trashmail.at',\n\t'trashmail.com',\n\t'trashmail.de',\n\t'trashmail.me',\n\t'trashmail.net',\n\t'trashmail.org',\n\t'trashmail.ws',\n\t'trashmailer.com',\n\t'trashymail.com',\n\t'trashymail.net',\n\t'trbvm.com',\n\t'trbvn.com',\n\t'trialmail.de',\n\t'trillianpro.com',\n\t'tryalert.com',\n\t'turual.com',\n\t'twinmail.de',\n\t'twoweirdtricks.com',\n\t'tyldd.com',\n\t'uggsrock.com',\n\t'umail.net',\n\t'upliftnow.com',\n\t'uplipht.com',\n\t'uroid.com',\n\t'us.af',\n\t'username.e4ward.com',\n\t'venompen.com',\n\t'veryrealemail.com',\n\t'vidchart.com',\n\t'viditag.com',\n\t'viewcastmedia.com',\n\t'viewcastmedia.net',\n\t'viewcastmedia.org',\n\t'viewcastmediae',\n\t'viralplays.com',\n\t'vkcode.ru',\n\t'vomoto.com',\n\t'vpn.st',\n\t'vsimcard.com',\n\t'vubby.com',\n\t'walala.org',\n\t'walkmail.net',\n\t'walkmail.ru',\n\t'wasteland.rfc822.org',\n\t'webemail.me',\n\t'webm4il.info',\n\t'webuser.in',\n\t'wee.my',\n\t'weg-werf-email.de',\n\t'wegwerf-email-addressen.de',\n\t'wegwerf-emails.de',\n\t'wegwerfadresse.de',\n\t'wegwerfemail.com',\n\t'wegwerfemail.de',\n\t'wegwerfmail.de',\n\t'wegwerfmail.info',\n\t'wegwerfmail.net',\n\t'wegwerfmail.org',\n\t'wetrainbayarea.com',\n\t'wetrainbayarea.org',\n\t'wh4f.org',\n\t'whatiaas.com',\n\t'whatpaas.com',\n\t'whatsaas.com',\n\t'whopy.com',\n\t'whtjddn.33mail.com',\n\t'whyspam.me',\n\t'wilemail.com',\n\t'willhackforfood.biz',\n\t'willselfdestruct.com',\n\t'winemaven.info',\n\t'wronghead.com',\n\t'wuzup.net',\n\t'wuzupmail.net',\n\t'www.e4ward.com',\n\t'www.gishpuppy.com',\n\t'www.mailinator.com',\n\t'wwwnew.eu',\n\t'x.ip6.li',\n\t'xagloo.com',\n\t'xemaps.com',\n\t'xents.com',\n\t'xmaily.com',\n\t'xoxy.net',\n\t'xyzfree.net',\n\t'yapped.net',\n\t'yeah.net',\n\t'yep.it',\n\t'yogamaven.com',\n\t'yomail.info',\n\t'yopmail.com',\n\t'yopmail.fr',\n\t'yopmail.net',\n\t'yourdomain.com',\n\t'ypmail.webarnak.fr.eu.org',\n\t'yuurok.com',\n\t'z1p.biz',\n\t'za.com',\n\t'zehnminuten.de',\n\t'zehnminutenmail.de',\n\t'zetmail.com',\n\t'zippymail.info',\n\t'zoaxe.com',\n\t'zoemail.com',\n\t'zoemail.net',\n\t'zoemail.org',\n\t'zomg.info',\n\t'zxcv.com',\n\t'zxcvbnm.com',\n\t'zzz.com'\n];\n\n","import IMAP from 'imap';\nimport POP3 from 'poplib';\nimport { simpleParser } from 'mailparser';\n\nexport class IMAPIntercepter {\n\tconstructor() {\n\t\tthis.imap = new IMAP({\n\t\t\tuser: RocketChat.settings.get('Direct_Reply_Username'),\n\t\t\tpassword: RocketChat.settings.get('Direct_Reply_Password'),\n\t\t\thost: RocketChat.settings.get('Direct_Reply_Host'),\n\t\t\tport: RocketChat.settings.get('Direct_Reply_Port'),\n\t\t\tdebug: RocketChat.settings.get('Direct_Reply_Debug') ? console.log : false,\n\t\t\ttls: !RocketChat.settings.get('Direct_Reply_IgnoreTLS'),\n\t\t\tconnTimeout: 30000,\n\t\t\tkeepalive: true\n\t\t});\n\n\t\tthis.delete = RocketChat.settings.get('Direct_Reply_Delete') ? RocketChat.settings.get('Direct_Reply_Delete') : true;\n\n\t\t// On successfully connected.\n\t\tthis.imap.on('ready', Meteor.bindEnvironment(() => {\n\t\t\tif (this.imap.state !== 'disconnected') {\n\t\t\t\tthis.openInbox(Meteor.bindEnvironment((err) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tthrow err;\n\t\t\t\t\t}\n\t\t\t\t\t// fetch new emails & wait [IDLE]\n\t\t\t\t\tthis.getEmails();\n\n\t\t\t\t\t// If new message arrived, fetch them\n\t\t\t\t\tthis.imap.on('mail', Meteor.bindEnvironment(() => {\n\t\t\t\t\t\tthis.getEmails();\n\t\t\t\t\t}));\n\t\t\t\t}));\n\t\t\t} else {\n\t\t\t\tconsole.log('IMAP didnot connected.');\n\t\t\t\tthis.imap.end();\n\t\t\t}\n\t\t}));\n\n\t\tthis.imap.on('error', (err) => {\n\t\t\tconsole.log('Error occurred ...');\n\t\t\tthrow err;\n\t\t});\n\t}\n\n\topenInbox(cb) {\n\t\tthis.imap.openBox('INBOX', false, cb);\n\t}\n\n\tstart() {\n\t\tthis.imap.connect();\n\t}\n\n\tisActive() {\n\t\tif (this.imap && this.imap.state && this.imap.state === 'disconnected') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tstop(callback = new Function) {\n\t\tthis.imap.end();\n\t\tthis.imap.once('end', callback);\n\t}\n\n\trestart() {\n\t\tthis.stop(() => {\n\t\t\tconsole.log('Restarting IMAP ....');\n\t\t\tthis.start();\n\t\t});\n\t}\n\n\t// Fetch all UNSEEN messages and pass them for further processing\n\tgetEmails() {\n\t\tthis.imap.search(['UNSEEN'], Meteor.bindEnvironment((err, newEmails) => {\n\t\t\tif (err) {\n\t\t\t\tconsole.log(err);\n\t\t\t\tthrow err;\n\t\t\t}\n\n\t\t\t// newEmails => array containing serials of unseen messages\n\t\t\tif (newEmails.length > 0) {\n\t\t\t\tconst f = this.imap.fetch(newEmails, {\n\t\t\t\t\t// fetch headers & first body part.\n\t\t\t\t\tbodies: ['HEADER.FIELDS (FROM TO DATE MESSAGE-ID)', '1'],\n\t\t\t\t\tstruct: true,\n\t\t\t\t\tmarkSeen: true\n\t\t\t\t});\n\n\t\t\t\tf.on('message', Meteor.bindEnvironment((msg, seqno) => {\n\t\t\t\t\tconst email = {};\n\n\t\t\t\t\tmsg.on('body', (stream, info) => {\n\t\t\t\t\t\tlet headerBuffer = '';\n\t\t\t\t\t\tlet bodyBuffer = '';\n\n\t\t\t\t\t\tstream.on('data', (chunk) => {\n\t\t\t\t\t\t\tif (info.which === '1') {\n\t\t\t\t\t\t\t\tbodyBuffer += chunk.toString('utf8');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\theaderBuffer += chunk.toString('utf8');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tstream.once('end', () => {\n\t\t\t\t\t\t\tif (info.which === '1') {\n\t\t\t\t\t\t\t\temail.body = bodyBuffer;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// parse headers\n\t\t\t\t\t\t\t\temail.headers = IMAP.parseHeader(headerBuffer);\n\n\t\t\t\t\t\t\t\temail.headers.to = email.headers.to[0];\n\t\t\t\t\t\t\t\temail.headers.date = email.headers.date[0];\n\t\t\t\t\t\t\t\temail.headers.from = email.headers.from[0];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\t// On fetched each message, pass it further\n\t\t\t\t\tmsg.once('end', Meteor.bindEnvironment(() => {\n\t\t\t\t\t\t// delete message from inbox\n\t\t\t\t\t\tif (this.delete) {\n\t\t\t\t\t\t\tthis.imap.seq.addFlags(seqno, 'Deleted', (err) => {\n\t\t\t\t\t\t\t\tif (err) { console.log(`Mark deleted error: ${ err }`); }\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tRocketChat.processDirectEmail(email);\n\t\t\t\t\t}));\n\t\t\t\t}));\n\t\t\t\tf.once('error', (err) => {\n\t\t\t\t\tconsole.log(`Fetch error: ${ err }`);\n\t\t\t\t});\n\t\t\t}\n\t\t}));\n\t}\n}\n\nexport class POP3Intercepter {\n\tconstructor() {\n\t\tthis.pop3 = new POP3(RocketChat.settings.get('Direct_Reply_Port'), RocketChat.settings.get('Direct_Reply_Host'), {\n\t\t\tenabletls: !RocketChat.settings.get('Direct_Reply_IgnoreTLS'),\n\t\t\tdebug: RocketChat.settings.get('Direct_Reply_Debug') ? console.log : false\n\t\t});\n\n\t\tthis.totalMsgCount = 0;\n\t\tthis.currentMsgCount = 0;\n\n\t\tthis.pop3.on('connect', Meteor.bindEnvironment(() => {\n\t\t\tthis.pop3.login(RocketChat.settings.get('Direct_Reply_Username'), RocketChat.settings.get('Direct_Reply_Password'));\n\t\t}));\n\n\t\tthis.pop3.on('login', Meteor.bindEnvironment((status) => {\n\t\t\tif (status) {\n\t\t\t\t// run on start\n\t\t\t\tthis.pop3.list();\n\t\t\t} else {\n\t\t\t\tconsole.log('Unable to Log-in ....');\n\t\t\t}\n\t\t}));\n\n\t\t// on getting list of all emails\n\t\tthis.pop3.on('list', Meteor.bindEnvironment((status, msgcount) => {\n\t\t\tif (status) {\n\t\t\t\tif (msgcount > 0) {\n\t\t\t\t\tthis.totalMsgCount = msgcount;\n\t\t\t\t\tthis.currentMsgCount = 1;\n\t\t\t\t\t// Retrieve email\n\t\t\t\t\tthis.pop3.retr(this.currentMsgCount);\n\t\t\t\t} else {\n\t\t\t\t\tthis.pop3.quit();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconsole.log('Cannot Get Emails ....');\n\t\t\t}\n\t\t}));\n\n\t\t// on retrieved email\n\t\tthis.pop3.on('retr', Meteor.bindEnvironment((status, msgnumber, data) => {\n\t\t\tif (status) {\n\t\t\t\t// parse raw email data to  JSON object\n\t\t\t\tsimpleParser(data, Meteor.bindEnvironment((err, mail) => {\n\t\t\t\t\tthis.initialProcess(mail);\n\t\t\t\t}));\n\n\t\t\t\tthis.currentMsgCount += 1;\n\n\t\t\t\t// delete email\n\t\t\t\tthis.pop3.dele(msgnumber);\n\t\t\t} else {\n\t\t\t\tconsole.log('Cannot Retrieve Message ....');\n\t\t\t}\n\t\t}));\n\n\t\t// on email deleted\n\t\tthis.pop3.on('dele', Meteor.bindEnvironment((status) => {\n\t\t\tif (status) {\n\t\t\t\t// get next email\n\t\t\t\tif (this.currentMsgCount <= this.totalMsgCount) {\n\t\t\t\t\tthis.pop3.retr(this.currentMsgCount);\n\t\t\t\t} else {\n\t\t\t\t\t// parsed all messages.. so quitting\n\t\t\t\t\tthis.pop3.quit();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconsole.log('Cannot Delete Message....');\n\t\t\t}\n\t\t}));\n\n\t\t// invalid server state\n\t\tthis.pop3.on('invalid-state', function(cmd) {\n\t\t\tconsole.log(`Invalid state. You tried calling ${ cmd }`);\n\t\t});\n\n\t\t// locked => command already running, not finished yet\n\t\tthis.pop3.on('locked', function(cmd) {\n\t\t\tconsole.log(`Current command has not finished yet. You tried calling ${ cmd }`);\n\t\t});\n\t}\n\n\tinitialProcess(mail) {\n\t\tconst email = {\n\t\t\theaders: {\n\t\t\t\tfrom: mail.from.text,\n\t\t\t\tto: mail.to.text,\n\t\t\t\tdate: mail.date,\n\t\t\t\t'message-id': mail.messageId\n\t\t\t},\n\t\t\tbody: mail.text\n\t\t};\n\n\t\tRocketChat.processDirectEmail(email);\n\t}\n}\n\nexport class POP3Helper {\n\tconstructor() {\n\t\tthis.running = false;\n\t}\n\n\tstart() {\n\t\t// run every x-minutes\n\t\tif (RocketChat.settings.get('Direct_Reply_Frequency')) {\n\t\t\tRocketChat.POP3 = new POP3Intercepter();\n\n\t\t\tthis.running = Meteor.setInterval(() => {\n\t\t\t\t// get new emails and process\n\t\t\t\tRocketChat.POP3 = new POP3Intercepter();\n\t\t\t}, Math.max(RocketChat.settings.get('Direct_Reply_Frequency')*60*1000, 2*60*1000));\n\t\t}\n\t}\n\n\tisActive() {\n\t\treturn this.running;\n\t}\n\n\tstop(callback = new Function) {\n\t\tif (this.isActive()) {\n\t\t\tMeteor.clearInterval(this.running);\n\t\t}\n\t\tcallback();\n\t}\n}\n","// Do not disclose if user exists when password is invalid\nconst _runLoginHandlers = Accounts._runLoginHandlers;\nAccounts._runLoginHandlers = function(methodInvocation, options) {\n\tconst result = _runLoginHandlers.call(Accounts, methodInvocation, options);\n\n\tif (result.error && result.error.reason === 'Incorrect password') {\n\t\tresult.error = new Meteor.Error(403, 'User not found');\n\t}\n\n\treturn result;\n};\n","import _ from 'underscore';\nimport s from 'underscore.string';\nimport moment from 'moment';\n\n/**\n * Chechs if a messages contains a user highlight\n *\n * @param {string} message\n * @param {array|undefined} highlights\n *\n * @returns {boolean}\n */\n\nexport function messageContainsHighlight(message, highlights) {\n\tif (! highlights || highlights.length === 0) { return false; }\n\n\treturn highlights.some(function(highlight) {\n\t\tconst regexp = new RegExp(s.escapeRegExp(highlight), 'i');\n\t\treturn regexp.test(message.msg);\n\t});\n}\n\nfunction notifyUsersOnMessage(message, room) {\n\t// skips this callback if the message was edited and increments it if the edit was way in the past (aka imported)\n\tif (message.editedAt && Math.abs(moment(message.editedAt).diff()) > 60000) {\n\t\t//TODO: Review as I am not sure how else to get around this as the incrementing of the msgs count shouldn't be in this callback\n\t\tRocketChat.models.Rooms.incMsgCountById(message.rid, 1);\n\t\treturn message;\n\t} else if (message.editedAt) {\n\n\t\t// only updates last message if it was edited (skip rest of callback)\n\t\tif (RocketChat.settings.get('Store_Last_Message') && (!room.lastMessage || room.lastMessage._id === message._id)) {\n\t\t\tRocketChat.models.Rooms.setLastMessageById(message.rid, message);\n\t\t}\n\t\treturn message;\n\t}\n\n\tif (message.ts && Math.abs(moment(message.ts).diff()) > 60000) {\n\t\tRocketChat.models.Rooms.incMsgCountById(message.rid, 1);\n\t\treturn message;\n\t}\n\n\tif (room != null) {\n\t\tlet toAll = false;\n\t\tlet toHere = false;\n\t\tconst mentionIds = [];\n\t\tconst highlightsIds = [];\n\t\tconst highlights = RocketChat.models.Subscriptions.findByRoomWithUserHighlights(room._id, { fields: {'userHighlights': 1, 'u._id': 1 }}).fetch();\n\t\tif (message.mentions != null) {\n\t\t\tmessage.mentions.forEach(function(mention) {\n\t\t\t\tif (!toAll && mention._id === 'all') {\n\t\t\t\t\ttoAll = true;\n\t\t\t\t}\n\t\t\t\tif (!toHere && mention._id === 'here') {\n\t\t\t\t\ttoHere = true;\n\t\t\t\t}\n\t\t\t\tif (mention._id !== message.u._id) {\n\t\t\t\t\tmentionIds.push(mention._id);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\thighlights.forEach(function(subscription) {\n\t\t\tif (subscription.userHighlights && messageContainsHighlight(message, subscription.userHighlights)) {\n\t\t\t\tif (subscription.u._id !== message.u._id) {\n\t\t\t\t\thighlightsIds.push(subscription.u._id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (room.t === 'd') {\n\t\t\tconst unreadCountDM = RocketChat.settings.get('Unread_Count_DM');\n\n\t\t\tif (unreadCountDM === 'all_messages') {\n\t\t\t\tRocketChat.models.Subscriptions.incUnreadForRoomIdExcludingUserId(room._id, message.u._id);\n\t\t\t} else if (toAll || toHere) {\n\t\t\t\tRocketChat.models.Subscriptions.incGroupMentionsAndUnreadForRoomIdExcludingUserId(room._id, message.u._id, 1, 1);\n\t\t\t} else if ((mentionIds && mentionIds.length > 0) || (highlightsIds && highlightsIds.length > 0)) {\n\t\t\t\tRocketChat.models.Subscriptions.incUserMentionsAndUnreadForRoomIdAndUserIds(room._id, _.compact(_.unique(mentionIds.concat(highlightsIds))), 1, 1);\n\t\t\t}\n\t\t} else {\n\t\t\tconst unreadCount = RocketChat.settings.get('Unread_Count');\n\n\t\t\tif (toAll || toHere) {\n\t\t\t\tlet incUnread = 0;\n\t\t\t\tif (['all_messages', 'group_mentions_only', 'user_and_group_mentions_only'].includes(unreadCount)) {\n\t\t\t\t\tincUnread = 1;\n\t\t\t\t}\n\t\t\t\tRocketChat.models.Subscriptions.incGroupMentionsAndUnreadForRoomIdExcludingUserId(room._id, message.u._id, 1, incUnread);\n\n\t\t\t} else if ((mentionIds && mentionIds.length > 0) || (highlightsIds && highlightsIds.length > 0)) {\n\t\t\t\tlet incUnread = 0;\n\t\t\t\tif (['all_messages', 'user_mentions_only', 'user_and_group_mentions_only'].includes(unreadCount)) {\n\t\t\t\t\tincUnread = 1;\n\t\t\t\t}\n\t\t\t\tRocketChat.models.Subscriptions.incUserMentionsAndUnreadForRoomIdAndUserIds(room._id, _.compact(_.unique(mentionIds.concat(highlightsIds))), 1, incUnread);\n\t\t\t} else if (unreadCount === 'all_messages') {\n\t\t\t\tRocketChat.models.Subscriptions.incUnreadForRoomIdExcludingUserId(room._id, message.u._id);\n\t\t\t}\n\t\t}\n\t}\n\n\t// Update all the room activity tracker fields\n\t// This method take so long to execute on gient rooms cuz it will trugger the cache rebuild for the releations of that room\n\tRocketChat.models.Rooms.incMsgCountAndSetLastMessageById(message.rid, 1, message.ts, RocketChat.settings.get('Store_Last_Message') && message);\n\t// Update all other subscriptions to alert their owners but witout incrementing\n\t// the unread counter, as it is only for mentions and direct messages\n\t// We now set alert and open properties in two separate update commands. This proved to be more efficient on MongoDB - because it uses a more efficient index.\n\tRocketChat.models.Subscriptions.setAlertForRoomIdExcludingUserId(message.rid, message.u._id);\n\tRocketChat.models.Subscriptions.setOpenForRoomIdExcludingUserId(message.rid, message.u._id);\n\n\treturn message;\n}\n\nRocketChat.callbacks.add('afterSaveMessage', notifyUsersOnMessage, RocketChat.callbacks.priority.LOW, 'notifyUsersOnMessage');\n","import {EmailReplyParser as reply} from 'emailreplyparser';\nimport moment from 'moment';\n\nRocketChat.processDirectEmail = function(email) {\n\tfunction sendMessage(email) {\n\t\tconst message = {\n\t\t\tts: new Date(email.headers.date),\n\t\t\tmsg: email.body,\n\t\t\tsentByEmail: true,\n\t\t\tgroupable: false\n\t\t};\n\n\t\tif (message.ts) {\n\t\t\tconst tsDiff = Math.abs(moment(message.ts).diff());\n\t\t\tif (tsDiff > 10000) {\n\t\t\t\tmessage.ts = new Date();\n\t\t\t}\n\t\t} else {\n\t\t\tmessage.ts = new Date();\n\t\t}\n\n\t\tif (message.msg && message.msg.length > RocketChat.settings.get('Message_MaxAllowedSize')) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// reduce new lines in multiline message\n\t\tmessage.msg = message.msg.split('\\n\\n').join('\\n');\n\n\t\tconst user = RocketChat.models.Users.findOneByEmailAddress(email.headers.from, {\n\t\t\tfields: {\n\t\t\t\tusername: 1,\n\t\t\t\tname: 1\n\t\t\t}\n\t\t});\n\t\tif (!user) {\n\t\t\t// user not found\n\t\t\treturn false;\n\t\t}\n\n\t\tconst prevMessage = RocketChat.models.Messages.findOneById(email.headers.mid, {\n\t\t\trid: 1,\n\t\t\tu: 1\n\t\t});\n\t\tif (!prevMessage) {\n\t\t\t// message doesn't exist anymore\n\t\t\treturn false;\n\t\t}\n\t\tmessage.rid = prevMessage.rid;\n\n\t\tconst room = Meteor.call('canAccessRoom', message.rid, user._id);\n\t\tif (!room) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst roomInfo = RocketChat.models.Rooms.findOneById(message.rid, {\n\t\t\tt: 1,\n\t\t\tname: 1\n\t\t});\n\n\t\t// check mention\n\t\tif (message.msg.indexOf(`@${ prevMessage.u.username }`) === -1 && roomInfo.t !== 'd') {\n\t\t\tmessage.msg = `@${ prevMessage.u.username } ${ message.msg }`;\n\t\t}\n\n\t\t// reply message link\n\t\tlet prevMessageLink = `[ ](${ Meteor.absoluteUrl().replace(/\\/$/, '') }`;\n\t\tif (roomInfo.t === 'c') {\n\t\t\tprevMessageLink += `/channel/${ roomInfo.name }?msg=${ email.headers.mid }) `;\n\t\t} else if (roomInfo.t === 'd') {\n\t\t\tprevMessageLink += `/direct/${ prevMessage.u.username }?msg=${ email.headers.mid }) `;\n\t\t} else if (roomInfo.t === 'p') {\n\t\t\tprevMessageLink += `/group/${ roomInfo.name }?msg=${ email.headers.mid }) `;\n\t\t}\n\t\t// add reply message link\n\t\tmessage.msg = prevMessageLink + message.msg;\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(message.rid, user._id);\n\t\tif (subscription && subscription.blocked || subscription.blocker) {\n\t\t\t// room is blocked\n\t\t\treturn false;\n\t\t}\n\n\t\tif ((room.muted || []).includes(user.username)) {\n\t\t\t// room is muted\n\t\t\treturn false;\n\t\t}\n\n\t\tif (message.alias == null && RocketChat.settings.get('Message_SetNameToAliasEnabled')) {\n\t\t\tmessage.alias = user.name;\n\t\t}\n\n\t\tRocketChat.metrics.messagesSent.inc(); // TODO This line needs to be moved to it's proper place. See the comments on: https://github.com/RocketChat/Rocket.Chat/pull/5736\n\n\t\treturn RocketChat.sendMessage(user, message, room);\n\t}\n\n\t// Extract/parse reply from email body\n\temail.body = reply.parse_reply(email.body);\n\n\t// if 'To' email format is \"Name <username@domain>\"\n\tif (email.headers.to.indexOf('<') >= 0 && email.headers.to.indexOf('>') >= 0) {\n\t\temail.headers.to = email.headers.to.split('<')[1].split('>')[0];\n\t}\n\n\t// if 'From' email format is \"Name <username@domain>\"\n\tif (email.headers.from.indexOf('<') >= 0 && email.headers.from.indexOf('>') >= 0) {\n\t\temail.headers.from = email.headers.from.split('<')[1].split('>')[0];\n\t}\n\n\t// 'To' email format \"username+messageId@domain\"\n\tif (email.headers.to.indexOf('+') >= 0) {\n\t\t// Valid 'To' format\n\t\temail.headers.mid = email.headers.to.split('@')[0].split('+')[1];\n\t\tsendMessage(email);\n\t} else {\n\t\tconsole.log('Invalid Email....If not. Please report it.');\n\t}\n};\n","import { RoomTypesCommon } from '../../lib/RoomTypesCommon';\n\nRocketChat.roomTypes = new class roomTypesServer extends RoomTypesCommon {\n\t/**\n\t * Add a publish for a room type\n\t *\n\t * @param {string} roomType room type (e.g.: c (for channels), d (for direct channels))\n\t * @param {function} callback function that will return the publish's data\n\t*/\n\tsetPublish(roomType, callback) {\n\t\tif (this.roomTypes[roomType] && this.roomTypes[roomType].publish != null) {\n\t\t\tthrow new Meteor.Error('route-publish-exists', 'Publish for the given type already exists');\n\t\t}\n\t\tif (this.roomTypes[roomType] == null) {\n\t\t\tthis.roomTypes[roomType] = {};\n\t\t}\n\t\treturn this.roomTypes[roomType].publish = callback;\n\t}\n\n\tsetRoomFind(roomType, callback) {\n\t\tif (this.roomTypes[roomType] && this.roomTypes[roomType].roomFind != null) {\n\t\t\tthrow new Meteor.Error('room-find-exists', 'Room find for the given type already exists');\n\t\t}\n\t\tif (this.roomTypes[roomType] == null) {\n\t\t\tthis.roomTypes[roomType] = {};\n\t\t}\n\t\treturn this.roomTypes[roomType].roomFind = callback;\n\t}\n\n\tgetRoomFind(roomType) {\n\t\treturn this.roomTypes[roomType] && this.roomTypes[roomType].roomFind;\n\t}\n\n\tgetRoomName(roomType, roomData) {\n\t\treturn this.roomTypes[roomType] && this.roomTypes[roomType].roomName && this.roomTypes[roomType].roomName(roomData);\n\t}\n\n\t/**\n\t * Run the publish for a room type\n\t *\n\t * @param scope Meteor publish scope\n\t * @param {string} roomType room type (e.g.: c (for channels), d (for direct channels))\n\t * @param identifier identifier of the room\n\t*/\n\trunPublish(scope, roomType, identifier) {\n\t\treturn this.roomTypes[roomType] && this.roomTypes[roomType].publish && this.roomTypes[roomType].publish.call(scope, identifier);\n\t}\n\n};\n","import moment from 'moment';\n\nimport { callJoinRoom, messageContainsHighlight, parseMessageTextPerUser, replaceMentionedUsernamesWithFullNames } from '../functions/notifications/';\nimport { sendEmail, shouldNotifyEmail } from '../functions/notifications/email';\nimport { sendSinglePush, shouldNotifyMobile } from '../functions/notifications/mobile';\nimport { notifyDesktopUser, shouldNotifyDesktop } from '../functions/notifications/desktop';\nimport { notifyAudioUser, shouldNotifyAudio } from '../functions/notifications/audio';\n\nconst sendNotification = ({\n\tsubscription,\n\tsender,\n\thasMentionToAll,\n\thasMentionToHere,\n\tmessage,\n\tnotificationMessage,\n\troom,\n\tmentionIds,\n\tdisableAllMessageNotifications\n}) => {\n\n\t// don't notify the sender\n\tif (subscription.u._id === sender._id) {\n\t\treturn;\n\t}\n\n\t// notifications disabled\n\tif (subscription.disableNotifications) {\n\t\treturn;\n\t}\n\n\t// dont send notification to users who ignored the sender\n\tif (Array.isArray(subscription.ignored) && subscription.ignored.includes(sender._id)) {\n\t\treturn;\n\t}\n\n\tconst hasMentionToUser = mentionIds.includes(subscription.u._id);\n\n\t// mute group notifications (@here and @all) if not directly mentioned as well\n\tif (!hasMentionToUser && subscription.muteGroupMentions && (hasMentionToAll || hasMentionToHere)) {\n\t\treturn;\n\t}\n\n\tconst receiver = RocketChat.models.Users.findOneById(subscription.u._id);\n\n\tif (!receiver || !receiver.active) {\n\t\treturn;\n\t}\n\n\tnotificationMessage = parseMessageTextPerUser(notificationMessage, message, receiver);\n\n\tconst isHighlighted = messageContainsHighlight(message, subscription.userHighlights);\n\n\tconst roomType = room.t;\n\n\tconst {\n\t\taudioNotifications,\n\t\tdesktopNotifications,\n\t\tmobilePushNotifications,\n\t\temailNotifications\n\t} = subscription;\n\n\tlet notificationSent = false;\n\n\t// busy users don't receive audio notification\n\tif (shouldNotifyAudio({\n\t\tdisableAllMessageNotifications,\n\t\tstatus: receiver.status,\n\t\taudioNotifications,\n\t\thasMentionToAll,\n\t\thasMentionToHere,\n\t\tisHighlighted,\n\t\thasMentionToUser,\n\t\troomType\n\t})) {\n\t\tnotifyAudioUser(subscription.u._id, message, room);\n\t}\n\n\t// busy users don't receive desktop notification\n\tif (shouldNotifyDesktop({\n\t\tdisableAllMessageNotifications,\n\t\tstatus: receiver.status,\n\t\tdesktopNotifications,\n\t\thasMentionToAll,\n\t\thasMentionToHere,\n\t\tisHighlighted,\n\t\thasMentionToUser,\n\t\troomType\n\t})) {\n\t\tnotificationSent = true;\n\t\tnotifyDesktopUser({\n\t\t\tnotificationMessage,\n\t\t\tuserId: subscription.u._id,\n\t\t\tuser: sender,\n\t\t\tmessage,\n\t\t\troom,\n\t\t\tduration: subscription.desktopNotificationDuration\n\t\t});\n\t}\n\n\tif (shouldNotifyMobile({\n\t\tdisableAllMessageNotifications,\n\t\tmobilePushNotifications,\n\t\thasMentionToAll,\n\t\tisHighlighted,\n\t\thasMentionToUser,\n\t\tstatusConnection: receiver.statusConnection,\n\t\troomType\n\t})) {\n\t\tnotificationSent = true;\n\n\t\tsendSinglePush({\n\t\t\tnotificationMessage,\n\t\t\troom,\n\t\t\tmessage,\n\t\t\tuserId: subscription.u._id,\n\t\t\tsenderUsername: sender.username,\n\t\t\tsenderName: sender.name,\n\t\t\treceiverUsername: receiver.username\n\t\t});\n\t}\n\n\tif (receiver.emails && shouldNotifyEmail({\n\t\tdisableAllMessageNotifications,\n\t\tstatusConnection: receiver.statusConnection,\n\t\temailNotifications,\n\t\tisHighlighted,\n\t\thasMentionToUser,\n\t\thasMentionToAll,\n\t\troomType\n\t})) {\n\t\treceiver.emails.some((email) => {\n\t\t\tif (email.verified) {\n\t\t\t\tsendEmail({ message, receiver, subscription, room, emailAddress: email.address });\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\t}\n\n\tif (notificationSent) {\n\t\tRocketChat.Sandstorm.notify(message, [subscription.u._id], `@${ sender.username }: ${ message.msg }`, room.t === 'p' ? 'privateMessage' : 'message');\n\t}\n};\n\nfunction sendAllNotifications(message, room) {\n\n\t// skips this callback if the message was edited\n\tif (message.editedAt) {\n\t\treturn message;\n\t}\n\n\tif (message.ts && Math.abs(moment(message.ts).diff()) > 60000) {\n\t\treturn message;\n\t}\n\n\tif (!room || room.t == null) {\n\t\treturn message;\n\t}\n\n\tconst sender = (room.t !== 'l') ? RocketChat.models.Users.findOneById(message.u._id) : room.v;\n\tif (!sender) {\n\t\treturn message;\n\t}\n\n\tconst mentionIds = (message.mentions || []).map(({_id}) => _id);\n\tconst mentionIdsWithoutGroups = mentionIds.filter((_id) => _id !== 'all' && _id !== 'here');\n\tconst hasMentionToAll = mentionIds.includes('all');\n\tconst hasMentionToHere = mentionIds.includes('here');\n\n\tlet notificationMessage = RocketChat.callbacks.run('beforeSendMessageNotifications', message.msg);\n\tif (mentionIds.length > 0 && RocketChat.settings.get('UI_Use_Real_Name')) {\n\t\tnotificationMessage = replaceMentionedUsernamesWithFullNames(message.msg, message.mentions);\n\t}\n\n\t// Don't fetch all users if room exceeds max members\n\tconst maxMembersForNotification = RocketChat.settings.get('Notifications_Max_Room_Members');\n\tconst disableAllMessageNotifications = room.usernames && room.usernames.length > maxMembersForNotification && maxMembersForNotification !== 0;\n\n\tconst query = {\n\t\trid: room._id,\n\t\t$or: [{\n\t\t\t'userHighlights.0': { $exists: 1 }\n\t\t}]\n\t};\n\n\t['audio', 'desktop', 'mobile', 'email'].map((kind) => {\n\t\tconst notificationField = `${ kind === 'mobile' ? 'mobilePush' : kind }Notifications`;\n\n\t\tconst filter = { [notificationField]: 'all' };\n\n\t\tif (disableAllMessageNotifications) {\n\t\t\tfilter[`${ kind }PrefOrigin`] = { $ne: 'user' };\n\t\t}\n\n\t\tquery.$or.push(filter);\n\n\t\tif (mentionIdsWithoutGroups.length > 0) {\n\t\t\tquery.$or.push({\n\t\t\t\t[notificationField]: 'mentions',\n\t\t\t\t'u._id': { $in: mentionIdsWithoutGroups }\n\t\t\t});\n\t\t} else if (!disableAllMessageNotifications && (hasMentionToAll || hasMentionToHere)) {\n\t\t\tquery.$or.push({\n\t\t\t\t[notificationField]: 'mentions'\n\t\t\t});\n\t\t}\n\n\t\tconst serverField = kind === 'email' ? 'emailNotificationMode' : `${ kind }Notifications`;\n\t\tconst serverPreference = RocketChat.settings.get(`Accounts_Default_User_Preferences_${ serverField }`);\n\t\tif ((room.t === 'd' && serverPreference !== 'nothing') || (!disableAllMessageNotifications && (serverPreference === 'all' || hasMentionToAll || hasMentionToHere))) {\n\t\t\tquery.$or.push({\n\t\t\t\t[notificationField]: { $exists: false }\n\t\t\t});\n\t\t} else if (serverPreference === 'mentions' && mentionIdsWithoutGroups.length) {\n\t\t\tquery.$or.push({\n\t\t\t\t[notificationField]: { $exists: false },\n\t\t\t\t'u._id': { $in: mentionIdsWithoutGroups }\n\t\t\t});\n\t\t}\n\t});\n\n\t// the find bellow is crucial. all subscription records returned will receive at least one kind of notification.\n\t// the query is defined by the server's default values and Notifications_Max_Room_Members setting.\n\tconst subscriptions = RocketChat.models.Subscriptions.findNotificationPreferencesByRoom(query);\n\tsubscriptions.forEach((subscription) => sendNotification({\n\t\tsubscription,\n\t\tsender,\n\t\thasMentionToAll,\n\t\thasMentionToHere,\n\t\tmessage,\n\t\tnotificationMessage,\n\t\troom,\n\t\tmentionIds,\n\t\tdisableAllMessageNotifications\n\t}));\n\n\t// on public channels, if a mentioned user is not member of the channel yet, he will first join the channel and then be notified based on his preferences.\n\tif (room.t === 'c') {\n\t\tPromise.all(message.mentions\n\t\t\t.filter(({ _id, username }) => _id !== 'here' && _id !== 'all' && !room.usernames.includes(username))\n\t\t\t.map(async(user) => {\n\t\t\t\tawait callJoinRoom(user, room._id);\n\n\t\t\t\treturn user._id;\n\t\t\t})\n\t\t).then((users) => {\n\t\t\tusers.forEach((userId) => {\n\t\t\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(room._id, userId);\n\n\t\t\t\tsendNotification({\n\t\t\t\t\tsubscription,\n\t\t\t\t\tsender,\n\t\t\t\t\thasMentionToAll,\n\t\t\t\t\thasMentionToHere,\n\t\t\t\t\tmessage,\n\t\t\t\t\tnotificationMessage,\n\t\t\t\t\troom,\n\t\t\t\t\tmentionIds\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\treturn message;\n}\n\nRocketChat.callbacks.add('afterSaveMessage', sendAllNotifications, RocketChat.callbacks.priority.LOW, 'sendNotificationsOnMessage');\n","import _ from 'underscore';\nimport dns from 'dns';\n\nlet emailDomainBlackList = [];\nlet emailDomainWhiteList = [];\nlet useDefaultBlackList = false;\nlet useDNSDomainCheck = false;\n\nRocketChat.settings.get('Accounts_BlockedDomainsList', function(key, value) {\n\temailDomainBlackList = _.map(value.split(','), (domain) => domain.trim());\n});\nRocketChat.settings.get('Accounts_AllowedDomainsList', function(key, value) {\n\temailDomainWhiteList = _.map(value.split(','), (domain) => domain.trim());\n});\nRocketChat.settings.get('Accounts_UseDefaultBlockedDomainsList', function(key, value) {\n\tuseDefaultBlackList = value;\n});\nRocketChat.settings.get('Accounts_UseDNSDomainCheck', function(key, value) {\n\tuseDNSDomainCheck = value;\n});\n\nRocketChat.validateEmailDomain = function(email) {\n\tconst emailValidation = /^[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n\tif (!emailValidation.test(email)) {\n\t\tthrow new Meteor.Error('error-invalid-email', `Invalid email ${ email }`, { function: 'RocketChat.validateEmailDomain', email });\n\t}\n\n\tconst emailDomain = email.substr(email.lastIndexOf('@') + 1);\n\n\t// if not in whitelist\n\tif (emailDomainWhiteList.indexOf(emailDomain) === -1) {\n\t\tif (emailDomainBlackList.indexOf(emailDomain) !== -1 || (useDefaultBlackList && RocketChat.emailDomainDefaultBlackList.indexOf(emailDomain) !== -1)) {\n\t\t\tthrow new Meteor.Error('error-email-domain-blacklisted', 'The email domain is blacklisted', { function: 'RocketChat.validateEmailDomain' });\n\t\t}\n\t}\n\n\tif (useDNSDomainCheck) {\n\t\ttry {\n\t\t\tMeteor.wrapAsync(dns.resolveMx)(emailDomain);\n\t\t} catch (e) {\n\t\t\tthrow new Meteor.Error('error-invalid-domain', 'Invalid domain', { function: 'RocketChat.validateEmailDomain' });\n\t\t}\n\t}\n};\n","import PasswordPolicy from './PasswordPolicyClass';\n\nRocketChat.passwordPolicy = new PasswordPolicy();\n\nRocketChat.settings.get('Accounts_Password_Policy_Enabled', (key, value) => RocketChat.passwordPolicy.enabled = value);\nRocketChat.settings.get('Accounts_Password_Policy_MinLength', (key, value) => RocketChat.passwordPolicy.minLength = value);\nRocketChat.settings.get('Accounts_Password_Policy_MaxLength', (key, value) => RocketChat.passwordPolicy.maxLength = value);\nRocketChat.settings.get('Accounts_Password_Policy_ForbidRepeatingCharacters', (key, value) => RocketChat.passwordPolicy.forbidRepeatingCharacters = value);\nRocketChat.settings.get('Accounts_Password_Policy_ForbidRepeatingCharactersCount', (key, value) => RocketChat.passwordPolicy.forbidRepeatingCharactersCount = value);\nRocketChat.settings.get('Accounts_Password_Policy_AtLeastOneLowercase', (key, value) => RocketChat.passwordPolicy.mustContainAtLeastOneLowercase = value);\nRocketChat.settings.get('Accounts_Password_Policy_AtLeastOneUppercase', (key, value) => RocketChat.passwordPolicy.mustContainAtLeastOneUppercase = value);\nRocketChat.settings.get('Accounts_Password_Policy_AtLeastOneNumber', (key, value) => RocketChat.passwordPolicy.mustContainAtLeastOneNumber = value);\nRocketChat.settings.get('Accounts_Password_Policy_AtLeastOneSpecialCharacter', (key, value) => RocketChat.passwordPolicy.mustContainAtLeastOneSpecialCharacter = value);\n","/*\n\tWhat is this file? Great question! To make Rocket.Chat more \"modular\"\n\tand to make the \"rocketchat:lib\" package more of a core package\n\twith the libraries, this index file contains the exported members\n\tfor the *server* pieces of code which does include the shared\n\tlibrary files.\n*/\n\nimport { RoomSettingsEnum, RoomTypeConfig, RoomTypeRouteConfig } from '../../lib/RoomTypeConfig';\n\nexport {\n\tRoomSettingsEnum,\n\tRoomTypeConfig,\n\tRoomTypeRouteConfig\n};\n","class PasswordPolicy {\n\tconstructor({\n\t\tenabled = false,\n\t\tminLength = -1,\n\t\tmaxLength = -1,\n\t\tforbidRepeatingCharacters = false,\n\t\tforbidRepeatingCharactersCount = 3, //the regex is this number minus one\n\t\tmustContainAtLeastOneLowercase = false, // /[A-Z]{3,}/ could do this instead of at least one\n\t\tmustContainAtLeastOneUppercase = false,\n\t\tmustContainAtLeastOneNumber = false,\n\t\tmustContainAtLeastOneSpecialCharacter = false,\n\t\tthrowError = true\n\t} = {}) {\n\t\tthis.regex = {\n\t\t\tmustContainAtLeastOneLowercase: new RegExp('[a-z]'),\n\t\t\tmustContainAtLeastOneUppercase: new RegExp('[A-Z]'),\n\t\t\tmustContainAtLeastOneNumber: new RegExp('[0-9]'),\n\t\t\tmustContainAtLeastOneSpecialCharacter: new RegExp('[^A-Za-z0-9 ]')\n\t\t};\n\n\t\tthis.enabled = enabled;\n\t\tthis.minLength = minLength;\n\t\tthis.maxLength = maxLength;\n\t\tthis.forbidRepeatingCharacters = forbidRepeatingCharacters;\n\t\tthis.forbidRepeatingCharactersCount = forbidRepeatingCharactersCount;\n\t\tthis.mustContainAtLeastOneLowercase = mustContainAtLeastOneLowercase;\n\t\tthis.mustContainAtLeastOneUppercase = mustContainAtLeastOneUppercase;\n\t\tthis.mustContainAtLeastOneNumber = mustContainAtLeastOneNumber;\n\t\tthis.mustContainAtLeastOneSpecialCharacter = mustContainAtLeastOneSpecialCharacter;\n\t\tthis.throwError = throwError;\n\t}\n\n\tset forbidRepeatingCharactersCount(value) {\n\t\tthis._forbidRepeatingCharactersCount = value;\n\t\tthis.regex.forbiddingRepeatingCharacters = new RegExp(`(.)\\\\1{${ this.forbidRepeatingCharactersCount },}`);\n\t}\n\n\tget forbidRepeatingCharactersCount() {\n\t\treturn this._forbidRepeatingCharactersCount;\n\t}\n\n\terror(error, message) {\n\t\tif (this.throwError) {\n\t\t\tthrow new Meteor.Error(error, message);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tvalidate(password) {\n\t\tif (!this.enabled) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!password || typeof password !== 'string' || !password.length) {\n\t\t\treturn this.error('error-password-policy-not-met', 'The password provided does not meet the server\\'s password policy.');\n\t\t}\n\n\t\tif (this.minLength >= 1 && password.length < this.minLength) {\n\t\t\treturn this.error('error-password-policy-not-met-minLength', 'The password does not meet the minimum length password policy.');\n\t\t}\n\n\t\tif (this.maxLength >= 1 && password.length > this.maxLength) {\n\t\t\treturn this.error('error-password-policy-not-met-maxLength', 'The password does not meet the maximum length password policy.');\n\t\t}\n\n\t\tif (this.forbidRepeatingCharacters && this.regex.forbiddingRepeatingCharacters.test(password)) {\n\t\t\treturn this.error('error-password-policy-not-met-repeatingCharacters', 'The password contains repeating characters which is against the password policy.');\n\t\t}\n\n\t\tif (this.mustContainAtLeastOneLowercase && !this.regex.mustContainAtLeastOneLowercase.test(password)) {\n\t\t\treturn this.error('error-password-policy-not-met-oneLowercase', 'The password does not contain at least one lowercase character which is against the password policy.');\n\t\t}\n\n\t\tif (this.mustContainAtLeastOneUppercase && !this.regex.mustContainAtLeastOneUppercase.test(password)) {\n\t\t\treturn this.error('error-password-policy-not-met-oneUppercase', 'The password does not contain at least one uppercase character which is against the password policy.');\n\t\t}\n\n\t\tif (this.mustContainAtLeastOneNumber && !this.regex.mustContainAtLeastOneNumber.test(password)) {\n\t\t\treturn this.error('error-password-policy-not-met-oneNumber', 'The password does not contain at least one numerical character which is against the password policy.');\n\t\t}\n\n\t\tif (this.mustContainAtLeastOneSpecialCharacter && !this.regex.mustContainAtLeastOneSpecialCharacter.test(password)) {\n\t\t\treturn this.error('error-password-policy-not-met-oneSpecial', 'The password does not contain at least one special character which is against the password policy.');\n\t\t}\n\n\t\treturn true;\n\t}\n}\n\nexport default PasswordPolicy;\n","import fs from 'fs';\n\nfunction hasDockerEnv() {\n\ttry {\n\t\tfs.statSync('/.dockerenv');\n\t\treturn true;\n\t} catch (err) {\n\t\treturn false;\n\t}\n}\n\nfunction hasDockerCGroup() {\n\ttry {\n\t\treturn fs.readFileSync('/proc/self/cgroup', 'utf8').indexOf('docker') !== -1;\n\t} catch (err) {\n\t\treturn false;\n\t}\n}\n\nfunction check() {\n\treturn hasDockerEnv() || hasDockerCGroup();\n}\n\nlet isDocker;\nRocketChat.isDocker = function() {\n\tif (isDocker === undefined) {\n\t\tisDocker = check();\n\t}\n\n\treturn isDocker;\n};\n","RocketChat.addUserToDefaultChannels = function(user, silenced) {\n\tRocketChat.callbacks.run('beforeJoinDefaultChannels', user);\n\tconst defaultRooms = RocketChat.models.Rooms.findByDefaultAndTypes(true, ['c', 'p'], {fields: {usernames: 0}}).fetch();\n\tdefaultRooms.forEach((room) => {\n\n\t\t// put user in default rooms\n\t\tconst muted = room.ro && !RocketChat.authz.hasPermission(user._id, 'post-readonly');\n\t\tRocketChat.models.Rooms.addUsernameById(room._id, user.username, muted);\n\n\t\tif (!RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(room._id, user._id)) {\n\n\t\t\t// Add a subscription to this user\n\t\t\tRocketChat.models.Subscriptions.createWithRoomAndUser(room, user, {\n\t\t\t\tts: new Date(),\n\t\t\t\topen: true,\n\t\t\t\talert: true,\n\t\t\t\tunread: 1,\n\t\t\t\tuserMentions: 1,\n\t\t\t\tgroupMentions: 0\n\t\t\t});\n\n\t\t\t// Insert user joined message\n\t\t\tif (!silenced) {\n\t\t\t\tRocketChat.models.Messages.createUserJoinWithRoomIdAndUser(room._id, user);\n\t\t\t}\n\t\t}\n\t});\n};\n","RocketChat.addUserToRoom = function(rid, user, inviter, silenced) {\n\tconst now = new Date();\n\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\t// Check if user is already in room\n\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, user._id);\n\tif (subscription) {\n\t\treturn;\n\t}\n\n\tif (room.t === 'c' || room.t === 'p') {\n\t\tRocketChat.callbacks.run('beforeJoinRoom', user, room);\n\t}\n\n\tconst muted = room.ro && !RocketChat.authz.hasPermission(user._id, 'post-readonly');\n\tRocketChat.models.Rooms.addUsernameById(rid, user.username, muted);\n\tRocketChat.models.Subscriptions.createWithRoomAndUser(room, user, {\n\t\tts: now,\n\t\topen: true,\n\t\talert: true,\n\t\tunread: 1,\n\t\tuserMentions: 1,\n\t\tgroupMentions: 0\n\t});\n\n\tif (!silenced) {\n\t\tif (inviter) {\n\t\t\tRocketChat.models.Messages.createUserAddedWithRoomIdAndUser(rid, user, {\n\t\t\t\tts: now,\n\t\t\t\tu: {\n\t\t\t\t\t_id: inviter._id,\n\t\t\t\t\tusername: inviter.username\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tRocketChat.models.Messages.createUserJoinWithRoomIdAndUser(rid, user, { ts: now });\n\t\t}\n\t}\n\n\tif (room.t === 'c' || room.t === 'p') {\n\t\tMeteor.defer(function() {\n\t\t\tRocketChat.callbacks.run('afterJoinRoom', user, room);\n\t\t});\n\t}\n\n\treturn true;\n};\n","RocketChat.archiveRoom = function(rid) {\n\tRocketChat.models.Rooms.archiveById(rid);\n\tRocketChat.models.Subscriptions.archiveByRoomId(rid);\n\n\tRocketChat.callbacks.run('afterRoomArchived', RocketChat.models.Rooms.findOneById(rid), Meteor.user());\n};\n","import _ from 'underscore';\nimport s from 'underscore.string';\n\nRocketChat.checkUsernameAvailability = function(username) {\n\treturn RocketChat.settings.get('Accounts_BlockedUsernameList', function(key, value) {\n\t\tconst usernameBlackList = _.map(value.split(','), function(username) {\n\t\t\treturn username.trim();\n\t\t});\n\t\tif (usernameBlackList.length !== 0) {\n\t\t\tif (usernameBlackList.every(restrictedUsername => {\n\t\t\t\tconst regex = new RegExp(`^${ s.escapeRegExp(restrictedUsername) }$`, 'i');\n\t\t\t\treturn !regex.test(s.trim(s.escapeRegExp(username)));\n\t\t\t})) {\n\t\t\t\treturn !Meteor.users.findOne({\n\t\t\t\t\tusername: {\n\t\t\t\t\t\t$regex: new RegExp(`^${ s.trim(s.escapeRegExp(username)) }$`, 'i')\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t});\n};\n","import s from 'underscore.string';\n\nRocketChat.checkEmailAvailability = function(email) {\n\treturn !Meteor.users.findOne({ 'emails.address': { $regex : new RegExp(`^${ s.trim(s.escapeRegExp(email)) }$`, 'i') } });\n};\n","/* globals RocketChat */\nimport _ from 'underscore';\nimport s from 'underscore.string';\n\nRocketChat.createRoom = function(type, name, owner, members, readOnly, extraData={}) {\n\tname = s.trim(name);\n\towner = s.trim(owner);\n\tmembers = [].concat(members);\n\n\tif (!name) {\n\t\tthrow new Meteor.Error('error-invalid-name', 'Invalid name', { function: 'RocketChat.createRoom' });\n\t}\n\n\towner = RocketChat.models.Users.findOneByUsername(owner, { fields: { username: 1 }});\n\tif (!owner) {\n\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { function: 'RocketChat.createRoom' });\n\t}\n\n\tif (!_.contains(members, owner.username)) {\n\t\tmembers.push(owner.username);\n\t}\n\n\tif (extraData.broadcast) {\n\t\treadOnly = true;\n\t\tdelete extraData.reactWhenReadOnly;\n\t}\n\n\tconst now = new Date();\n\tlet room = Object.assign({\n\t\tname: RocketChat.getValidRoomName(name),\n\t\tfname: name,\n\t\tt: type,\n\t\tmsgs: 0,\n\t\tusernames: members,\n\t\tu: {\n\t\t\t_id: owner._id,\n\t\t\tusername: owner.username\n\t\t}\n\t}, extraData, {\n\t\tts: now,\n\t\tro: readOnly === true,\n\t\tsysMes: readOnly !== true\n\t});\n\n\tif (Apps && Apps.isLoaded()) {\n\t\tconst prevent = Promise.await(Apps.getBridges().getListenerBridge().roomEvent('IPreRoomCreatePrevent', room));\n\t\tif (prevent) {\n\t\t\tthrow new Meteor.Error('error-app-prevented-creation', 'A Rocket.Chat App prevented the room creation.');\n\t\t}\n\n\t\tlet result;\n\t\tresult = Promise.await(Apps.getBridges().getListenerBridge().roomEvent('IPreRoomCreateExtend', room));\n\t\tresult = Promise.await(Apps.getBridges().getListenerBridge().roomEvent('IPreRoomCreateModify', result));\n\n\t\tif (typeof result === 'object') {\n\t\t\troom = Object.assign(room, result);\n\t\t}\n\t}\n\n\tif (type === 'c') {\n\t\tRocketChat.callbacks.run('beforeCreateChannel', owner, room);\n\t}\n\n\troom = RocketChat.models.Rooms.createWithFullRoomData(room);\n\n\tfor (const username of members) {\n\t\tconst member = RocketChat.models.Users.findOneByUsername(username, { fields: { username: 1, 'settings.preferences': 1 }});\n\t\tconst isTheOwner = username === owner.username;\n\t\tif (!member) {\n\t\t\tcontinue;\n\t\t}\n\n\t\t// make all room members (Except the owner) muted by default, unless they have the post-readonly permission\n\t\tif (readOnly === true && !RocketChat.authz.hasPermission(member._id, 'post-readonly') && !isTheOwner) {\n\t\t\tRocketChat.models.Rooms.muteUsernameByRoomId(room._id, username);\n\t\t}\n\n\t\tconst extra = { open: true };\n\n\t\tif (username === owner.username) {\n\t\t\textra.ls = now;\n\t\t}\n\n\t\tRocketChat.models.Subscriptions.createWithRoomAndUser(room, member, extra);\n\t}\n\n\tRocketChat.authz.addUserRoles(owner._id, ['owner'], room._id);\n\n\tif (type === 'c') {\n\t\tMeteor.defer(() => {\n\t\t\tRocketChat.callbacks.run('afterCreateChannel', owner, room);\n\t\t});\n\t} else if (type === 'p') {\n\t\tMeteor.defer(() => {\n\t\t\tRocketChat.callbacks.run('afterCreatePrivateGroup', owner, room);\n\t\t});\n\t}\n\tMeteor.defer(() => {\n\t\tRocketChat.callbacks.run('afterCreateRoom', owner, room);\n\t});\n\n\tif (Apps && Apps.isLoaded()) {\n\t\t// This returns a promise, but it won't mutate anything about the message\n\t\t// so, we don't really care if it is successful or fails\n\t\tApps.getBridges().getListenerBridge().roomEvent('IPostRoomCreate', room);\n\t}\n\n\treturn {\n\t\trid: room._id,\n\t\tname: room.name\n\t};\n};\n","/* globals FileUpload */\nRocketChat.deleteMessage = function(message, user) {\n\tconst keepHistory = RocketChat.settings.get('Message_KeepHistory');\n\tconst showDeletedStatus = RocketChat.settings.get('Message_ShowDeletedStatus');\n\tconst deletedMsg = RocketChat.models.Messages.findOneById(message._id);\n\n\tif (deletedMsg && Apps && Apps.isLoaded()) {\n\t\tconst prevent = Promise.await(Apps.getBridges().getListenerBridge().messageEvent('IPreMessageDeletePrevent', deletedMsg));\n\t\tif (prevent) {\n\t\t\tthrow new Meteor.Error('error-app-prevented-deleting', 'A Rocket.Chat App prevented the message deleting.');\n\t\t}\n\t}\n\n\tif (keepHistory) {\n\t\tif (showDeletedStatus) {\n\t\t\tRocketChat.models.Messages.cloneAndSaveAsHistoryById(message._id);\n\t\t} else {\n\t\t\tRocketChat.models.Messages.setHiddenById(message._id, true);\n\t\t}\n\n\t\tif (message.file && message.file._id) {\n\t\t\tRocketChat.models.Uploads.update(message.file._id, { $set: { _hidden: true } });\n\t\t}\n\t} else {\n\t\tif (!showDeletedStatus) {\n\t\t\tRocketChat.models.Messages.removeById(message._id);\n\t\t}\n\n\t\tif (message.file && message.file._id) {\n\t\t\tFileUpload.getStore('Uploads').deleteById(message.file._id);\n\t\t}\n\t}\n\n\tMeteor.defer(function() {\n\t\tRocketChat.callbacks.run('afterDeleteMessage', deletedMsg);\n\t});\n\n\t// update last message\n\tif (RocketChat.settings.get('Store_Last_Message')) {\n\t\tconst room = RocketChat.models.Rooms.findOneById(message.rid, { fields: { lastMessage: 1 } });\n\t\tif (!room.lastMessage || room.lastMessage._id === message._id) {\n\t\t\tconst lastMessage = RocketChat.models.Messages.getLastVisibleMessageSentWithNoTypeByRoomId(message.rid, message._id);\n\t\t\tRocketChat.models.Rooms.setLastMessageById(message.rid, lastMessage);\n\t\t}\n\t}\n\n\tif (showDeletedStatus) {\n\t\tRocketChat.models.Messages.setAsDeletedByIdAndUser(message._id, user);\n\t} else {\n\t\tRocketChat.Notifications.notifyRoom(message.rid, 'deleteMessage', { _id: message._id });\n\t}\n\n\tif (Apps && Apps.isLoaded()) {\n\t\tApps.getBridges().getListenerBridge().messageEvent('IPostMessageDeleted', deletedMsg);\n\t}\n};\n","RocketChat.deleteUser = function(userId) {\n\tconst user = RocketChat.models.Users.findOneById(userId);\n\n\t// Users without username can't do anything, so there is nothing to remove\n\tif (user.username != null) {\n\t\tconst messageErasureType = RocketChat.settings.get('Message_ErasureType');\n\n\t\tswitch (messageErasureType) {\n\t\t\tcase 'Delete' :\n\t\t\t\tRocketChat.models.Messages.removeByUserId(userId);\n\t\t\t\tbreak;\n\t\t\tcase 'Unlink' :\n\t\t\t\tconst rocketCat = RocketChat.models.Users.findById('rocket.cat').fetch()[0];\n\t\t\t\tconst nameAlias = TAPi18n.__('Removed_User');\n\t\t\t\tRocketChat.models.Messages.unlinkUserId(userId, rocketCat._id, rocketCat.username, nameAlias);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tRocketChat.models.Subscriptions.db.findByUserId(userId).forEach((subscription) => {\n\t\t\tconst room = RocketChat.models.Rooms.findOneById(subscription.rid);\n\t\t\tif (room) {\n\t\t\t\tif (room.t !== 'c' && room.usernames.length === 1) {\n\t\t\t\t\tRocketChat.models.Rooms.removeById(subscription.rid); // Remove non-channel rooms with only 1 user (the one being deleted)\n\t\t\t\t}\n\t\t\t\tif (room.t === 'd') {\n\t\t\t\t\tRocketChat.models.Subscriptions.removeByRoomId(subscription.rid);\n\t\t\t\t\tRocketChat.models.Messages.removeByRoomId(subscription.rid);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tRocketChat.models.Subscriptions.removeByUserId(userId); // Remove user subscriptions\n\t\tRocketChat.models.Rooms.removeByTypeContainingUsername('d', user.username); // Remove direct rooms with the user\n\t\tRocketChat.models.Rooms.removeUsernameFromAll(user.username); // Remove user from all other rooms\n\n\t\t// removes user's avatar\n\t\tif (user.avatarOrigin === 'upload' || user.avatarOrigin === 'url') {\n\t\t\tFileUpload.getStore('Avatars').deleteByName(user.username);\n\t\t}\n\n\t\tRocketChat.models.Integrations.disableByUserId(userId); // Disables all the integrations which rely on the user being deleted.\n\t}\n\n\tRocketChat.models.Users.removeById(userId); // Remove user from users database\n};\n","/* globals RocketChat */\nimport _ from 'underscore';\nimport s from 'underscore.string';\n\nRocketChat.getFullUserData = function({userId, filter, limit}) {\n\tlet fields = {\n\t\tname: 1,\n\t\tusername: 1,\n\t\tstatus: 1,\n\t\tutcOffset: 1,\n\t\ttype: 1,\n\t\tactive: 1,\n\t\treason: 1\n\t};\n\n\tif (RocketChat.authz.hasPermission(userId, 'view-full-other-user-info')) {\n\t\tfields = _.extend(fields, {\n\t\t\temails: 1,\n\t\t\tphone: 1,\n\t\t\tstatusConnection: 1,\n\t\t\tcreatedAt: 1,\n\t\t\tlastLogin: 1,\n\t\t\tservices: 1,\n\t\t\trequirePasswordChange: 1,\n\t\t\trequirePasswordChangeReason: 1,\n\t\t\troles: 1,\n\t\t\tcustomFields: 1\n\t\t});\n\t} else if (limit !== 0) {\n\t\tlimit = 1;\n\t}\n\n\tfilter = s.trim(filter);\n\n\tif (!filter && limit === 1) {\n\t\treturn undefined;\n\t}\n\n\tconst options = {\n\t\tfields,\n\t\tlimit,\n\t\tsort: { username: 1 }\n\t};\n\n\tif (filter) {\n\t\tif (limit === 1) {\n\t\t\treturn RocketChat.models.Users.findByUsername(filter, options);\n\t\t} else {\n\t\t\tconst filterReg = new RegExp(s.escapeRegExp(filter), 'i');\n\t\t\treturn RocketChat.models.Users.findByUsernameNameOrEmailAddress(filterReg, options);\n\t\t}\n\t}\n\n\treturn RocketChat.models.Users.find({}, options);\n};\n","/* globals RocketChat */\nimport _ from 'underscore';\n\nRocketChat.getRoomByNameOrIdWithOptionToJoin = function _getRoomByNameOrIdWithOptionToJoin({ currentUserId, nameOrId, type='', tryDirectByUserIdOnly=false, joinChannel=true, errorOnEmpty=true }) {\n\tlet room;\n\n\t//If the nameOrId starts with #, then let's try to find a channel or group\n\tif (nameOrId.startsWith('#')) {\n\t\tnameOrId = nameOrId.substring(1);\n\t\troom = RocketChat.models.Rooms.findOneByIdOrName(nameOrId);\n\t} else if (nameOrId.startsWith('@') || type === 'd') {\n\t\t//If the nameOrId starts with @ OR type is 'd', then let's try just a direct message\n\t\tnameOrId = nameOrId.replace('@', '');\n\n\t\tlet roomUser;\n\t\tif (tryDirectByUserIdOnly) {\n\t\t\troomUser = RocketChat.models.Users.findOneById(nameOrId);\n\t\t} else {\n\t\t\troomUser = RocketChat.models.Users.findOne({\n\t\t\t\t$or: [{ _id: nameOrId }, { username: nameOrId }]\n\t\t\t});\n\t\t}\n\n\t\tconst rid = _.isObject(roomUser) ? [currentUserId, roomUser._id].sort().join('') : nameOrId;\n\t\troom = RocketChat.models.Rooms.findOneById(rid);\n\n\t\t//If the room hasn't been found yet, let's try some more\n\t\tif (!_.isObject(room)) {\n\t\t\t//If the roomUser wasn't found, then there's no destination to point towards\n\t\t\t//so return out based upon errorOnEmpty\n\t\t\tif (!_.isObject(roomUser)) {\n\t\t\t\tif (errorOnEmpty) {\n\t\t\t\t\tthrow new Meteor.Error('invalid-channel');\n\t\t\t\t} else {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\troom = Meteor.runAsUser(currentUserId, function() {\n\t\t\t\tconst {rid} = Meteor.call('createDirectMessage', roomUser.username);\n\t\t\t\treturn RocketChat.models.Rooms.findOneById(rid);\n\t\t\t});\n\t\t}\n\t} else {\n\t\t//Otherwise, we'll treat this as a channel or group.\n\t\troom = RocketChat.models.Rooms.findOneByIdOrName(nameOrId);\n\t}\n\n\t//If no room was found, handle the room return based upon errorOnEmpty\n\tif (!room && errorOnEmpty) {\n\t\tthrow new Meteor.Error('invalid-channel');\n\t} else if (!room) {\n\t\treturn;\n\t}\n\n\t//If a room was found and they provided a type to search, then check\n\t//and if the type found isn't what we're looking for then handle\n\t//the return based upon errorOnEmpty\n\tif (type && room.t !== type) {\n\t\tif (errorOnEmpty) {\n\t\t\tthrow new Meteor.Error('invalid-channel');\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n\n\t//If the room type is channel and joinChannel has been passed, try to join them\n\t//if they can't join the room, this will error out!\n\tif (room.t === 'c' && joinChannel) {\n\t\tconst sub = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(room._id, currentUserId);\n\n\t\tif (!sub) {\n\t\t\tMeteor.runAsUser(currentUserId, function() {\n\t\t\t\treturn Meteor.call('joinRoom', room._id);\n\t\t\t});\n\t\t}\n\t}\n\n\treturn room;\n};\n","import _ from 'underscore';\n\nconst hideMessagesOfType = [];\n\nRocketChat.settings.get(/Message_HideType_.+/, function(key, value) {\n\tconst type = key.replace('Message_HideType_', '');\n\tconst types = type === 'mute_unmute' ? ['user-muted', 'user-unmuted'] : [type];\n\n\treturn types.forEach((type) => {\n\t\tconst index = hideMessagesOfType.indexOf(type);\n\n\t\tif (value === true && index === -1) {\n\t\t\treturn hideMessagesOfType.push(type);\n\t\t}\n\n\t\tif (index > -1) {\n\t\t\treturn hideMessagesOfType.splice(index, 1);\n\t\t}\n\t});\n});\n\nRocketChat.loadMessageHistory = function loadMessageHistory({ userId, rid, end, limit = 20, ls }) {\n\tconst options = {\n\t\tsort: {\n\t\t\tts: -1\n\t\t},\n\t\tlimit\n\t};\n\n\tif (!RocketChat.settings.get('Message_ShowEditedStatus')) {\n\t\toptions.fields = {\n\t\t\teditedAt: 0\n\t\t};\n\t}\n\n\tlet records;\n\tif (end != null) {\n\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdBeforeTimestampNotContainingTypes(rid, end, hideMessagesOfType, options).fetch();\n\t} else {\n\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdNotContainingTypes(rid, hideMessagesOfType, options).fetch();\n\t}\n\n\tconst UI_Use_Real_Name = RocketChat.settings.get('UI_Use_Real_Name') === true;\n\n\tconst messages = records.map((message) => {\n\t\tmessage.starred = _.findWhere(message.starred, {\n\t\t\t_id: userId\n\t\t});\n\t\tif (message.u && message.u._id && UI_Use_Real_Name) {\n\t\t\tconst user = RocketChat.models.Users.findOneById(message.u._id);\n\t\t\tmessage.u.name = user && user.name;\n\t\t}\n\t\tif (message.mentions && message.mentions.length && UI_Use_Real_Name) {\n\t\t\tmessage.mentions.forEach((mention) => {\n\t\t\t\tconst user = RocketChat.models.Users.findOneById(mention._id);\n\t\t\t\tmention.name = user && user.name;\n\t\t\t});\n\t\t}\n\t\treturn message;\n\t});\n\n\tlet unreadNotLoaded = 0;\n\tlet firstUnread;\n\n\tif (ls != null) {\n\t\tconst firstMessage = messages[messages.length - 1];\n\n\t\tif ((firstMessage != null ? firstMessage.ts : undefined) > ls) {\n\t\t\tdelete options.limit;\n\n\t\t\tconst unreadMessages = RocketChat.models.Messages.findVisibleByRoomIdBetweenTimestampsNotContainingTypes(rid, ls, firstMessage.ts, hideMessagesOfType, {\n\t\t\t\tlimit: 1,\n\t\t\t\tsort: {\n\t\t\t\t\tts: 1\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfirstUnread = unreadMessages.fetch()[0];\n\t\t\tunreadNotLoaded = unreadMessages.count();\n\t\t}\n\t}\n\n\treturn {\n\t\tmessages,\n\t\tfirstUnread,\n\t\tunreadNotLoaded\n\t};\n};\n","RocketChat.removeUserFromRoom = function(rid, user) {\n\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\tif (room) {\n\t\tRocketChat.callbacks.run('beforeLeaveRoom', user, room);\n\t\tRocketChat.models.Rooms.removeUsernameById(rid, user.username);\n\n\t\tif (room.usernames.indexOf(user.username) !== -1) {\n\t\t\tconst removedUser = user;\n\t\t\tRocketChat.models.Messages.createUserLeaveWithRoomIdAndUser(rid, removedUser);\n\t\t}\n\n\t\tif (room.t === 'l') {\n\t\t\tRocketChat.models.Messages.createCommandWithRoomIdAndUser('survey', rid, user);\n\t\t}\n\n\t\tRocketChat.models.Subscriptions.removeByRoomIdAndUserId(rid, user._id);\n\n\t\tMeteor.defer(function() {\n\t\t\tRocketChat.callbacks.run('afterLeaveRoom', user, room);\n\t\t});\n\t}\n};\n","/* globals Gravatar */\nimport _ from 'underscore';\nimport s from 'underscore.string';\n\nRocketChat.saveUser = function(userId, userData) {\n\tconst user = RocketChat.models.Users.findOneById(userId);\n\tconst existingRoles = _.pluck(RocketChat.authz.getRoles(), '_id');\n\n\tif (userData._id && userId !== userData._id && !RocketChat.authz.hasPermission(userId, 'edit-other-user-info')) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'Editing user is not allowed', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\taction: 'Editing_user'\n\t\t});\n\t}\n\n\tif (!userData._id && !RocketChat.authz.hasPermission(userId, 'create-user')) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'Adding user is not allowed', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\taction: 'Adding_user'\n\t\t});\n\t}\n\n\tif (userData.roles && _.difference(userData.roles, existingRoles).length > 0) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'The field Roles consist invalid role name', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\taction: 'Assign_role'\n\t\t});\n\t}\n\n\tif (userData.roles && _.indexOf(userData.roles, 'admin') >= 0 && !RocketChat.authz.hasPermission(userId, 'assign-admin-role')) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'Assigning admin is not allowed', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\taction: 'Assign_admin'\n\t\t});\n\t}\n\n\tif (!userData._id && !s.trim(userData.name)) {\n\t\tthrow new Meteor.Error('error-the-field-is-required', 'The field Name is required', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\tfield: 'Name'\n\t\t});\n\t}\n\n\tif (!userData._id && !s.trim(userData.username)) {\n\t\tthrow new Meteor.Error('error-the-field-is-required', 'The field Username is required', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\tfield: 'Username'\n\t\t});\n\t}\n\n\tlet nameValidation;\n\n\ttry {\n\t\tnameValidation = new RegExp(`^${ RocketChat.settings.get('UTF8_Names_Validation') }$`);\n\t} catch (e) {\n\t\tnameValidation = new RegExp('^[0-9a-zA-Z-_.]+$');\n\t}\n\n\tif (userData.username && !nameValidation.test(userData.username)) {\n\t\tthrow new Meteor.Error('error-input-is-not-a-valid-field', `${ _.escape(userData.username) } is not a valid username`, {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\tinput: userData.username,\n\t\t\tfield: 'Username'\n\t\t});\n\t}\n\n\tif (!userData._id && !userData.password) {\n\t\tthrow new Meteor.Error('error-the-field-is-required', 'The field Password is required', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\tfield: 'Password'\n\t\t});\n\t}\n\n\tif (!userData._id) {\n\t\tif (!RocketChat.checkUsernameAvailability(userData.username)) {\n\t\t\tthrow new Meteor.Error('error-field-unavailable', `${ _.escape(userData.username) } is already in use :(`, {\n\t\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\t\tfield: userData.username\n\t\t\t});\n\t\t}\n\n\t\tif (userData.email && !RocketChat.checkEmailAvailability(userData.email)) {\n\t\t\tthrow new Meteor.Error('error-field-unavailable', `${ _.escape(userData.email) } is already in use :(`, {\n\t\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\t\tfield: userData.email\n\t\t\t});\n\t\t}\n\n\t\tRocketChat.validateEmailDomain(userData.email);\n\n\t\t// insert user\n\t\tconst createUser = {\n\t\t\tusername: userData.username,\n\t\t\tpassword: userData.password,\n\t\t\tjoinDefaultChannels: userData.joinDefaultChannels\n\t\t};\n\t\tif (userData.email) {\n\t\t\tcreateUser.email = userData.email;\n\t\t}\n\n\t\tconst _id = Accounts.createUser(createUser);\n\n\t\tconst updateUser = {\n\t\t\t$set: {\n\t\t\t\tname: userData.name,\n\t\t\t\troles: userData.roles || ['user'],\n\t\t\t\tsettings: userData.settings || {}\n\t\t\t}\n\t\t};\n\n\t\tif (typeof userData.requirePasswordChange !== 'undefined') {\n\t\t\tupdateUser.$set.requirePasswordChange = userData.requirePasswordChange;\n\t\t}\n\n\t\tif (typeof userData.verified === 'boolean') {\n\t\t\tupdateUser.$set['emails.0.verified'] = userData.verified;\n\t\t}\n\n\t\tMeteor.users.update({ _id }, updateUser);\n\n\t\tif (userData.sendWelcomeEmail) {\n\t\t\tconst header = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Header') || '');\n\t\t\tconst footer = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Footer') || '');\n\n\t\t\tlet subject;\n\t\t\tlet html;\n\n\t\t\tif (RocketChat.settings.get('Accounts_UserAddedEmail_Customized')) {\n\t\t\t\tsubject = RocketChat.settings.get('Accounts_UserAddedEmailSubject');\n\t\t\t\thtml = RocketChat.settings.get('Accounts_UserAddedEmail');\n\t\t\t} else {\n\t\t\t\tsubject = TAPi18n.__('Accounts_UserAddedEmailSubject_Default', { lng: user.language || RocketChat.settings.get('language') || 'en' });\n\t\t\t\thtml = TAPi18n.__('Accounts_UserAddedEmail_Default', { lng: user.language || RocketChat.settings.get('language') || 'en' });\n\t\t\t}\n\n\t\t\tsubject = RocketChat.placeholders.replace(subject);\n\t\t\thtml = RocketChat.placeholders.replace(html, {\n\t\t\t\tname: userData.name,\n\t\t\t\temail: userData.email,\n\t\t\t\tpassword: userData.password\n\t\t\t});\n\n\t\t\tconst email = {\n\t\t\t\tto: userData.email,\n\t\t\t\tfrom: RocketChat.settings.get('From_Email'),\n\t\t\t\tsubject,\n\t\t\t\thtml: header + html + footer\n\t\t\t};\n\n\t\t\tMeteor.defer(function() {\n\t\t\t\ttry {\n\t\t\t\t\tEmail.send(email);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tthrow new Meteor.Error('error-email-send-failed', `Error trying to send email: ${ error.message }`, {\n\t\t\t\t\t\tfunction: 'RocketChat.saveUser',\n\t\t\t\t\t\tmessage: error.message\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tuserData._id = _id;\n\n\t\tif (RocketChat.settings.get('Accounts_SetDefaultAvatar') === true && userData.email) {\n\t\t\tconst gravatarUrl = Gravatar.imageUrl(userData.email, { default: '404', size: 200, secure: true });\n\n\t\t\ttry {\n\t\t\t\tRocketChat.setUserAvatar(userData, gravatarUrl, '', 'url');\n\t\t\t} catch (e) {\n\t\t\t\t//Ignore this error for now, as it not being successful isn't bad\n\t\t\t}\n\t\t}\n\n\t\treturn _id;\n\t} else {\n\t\t// update user\n\t\tif (userData.username) {\n\t\t\tRocketChat.setUsername(userData._id, userData.username);\n\t\t}\n\n\t\tif (userData.name) {\n\t\t\tRocketChat.setRealName(userData._id, userData.name);\n\t\t}\n\n\t\tif (userData.email) {\n\t\t\tconst shouldSendVerificationEmailToUser = userData.verified !== true;\n\t\t\tRocketChat.setEmail(userData._id, userData.email, shouldSendVerificationEmailToUser);\n\t\t}\n\n\t\tif (userData.password && userData.password.trim() && RocketChat.authz.hasPermission(userId, 'edit-other-user-password') && RocketChat.passwordPolicy.validate(userData.password)) {\n\t\t\tAccounts.setPassword(userData._id, userData.password.trim());\n\t\t}\n\n\t\tconst updateUser = {\n\t\t\t$set: {}\n\t\t};\n\n\t\tif (userData.roles) {\n\t\t\tupdateUser.$set.roles = userData.roles;\n\t\t}\n\n\t\tif (userData.settings) {\n\t\t\tupdateUser.$set.settings = { preferences: userData.settings.preferences };\n\t\t}\n\n\t\tif (typeof userData.requirePasswordChange !== 'undefined') {\n\t\t\tupdateUser.$set.requirePasswordChange = userData.requirePasswordChange;\n\t\t}\n\n\t\tif (typeof userData.verified === 'boolean') {\n\t\t\tupdateUser.$set['emails.0.verified'] = userData.verified;\n\t\t}\n\n\t\tMeteor.users.update({ _id: userData._id }, updateUser);\n\n\t\treturn true;\n\t}\n};\n","import s from 'underscore.string';\n\nRocketChat.saveCustomFields = function(userId, formData) {\n\tif (s.trim(RocketChat.settings.get('Accounts_CustomFields')) !== '') {\n\t\tRocketChat.validateCustomFields(formData);\n\t\treturn RocketChat.saveCustomFieldsWithoutValidation(userId, formData);\n\t}\n};\n","import s from 'underscore.string';\n\nRocketChat.saveCustomFieldsWithoutValidation = function(userId, formData) {\n\tif (s.trim(RocketChat.settings.get('Accounts_CustomFields')) !== '') {\n\t\tlet customFieldsMeta;\n\t\ttry {\n\t\t\tcustomFieldsMeta = JSON.parse(RocketChat.settings.get('Accounts_CustomFields'));\n\t\t} catch (e) {\n\t\t\tthrow new Meteor.Error('error-invalid-customfield-json', 'Invalid JSON for Custom Fields');\n\t\t}\n\n\t\tconst customFields = {};\n\t\tObject.keys(customFieldsMeta).forEach(key => customFields[key] = formData[key]);\n\t\tRocketChat.models.Users.setCustomFields(userId, customFields);\n\n\t\t// Update customFields of all Direct Messages' Rooms for userId\n\t\tRocketChat.models.Subscriptions.setCustomFieldsDirectMessagesByUserId(userId, customFields);\n\n\t\tObject.keys(customFields).forEach((fieldName) => {\n\t\t\tif (!customFieldsMeta[fieldName].modifyRecordField) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst modifyRecordField = customFieldsMeta[fieldName].modifyRecordField;\n\t\t\tconst update = {};\n\t\t\tif (modifyRecordField.array) {\n\t\t\t\tupdate.$addToSet = {};\n\t\t\t\tupdate.$addToSet[modifyRecordField.field] = customFields[fieldName];\n\t\t\t} else {\n\t\t\t\tupdate.$set = {};\n\t\t\t\tupdate.$set[modifyRecordField.field] = customFields[fieldName];\n\t\t\t}\n\n\t\t\tRocketChat.models.Users.update(userId, update);\n\t\t});\n\t}\n};\n","const objectMaybeIncluding = (types) => {\n\treturn Match.Where((value) => {\n\t\tObject.keys(types).forEach(field => {\n\t\t\tif (value[field] != null) {\n\t\t\t\ttry {\n\t\t\t\t\tcheck(value[field], types[field]);\n\t\t\t\t} catch (error) {\n\t\t\t\t\terror.path = field;\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t});\n};\n\nconst validateAttachmentsFields = attachmentFields => {\n\tcheck(attachmentFields, objectMaybeIncluding({\n\t\tshort: Boolean\n\t}));\n\n\tcheck(attachmentFields, objectMaybeIncluding({\n\t\ttitle: String,\n\t\tvalue: String\n\t}));\n};\n\nconst validateAttachment = attachment => {\n\tcheck(attachment, objectMaybeIncluding({\n\t\tcolor: String,\n\t\ttext: String,\n\t\tts: Match.OneOf(String, Match.Integer),\n\t\tthumb_url: String,\n\t\tmessage_link: String,\n\t\tcollapsed: Boolean,\n\t\tauthor_name: String,\n\t\tauthor_link: String,\n\t\tauthor_icon: String,\n\t\ttitle: String,\n\t\ttitle_link: String,\n\t\ttitle_link_download: Boolean,\n\t\timage_url: String,\n\t\taudio_url: String,\n\t\tvideo_url: String,\n\t\tfields: [Match.Any]\n\t}));\n\n\tif (attachment.fields && attachment.fields.length) {\n\t\tattachment.fields.map(validateAttachmentsFields);\n\t}\n};\n\nconst validateBodyAttachments = attachments => attachments.map(validateAttachment);\n\nRocketChat.sendMessage = function(user, message, room, upsert = false) {\n\tif (!user || !message || !room._id) {\n\t\treturn false;\n\t}\n\n\tcheck(message, objectMaybeIncluding({\n\t\t_id: String,\n\t\tmsg: String,\n\t\ttext: String,\n\t\talias: String,\n\t\temoji: String,\n\t\tavatar: String,\n\t\tattachments: [Match.Any]\n\t}));\n\n\tif (Array.isArray(message.attachments) && message.attachments.length) {\n\t\tvalidateBodyAttachments(message.attachments);\n\t}\n\n\tif (!message.ts) {\n\t\tmessage.ts = new Date();\n\t}\n\tconst { _id, username, name } = user;\n\tmessage.u = {\n\t\t_id,\n\t\tusername,\n\t\tname\n\t};\n\tmessage.rid = room._id;\n\n\tif (!Match.test(message.msg, String)) {\n\t\tmessage.msg = '';\n\t}\n\n\tif (message.ts == null) {\n\t\tmessage.ts = new Date();\n\t}\n\n\tif (!room.usernames || room.usernames.length === 0) {\n\t\tconst updated_room = RocketChat.models.Rooms.findOneById(room._id);\n\t\tif (updated_room) {\n\t\t\troom = updated_room;\n\t\t} else {\n\t\t\troom.usernames = [];\n\t\t}\n\t}\n\n\tif (RocketChat.settings.get('Message_Read_Receipt_Enabled')) {\n\t\tmessage.unread = true;\n\t}\n\n\t// For the Rocket.Chat Apps :)\n\tif (message && Apps && Apps.isLoaded()) {\n\t\tconst prevent = Promise.await(Apps.getBridges().getListenerBridge().messageEvent('IPreMessageSentPrevent', message));\n\t\tif (prevent) {\n\t\t\tthrow new Meteor.Error('error-app-prevented-sending', 'A Rocket.Chat App prevented the messaging sending.');\n\t\t}\n\n\t\tlet result;\n\t\tresult = Promise.await(Apps.getBridges().getListenerBridge().messageEvent('IPreMessageSentExtend', message));\n\t\tresult = Promise.await(Apps.getBridges().getListenerBridge().messageEvent('IPreMessageSentModify', result));\n\n\t\tif (typeof result === 'object') {\n\t\t\tmessage = Object.assign(message, result);\n\t\t}\n\t}\n\n\tif (message.parseUrls !== false) {\n\t\tmessage.html = message.msg;\n\t\tmessage = RocketChat.Markdown.code(message);\n\n\t\tconst urls = message.html.match(/([A-Za-z]{3,9}):\\/\\/([-;:&=\\+\\$,\\w]+@{1})?([-A-Za-z0-9\\.]+)+:?(\\d+)?((\\/[-\\+=!:~%\\/\\.@\\,\\(\\)\\w]*)?\\??([-\\+=&!:;%@\\/\\.\\,\\w]+)?(?:#([^\\s\\)]+))?)?/g);\n\t\tif (urls) {\n\t\t\tmessage.urls = urls.map((url) => ({ url }));\n\t\t}\n\n\t\tmessage = RocketChat.Markdown.mountTokensBack(message, false);\n\t\tmessage.msg = message.html;\n\t\tdelete message.html;\n\t\tdelete message.tokens;\n\t}\n\n\tmessage = RocketChat.callbacks.run('beforeSaveMessage', message);\n\tif (message) {\n\t\t// Avoid saving sandstormSessionId to the database\n\t\tlet sandstormSessionId = null;\n\t\tif (message.sandstormSessionId) {\n\t\t\tsandstormSessionId = message.sandstormSessionId;\n\t\t\tdelete message.sandstormSessionId;\n\t\t}\n\n\t\tif (message._id && upsert) {\n\t\t\tconst _id = message._id;\n\t\t\tdelete message._id;\n\t\t\tRocketChat.models.Messages.upsert({\n\t\t\t\t_id,\n\t\t\t\t'u._id': message.u._id\n\t\t\t}, message);\n\t\t\tmessage._id = _id;\n\t\t} else {\n\t\t\tmessage._id = RocketChat.models.Messages.insert(message);\n\t\t}\n\n\t\tif (Apps && Apps.isLoaded()) {\n\t\t\t// This returns a promise, but it won't mutate anything about the message\n\t\t\t// so, we don't really care if it is successful or fails\n\t\t\tApps.getBridges().getListenerBridge().messageEvent('IPostMessageSent', message);\n\t\t}\n\n\t\t/*\n\t\tDefer other updates as their return is not interesting to the user\n\t\t*/\n\t\tMeteor.defer(() => {\n\t\t\t// Execute all callbacks\n\t\t\tmessage.sandstormSessionId = sandstormSessionId;\n\t\t\treturn RocketChat.callbacks.run('afterSaveMessage', message, room, user._id);\n\t\t});\n\t\treturn message;\n\t}\n};\n","import _ from 'underscore';\n\nconst blockedSettings = {};\n\nif (process.env.SETTINGS_BLOCKED) {\n\tprocess.env.SETTINGS_BLOCKED.split(',').forEach((settingId) => blockedSettings[settingId] = 1);\n}\n\nconst hiddenSettings = {};\nif (process.env.SETTINGS_HIDDEN) {\n\tprocess.env.SETTINGS_HIDDEN.split(',').forEach((settingId) => hiddenSettings[settingId] = 1);\n}\n\nRocketChat.settings._sorter = {};\n\n\n/*\n* Add a setting\n* @param {String} _id\n* @param {Mixed} value\n* @param {Object} setting\n*/\n\nRocketChat.settings.add = function(_id, value, options = {}) {\n\tif (options == null) {\n\t\toptions = {};\n\t}\n\tif (!_id || value == null) {\n\t\treturn false;\n\t}\n\tif (RocketChat.settings._sorter[options.group] == null) {\n\t\tRocketChat.settings._sorter[options.group] = 0;\n\t}\n\toptions.packageValue = value;\n\toptions.valueSource = 'packageValue';\n\toptions.hidden = options.hidden || false;\n\toptions.blocked = options.blocked || false;\n\tif (options.sorter == null) {\n\t\toptions.sorter = RocketChat.settings._sorter[options.group]++;\n\t}\n\tif (options.enableQuery != null) {\n\t\toptions.enableQuery = JSON.stringify(options.enableQuery);\n\t}\n\tif (options.i18nDefaultQuery != null) {\n\t\toptions.i18nDefaultQuery = JSON.stringify(options.i18nDefaultQuery);\n\t}\n\tif (typeof process !== 'undefined' && process.env && process.env[_id]) {\n\t\tvalue = process.env[_id];\n\t\tif (value.toLowerCase() === 'true') {\n\t\t\tvalue = true;\n\t\t} else if (value.toLowerCase() === 'false') {\n\t\t\tvalue = false;\n\t\t}\n\t\toptions.processEnvValue = value;\n\t\toptions.valueSource = 'processEnvValue';\n\t} else if (Meteor.settings && typeof Meteor.settings[_id] !== 'undefined') {\n\t\tif (Meteor.settings[_id] == null) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvalue = Meteor.settings[_id];\n\t\toptions.meteorSettingsValue = value;\n\t\toptions.valueSource = 'meteorSettingsValue';\n\t}\n\tif (options.i18nLabel == null) {\n\t\toptions.i18nLabel = _id;\n\t}\n\tif (options.i18nDescription == null) {\n\t\toptions.i18nDescription = `${ _id }_Description`;\n\t}\n\tif (blockedSettings[_id] != null) {\n\t\toptions.blocked = true;\n\t}\n\tif (hiddenSettings[_id] != null) {\n\t\toptions.hidden = true;\n\t}\n\tif (options.autocomplete == null) {\n\t\toptions.autocomplete = true;\n\t}\n\tif (typeof process !== 'undefined' && process.env && process.env[`OVERWRITE_SETTING_${ _id }`]) {\n\t\tlet value = process.env[`OVERWRITE_SETTING_${ _id }`];\n\t\tif (value.toLowerCase() === 'true') {\n\t\t\tvalue = true;\n\t\t} else if (value.toLowerCase() === 'false') {\n\t\t\tvalue = false;\n\t\t}\n\t\toptions.value = value;\n\t\toptions.processEnvValue = value;\n\t\toptions.valueSource = 'processEnvValue';\n\t}\n\tconst updateOperations = {\n\t\t$set: options,\n\t\t$setOnInsert: {\n\t\t\tcreatedAt: new Date\n\t\t}\n\t};\n\tif (options.editor != null) {\n\t\tupdateOperations.$setOnInsert.editor = options.editor;\n\t\tdelete options.editor;\n\t}\n\tif (options.value == null) {\n\t\tif (options.force === true) {\n\t\t\tupdateOperations.$set.value = options.packageValue;\n\t\t} else {\n\t\t\tupdateOperations.$setOnInsert.value = value;\n\t\t}\n\t}\n\tconst query = _.extend({\n\t\t_id\n\t}, updateOperations.$set);\n\tif (options.section == null) {\n\t\tupdateOperations.$unset = {\n\t\t\tsection: 1\n\t\t};\n\t\tquery.section = {\n\t\t\t$exists: false\n\t\t};\n\t}\n\tconst existantSetting = RocketChat.models.Settings.db.findOne(query);\n\tif (existantSetting != null) {\n\t\tif (existantSetting.editor == null && updateOperations.$setOnInsert.editor != null) {\n\t\t\tupdateOperations.$set.editor = updateOperations.$setOnInsert.editor;\n\t\t\tdelete updateOperations.$setOnInsert.editor;\n\t\t}\n\t} else {\n\t\tupdateOperations.$set.ts = new Date;\n\t}\n\treturn RocketChat.models.Settings.upsert({\n\t\t_id\n\t}, updateOperations);\n};\n\n\n/*\n* Add a setting group\n* @param {String} _id\n*/\n\nRocketChat.settings.addGroup = function(_id, options = {}, cb) {\n\tif (!_id) {\n\t\treturn false;\n\t}\n\tif (_.isFunction(options)) {\n\t\tcb = options;\n\t\toptions = {};\n\t}\n\tif (options.i18nLabel == null) {\n\t\toptions.i18nLabel = _id;\n\t}\n\tif (options.i18nDescription == null) {\n\t\toptions.i18nDescription = `${ _id }_Description`;\n\t}\n\toptions.ts = new Date;\n\toptions.blocked = false;\n\toptions.hidden = false;\n\tif (blockedSettings[_id] != null) {\n\t\toptions.blocked = true;\n\t}\n\tif (hiddenSettings[_id] != null) {\n\t\toptions.hidden = true;\n\t}\n\tRocketChat.models.Settings.upsert({\n\t\t_id\n\t}, {\n\t\t$set: options,\n\t\t$setOnInsert: {\n\t\t\ttype: 'group',\n\t\t\tcreatedAt: new Date\n\t\t}\n\t});\n\tif (cb != null) {\n\t\tcb.call({\n\t\t\tadd(id, value, options) {\n\t\t\t\tif (options == null) {\n\t\t\t\t\toptions = {};\n\t\t\t\t}\n\t\t\t\toptions.group = _id;\n\t\t\t\treturn RocketChat.settings.add(id, value, options);\n\t\t\t},\n\t\t\tsection(section, cb) {\n\t\t\t\treturn cb.call({\n\t\t\t\t\tadd(id, value, options) {\n\t\t\t\t\t\tif (options == null) {\n\t\t\t\t\t\t\toptions = {};\n\t\t\t\t\t\t}\n\t\t\t\t\t\toptions.group = _id;\n\t\t\t\t\t\toptions.section = section;\n\t\t\t\t\t\treturn RocketChat.settings.add(id, value, options);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n};\n\n\n/*\n* Remove a setting by id\n* @param {String} _id\n*/\n\nRocketChat.settings.removeById = function(_id) {\n\tif (!_id) {\n\t\treturn false;\n\t}\n\treturn RocketChat.models.Settings.removeById(_id);\n};\n\n\n/*\n* Update a setting by id\n* @param {String} _id\n*/\n\nRocketChat.settings.updateById = function(_id, value, editor) {\n\tif (!_id || value == null) {\n\t\treturn false;\n\t}\n\tif (editor != null) {\n\t\treturn RocketChat.models.Settings.updateValueAndEditorById(_id, value, editor);\n\t}\n\treturn RocketChat.models.Settings.updateValueById(_id, value);\n};\n\n\n/*\n* Update options of a setting by id\n* @param {String} _id\n*/\n\nRocketChat.settings.updateOptionsById = function(_id, options) {\n\tif (!_id || options == null) {\n\t\treturn false;\n\t}\n\treturn RocketChat.models.Settings.updateOptionsById(_id, options);\n};\n\n\n/*\n* Update a setting by id\n* @param {String} _id\n*/\n\nRocketChat.settings.clearById = function(_id) {\n\tif (_id == null) {\n\t\treturn false;\n\t}\n\treturn RocketChat.models.Settings.updateValueById(_id, undefined);\n};\n\n\n/*\n* Update a setting by id\n*/\n\nRocketChat.settings.init = function() {\n\tRocketChat.settings.initialLoad = true;\n\tRocketChat.models.Settings.find().observe({\n\t\tadded(record) {\n\t\t\tMeteor.settings[record._id] = record.value;\n\t\t\tif (record.env === true) {\n\t\t\t\tprocess.env[record._id] = record.value;\n\t\t\t}\n\t\t\treturn RocketChat.settings.load(record._id, record.value, RocketChat.settings.initialLoad);\n\t\t},\n\t\tchanged(record) {\n\t\t\tMeteor.settings[record._id] = record.value;\n\t\t\tif (record.env === true) {\n\t\t\t\tprocess.env[record._id] = record.value;\n\t\t\t}\n\t\t\treturn RocketChat.settings.load(record._id, record.value, RocketChat.settings.initialLoad);\n\t\t},\n\t\tremoved(record) {\n\t\t\tdelete Meteor.settings[record._id];\n\t\t\tif (record.env === true) {\n\t\t\t\tdelete process.env[record._id];\n\t\t\t}\n\t\t\treturn RocketChat.settings.load(record._id, undefined, RocketChat.settings.initialLoad);\n\t\t}\n\t});\n\tRocketChat.settings.initialLoad = false;\n\tRocketChat.settings.afterInitialLoad.forEach(fn => fn(Meteor.settings));\n};\n\nRocketChat.settings.afterInitialLoad = [];\n\nRocketChat.settings.onAfterInitialLoad = function(fn) {\n\tRocketChat.settings.afterInitialLoad.push(fn);\n\tif (RocketChat.settings.initialLoad === false) {\n\t\treturn fn(Meteor.settings);\n\t}\n};\n","RocketChat.setUserAvatar = function(user, dataURI, contentType, service) {\n\tlet encoding;\n\tlet image;\n\n\tif (service === 'initials') {\n\t\treturn RocketChat.models.Users.setAvatarOrigin(user._id, service);\n\t} else if (service === 'url') {\n\t\tlet result = null;\n\n\t\ttry {\n\t\t\tresult = HTTP.get(dataURI, { npmRequestOptions: {encoding: 'binary'} });\n\t\t} catch (error) {\n\t\t\tif (!error.response || error.response.statusCode !== 404) {\n\t\t\t\tconsole.log(`Error while handling the setting of the avatar from a url (${ dataURI }) for ${ user.username }:`, error);\n\t\t\t\tthrow new Meteor.Error('error-avatar-url-handling', `Error while handling avatar setting from a URL (${ dataURI }) for ${ user.username }`, { function: 'RocketChat.setUserAvatar', url: dataURI, username: user.username });\n\t\t\t}\n\t\t}\n\n\t\tif (result.statusCode !== 200) {\n\t\t\tconsole.log(`Not a valid response, ${ result.statusCode }, from the avatar url: ${ dataURI }`);\n\t\t\tthrow new Meteor.Error('error-avatar-invalid-url', `Invalid avatar URL: ${ dataURI }`, { function: 'RocketChat.setUserAvatar', url: dataURI });\n\t\t}\n\n\t\tif (!/image\\/.+/.test(result.headers['content-type'])) {\n\t\t\tconsole.log(`Not a valid content-type from the provided url, ${ result.headers['content-type'] }, from the avatar url: ${ dataURI }`);\n\t\t\tthrow new Meteor.Error('error-avatar-invalid-url', `Invalid avatar URL: ${ dataURI }`, { function: 'RocketChat.setUserAvatar', url: dataURI });\n\t\t}\n\n\t\tencoding = 'binary';\n\t\timage = result.content;\n\t\tcontentType = result.headers['content-type'];\n\t} else if (service === 'rest') {\n\t\tencoding = 'binary';\n\t\timage = dataURI;\n\t} else {\n\t\tconst fileData = RocketChatFile.dataURIParse(dataURI);\n\t\tencoding = 'base64';\n\t\timage = fileData.image;\n\t\tcontentType = fileData.contentType;\n\t}\n\n\tconst buffer = new Buffer(image, encoding);\n\tconst fileStore = FileUpload.getStore('Avatars');\n\tfileStore.deleteByName(user.username);\n\n\tconst file = {\n\t\tuserId: user._id,\n\t\ttype: contentType,\n\t\tsize: buffer.length\n\t};\n\n\tfileStore.insert(file, buffer, () => {\n\t\tMeteor.setTimeout(function() {\n\t\t\tRocketChat.models.Users.setAvatarOrigin(user._id, service);\n\t\t\tRocketChat.Notifications.notifyLogged('updateAvatar', {username: user.username});\n\t\t}, 500);\n\t});\n};\n","import s from 'underscore.string';\n\nRocketChat._setUsername = function(userId, u) {\n\tconst username = s.trim(u);\n\tif (!userId || !username) {\n\t\treturn false;\n\t}\n\tlet nameValidation;\n\ttry {\n\t\tnameValidation = new RegExp(`^${ RocketChat.settings.get('UTF8_Names_Validation') }$`);\n\t} catch (error) {\n\t\tnameValidation = new RegExp('^[0-9a-zA-Z-_.]+$');\n\t}\n\tif (!nameValidation.test(username)) {\n\t\treturn false;\n\t}\n\tconst user = RocketChat.models.Users.findOneById(userId);\n\t// User already has desired username, return\n\tif (user.username === username) {\n\t\treturn user;\n\t}\n\tconst previousUsername = user.username;\n\t// Check username availability or if the user already owns a different casing of the name\n\tif (!previousUsername || !(username.toLowerCase() === previousUsername.toLowerCase())) {\n\t\tif (!RocketChat.checkUsernameAvailability(username)) {\n\t\t\treturn false;\n\t\t}\n\t}\n\t//If first time setting username, send Enrollment Email\n\ttry {\n\t\tif (!previousUsername && user.emails && user.emails.length > 0 && RocketChat.settings.get('Accounts_Enrollment_Email')) {\n\t\t\tAccounts.sendEnrollmentEmail(user._id);\n\t\t}\n\t} catch (e) {\n\t\tconsole.error(e);\n\t}\n\t/* globals getAvatarSuggestionForUser */\n\tuser.username = username;\n\tif (!previousUsername && RocketChat.settings.get('Accounts_SetDefaultAvatar') === true) {\n\t\tconst avatarSuggestions = getAvatarSuggestionForUser(user);\n\t\tlet gravatar;\n\t\tObject.keys(avatarSuggestions).some(service => {\n\t\t\tconst avatarData = avatarSuggestions[service];\n\t\t\tif (service !== 'gravatar') {\n\t\t\t\tRocketChat.setUserAvatar(user, avatarData.blob, avatarData.contentType, service);\n\t\t\t\tgravatar = null;\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tgravatar = avatarData;\n\t\t\t}\n\t\t});\n\t\tif (gravatar != null) {\n\t\t\tRocketChat.setUserAvatar(user, gravatar.blob, gravatar.contentType, 'gravatar');\n\t\t}\n\t}\n\t// Username is available; if coming from old username, update all references\n\tif (previousUsername) {\n\t\tRocketChat.models.Messages.updateAllUsernamesByUserId(user._id, username);\n\t\tRocketChat.models.Messages.updateUsernameOfEditByUserId(user._id, username);\n\t\tRocketChat.models.Messages.findByMention(previousUsername).forEach(function(msg) {\n\t\t\tconst updatedMsg = msg.msg.replace(new RegExp(`@${ previousUsername }`, 'ig'), `@${ username }`);\n\t\t\treturn RocketChat.models.Messages.updateUsernameAndMessageOfMentionByIdAndOldUsername(msg._id, previousUsername, username, updatedMsg);\n\t\t});\n\t\tRocketChat.models.Rooms.replaceUsername(previousUsername, username);\n\t\tRocketChat.models.Rooms.replaceMutedUsername(previousUsername, username);\n\t\tRocketChat.models.Rooms.replaceUsernameOfUserByUserId(user._id, username);\n\t\tRocketChat.models.Subscriptions.setUserUsernameByUserId(user._id, username);\n\t\tRocketChat.models.Subscriptions.setNameForDirectRoomsWithOldName(previousUsername, username);\n\t\tRocketChat.models.LivechatDepartmentAgents.replaceUsernameOfAgentByUserId(user._id, username);\n\n\t\tconst fileStore = FileUpload.getStore('Avatars');\n\t\tconst file = fileStore.model.findOneByName(previousUsername);\n\t\tif (file) {\n\t\t\tfileStore.model.updateFileNameById(file._id, username);\n\t\t}\n\t}\n\t// Set new username*\n\tRocketChat.models.Users.setUsername(user._id, username);\n\treturn user;\n};\n\nRocketChat.setUsername = RocketChat.RateLimiter.limitFunction(RocketChat._setUsername, 1, 60000, {\n\t[0](userId) {\n\t\treturn !userId || !RocketChat.authz.hasPermission(userId, 'edit-other-user-info');\n\t}\n});\n","import s from 'underscore.string';\n\nRocketChat._setRealName = function(userId, name) {\n\tname = s.trim(name);\n\tif (!userId || !name) {\n\t\treturn false;\n\t}\n\n\tconst user = RocketChat.models.Users.findOneById(userId);\n\n\t// User already has desired name, return\n\tif (user.name === name) {\n\t\treturn user;\n\t}\n\n\t// Set new name\n\tRocketChat.models.Users.setName(user._id, name);\n\tuser.name = name;\n\n\tif (RocketChat.settings.get('UI_Use_Real_Name') === true) {\n\t\tRocketChat.Notifications.notifyLogged('Users:NameChanged', {\n\t\t\t_id: user._id,\n\t\t\tname: user.name,\n\t\t\tusername: user.username\n\t\t});\n\t}\n\n\treturn user;\n};\n\nRocketChat.setRealName = RocketChat.RateLimiter.limitFunction(RocketChat._setRealName, 1, 60000, {\n\t0() { return !Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'edit-other-user-info'); } // Administrators have permission to change others names, so don't limit those\n});\n","import s from 'underscore.string';\n\nRocketChat._setEmail = function(userId, email, shouldSendVerificationEmail = true) {\n\temail = s.trim(email);\n\tif (!userId) {\n\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { function: '_setEmail' });\n\t}\n\n\tif (!email) {\n\t\tthrow new Meteor.Error('error-invalid-email', 'Invalid email', { function: '_setEmail' });\n\t}\n\n\tRocketChat.validateEmailDomain(email);\n\n\tconst user = RocketChat.models.Users.findOneById(userId);\n\n\t// User already has desired username, return\n\tif (user.emails && user.emails[0] && user.emails[0].address === email) {\n\t\treturn user;\n\t}\n\n\t// Check email availability\n\tif (!RocketChat.checkEmailAvailability(email)) {\n\t\tthrow new Meteor.Error('error-field-unavailable', `${ email } is already in use :(`, { function: '_setEmail', field: email });\n\t}\n\n\t// Set new email\n\tRocketChat.models.Users.setEmail(user._id, email);\n\tuser.email = email;\n\tif (shouldSendVerificationEmail === true) {\n\t\tMeteor.call('sendConfirmationEmail', user.email);\n\t}\n\treturn user;\n};\n\nRocketChat.setEmail = RocketChat.RateLimiter.limitFunction(RocketChat._setEmail, 1, 60000, {\n\t0() { return !Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'edit-other-user-info'); } // Administrators have permission to change others emails, so don't limit those\n});\n","RocketChat.unarchiveRoom = function(rid) {\n\tRocketChat.models.Rooms.unarchiveById(rid);\n\tRocketChat.models.Subscriptions.unarchiveByRoomId(rid);\n};\n","RocketChat.updateMessage = function(message, user) {\n\t// If we keep history of edits, insert a new message to store history information\n\tif (RocketChat.settings.get('Message_KeepHistory')) {\n\t\tRocketChat.models.Messages.cloneAndSaveAsHistoryById(message._id);\n\t}\n\n\tmessage.editedAt = new Date();\n\tmessage.editedBy = {\n\t\t_id: user._id,\n\t\tusername: user.username\n\t};\n\n\tconst urls = message.msg.match(/([A-Za-z]{3,9}):\\/\\/([-;:&=\\+\\$,\\w]+@{1})?([-A-Za-z0-9\\.]+)+:?(\\d+)?((\\/[-\\+=!:~%\\/\\.@\\,\\w]*)?\\??([-\\+=&!:;%@\\/\\.\\,\\w]+)?(?:#([^\\s\\)]+))?)?/g) || [];\n\tmessage.urls = urls.map(url => ({ url }));\n\n\tmessage = RocketChat.callbacks.run('beforeSaveMessage', message);\n\n\tconst tempid = message._id;\n\tdelete message._id;\n\n\tRocketChat.models.Messages.update({ _id: tempid }, { $set: message });\n\n\tconst room = RocketChat.models.Rooms.findOneById(message.rid);\n\n\tMeteor.defer(function() {\n\t\tRocketChat.callbacks.run('afterSaveMessage', RocketChat.models.Messages.findOneById(tempid), room, user._id);\n\t});\n};\n","import s from 'underscore.string';\n\nRocketChat.validateCustomFields = function(fields) {\n\t// Special Case:\n\t// If an admin didn't set any custom fields there's nothing to validate against so consider any customFields valid\n\tif (s.trim(RocketChat.settings.get('Accounts_CustomFields')) === '') {\n\t\treturn;\n\t}\n\n\tlet customFieldsMeta;\n\ttry {\n\t\tcustomFieldsMeta = JSON.parse(RocketChat.settings.get('Accounts_CustomFields'));\n\t} catch (e) {\n\t\tthrow new Meteor.Error('error-invalid-customfield-json', 'Invalid JSON for Custom Fields');\n\t}\n\n\tconst customFields = {};\n\n\tObject.keys(customFieldsMeta).forEach((fieldName) => {\n\t\tconst field = customFieldsMeta[fieldName];\n\n\t\tcustomFields[fieldName] = fields[fieldName];\n\t\tconst fieldValue = s.trim(fields[fieldName]);\n\n\t\tif (field.required && fieldValue === '') {\n\t\t\tthrow new Meteor.Error('error-user-registration-custom-field', `Field ${ fieldName } is required`, {method: 'registerUser'});\n\t\t}\n\n\t\tif (field.type === 'select' && field.options.indexOf(fields[fieldName]) === -1) {\n\t\t\tthrow new Meteor.Error('error-user-registration-custom-field', `Value for field ${ fieldName } is invalid`, {method: 'registerUser'});\n\t\t}\n\n\t\tif (field.maxLength && fieldValue.length > field.maxLength) {\n\t\t\tthrow new Meteor.Error('error-user-registration-custom-field', `Max length of field ${ fieldName } ${ field.maxLength }`, {method: 'registerUser'});\n\t\t}\n\n\t\tif (field.minLength && fieldValue.length < field.minLength) {\n\t\t\tthrow new Meteor.Error('error-user-registration-custom-field', `Min length of field ${ fieldName } ${ field.minLength }`, {method: 'registerUser'});\n\t\t}\n\t});\n};\n","RocketChat.Notifications = new class {\n\tconstructor() {\n\t\tthis.debug = false;\n\t\tthis.streamAll = new Meteor.Streamer('notify-all');\n\t\tthis.streamLogged = new Meteor.Streamer('notify-logged');\n\t\tthis.streamRoom = new Meteor.Streamer('notify-room');\n\t\tthis.streamRoomUsers = new Meteor.Streamer('notify-room-users');\n\t\tthis.streamUser = new Meteor.Streamer('notify-user');\n\t\tthis.streamAll.allowWrite('none');\n\t\tthis.streamLogged.allowWrite('none');\n\t\tthis.streamRoom.allowWrite('none');\n\t\tthis.streamRoomUsers.allowWrite(function(eventName, ...args) {\n\t\t\tconst [roomId, e] = eventName.split('/');\n\t\t\t// const user = Meteor.users.findOne(this.userId, {\n\t\t\t// \tfields: {\n\t\t\t// \t\tusername: 1\n\t\t\t// \t}\n\t\t\t// });\n\t\t\tif (RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(roomId, this.userId) != null) {\n\t\t\t\tconst subscriptions = RocketChat.models.Subscriptions.findByRoomIdAndNotUserId(roomId, this.userId).fetch();\n\t\t\t\tsubscriptions.forEach(subscription => RocketChat.Notifications.notifyUser(subscription.u._id, e, ...args));\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t\tthis.streamUser.allowWrite('logged');\n\t\tthis.streamAll.allowRead('all');\n\t\tthis.streamLogged.allowRead('logged');\n\t\tthis.streamRoom.allowRead(function(eventName, extraData) {\n\t\t\tconst [roomId] = eventName.split('/');\n\t\t\tconst user = Meteor.users.findOne(this.userId, {\n\t\t\t\tfields: {\n\t\t\t\t\tusername: 1\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst room = RocketChat.models.Rooms.findOneById(roomId);\n\t\t\tif (!room) {\n\t\t\t\tconsole.warn(`Invalid streamRoom eventName: \"${ eventName }\"`);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (room.t === 'l' && extraData && extraData.token && room.v.token === extraData.token) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (this.userId == null) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn room.usernames.indexOf(user.username) > -1;\n\t\t});\n\t\tthis.streamRoomUsers.allowRead('none');\n\t\tthis.streamUser.allowRead(function(eventName) {\n\t\t\tconst [userId] = eventName.split('/');\n\t\t\treturn (this.userId != null) && this.userId === userId;\n\t\t});\n\t}\n\n\tnotifyAll(eventName, ...args) {\n\t\tif (this.debug === true) {\n\t\t\tconsole.log('notifyAll', arguments);\n\t\t}\n\t\targs.unshift(eventName);\n\t\treturn this.streamAll.emit.apply(this.streamAll, args);\n\t}\n\n\tnotifyLogged(eventName, ...args) {\n\t\tif (this.debug === true) {\n\t\t\tconsole.log('notifyLogged', arguments);\n\t\t}\n\t\targs.unshift(eventName);\n\t\treturn this.streamLogged.emit.apply(this.streamLogged, args);\n\t}\n\n\tnotifyRoom(room, eventName, ...args) {\n\t\tif (this.debug === true) {\n\t\t\tconsole.log('notifyRoom', arguments);\n\t\t}\n\t\targs.unshift(`${ room }/${ eventName }`);\n\t\treturn this.streamRoom.emit.apply(this.streamRoom, args);\n\t}\n\n\tnotifyUser(userId, eventName, ...args) {\n\t\tif (this.debug === true) {\n\t\t\tconsole.log('notifyUser', arguments);\n\t\t}\n\t\targs.unshift(`${ userId }/${ eventName }`);\n\t\treturn this.streamUser.emit.apply(this.streamUser, args);\n\t}\n\n\tnotifyAllInThisInstance(eventName, ...args) {\n\t\tif (this.debug === true) {\n\t\t\tconsole.log('notifyAll', arguments);\n\t\t}\n\t\targs.unshift(eventName);\n\t\treturn this.streamAll.emitWithoutBroadcast.apply(this.streamAll, args);\n\t}\n\n\tnotifyLoggedInThisInstance(eventName, ...args) {\n\t\tif (this.debug === true) {\n\t\t\tconsole.log('notifyLogged', arguments);\n\t\t}\n\t\targs.unshift(eventName);\n\t\treturn this.streamLogged.emitWithoutBroadcast.apply(this.streamLogged, args);\n\t}\n\n\tnotifyRoomInThisInstance(room, eventName, ...args) {\n\t\tif (this.debug === true) {\n\t\t\tconsole.log('notifyRoomAndBroadcast', arguments);\n\t\t}\n\t\targs.unshift(`${ room }/${ eventName }`);\n\t\treturn this.streamRoom.emitWithoutBroadcast.apply(this.streamRoom, args);\n\t}\n\n\tnotifyUserInThisInstance(userId, eventName, ...args) {\n\t\tif (this.debug === true) {\n\t\t\tconsole.log('notifyUserAndBroadcast', arguments);\n\t\t}\n\t\targs.unshift(`${ userId }/${ eventName }`);\n\t\treturn this.streamUser.emitWithoutBroadcast.apply(this.streamUser, args);\n\t}\n};\n\nRocketChat.Notifications.streamRoom.allowWrite(function(eventName, username, typing, extraData) {\n\tconst [roomId, e] = eventName.split('/');\n\tif (e === 'webrtc') {\n\t\treturn true;\n\t}\n\tif (e === 'typing') {\n\n\t\t// typing from livechat widget\n\t\tif (extraData && extraData.token) {\n\t\t\tconst room = RocketChat.models.Rooms.findOneById(roomId);\n\t\t\tif (room && room.t === 'l' && room.v.token === extraData.token) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tconst user = Meteor.users.findOne(this.userId, {\n\t\t\tfields: {\n\t\t\t\tusername: 1\n\t\t\t}\n\t\t});\n\t\tif (user != null && user.username === username) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n});\n","export function shouldNotifyAudio({\n\tdisableAllMessageNotifications,\n\tstatus,\n\taudioNotifications,\n\thasMentionToAll,\n\thasMentionToHere,\n\tisHighlighted,\n\thasMentionToUser,\n\troomType\n}) {\n\tif (disableAllMessageNotifications && audioNotifications == null) {\n\t\treturn false;\n\t}\n\n\tif (status === 'busy' || audioNotifications === 'nothing') {\n\t\treturn false;\n\t}\n\n\tif (!audioNotifications && RocketChat.settings.get('Accounts_Default_User_Preferences_audioNotifications') === 'all') {\n\t\treturn true;\n\t}\n\n\treturn roomType === 'd' || (!disableAllMessageNotifications && (hasMentionToAll || hasMentionToHere)) || isHighlighted || audioNotifications === 'all' || hasMentionToUser;\n}\n\nexport function notifyAudioUser(userId, message, room) {\n\tRocketChat.metrics.notificationsSent.inc({ notification_type: 'audio' });\n\tRocketChat.Notifications.notifyUser(userId, 'audioNotification', {\n\t\tpayload: {\n\t\t\t_id: message._id,\n\t\t\trid: message.rid,\n\t\t\tsender: message.u,\n\t\t\ttype: room.t,\n\t\t\tname: room.name\n\t\t}\n\t});\n}\n","/**\n * Send notification to user\n *\n * @param {string} userId The user to notify\n * @param {object} user The sender\n * @param {object} room The room send from\n * @param {object} message The message object\n * @param {number} duration Duration of notification\n * @param {string} notificationMessage The message text to send on notification body\n */\nexport function notifyDesktopUser({\n\tuserId,\n\tuser,\n\tmessage,\n\troom,\n\tduration,\n\tnotificationMessage\n}) {\n\tconst UI_Use_Real_Name = RocketChat.settings.get('UI_Use_Real_Name') === true;\n\n\tlet title = '';\n\tlet text = '';\n\tif (room.t === 'd') {\n\t\ttitle = UI_Use_Real_Name ? user.name : `@${ user.username }`;\n\t\ttext = notificationMessage;\n\t} else if (room.name) {\n\t\ttitle = `#${ room.name }`;\n\t\ttext = `${ UI_Use_Real_Name ? user.name : user.username }: ${ notificationMessage }`;\n\t} else {\n\t\treturn;\n\t}\n\n\tRocketChat.metrics.notificationsSent.inc({ notification_type: 'desktop' });\n\tRocketChat.Notifications.notifyUser(userId, 'notification', {\n\t\ttitle,\n\t\ttext,\n\t\tduration,\n\t\tpayload: {\n\t\t\t_id: message._id,\n\t\t\trid: message.rid,\n\t\t\tsender: message.u,\n\t\t\ttype: room.t,\n\t\t\tname: room.name\n\t\t}\n\t});\n}\n\nexport function shouldNotifyDesktop({\n\tdisableAllMessageNotifications,\n\tstatus,\n\tdesktopNotifications,\n\thasMentionToAll,\n\thasMentionToHere,\n\tisHighlighted,\n\thasMentionToUser,\n\troomType\n}) {\n\tif (disableAllMessageNotifications && desktopNotifications == null) {\n\t\treturn false;\n\t}\n\n\tif (status === 'busy' || desktopNotifications === 'nothing') {\n\t\treturn false;\n\t}\n\n\tif (!desktopNotifications) {\n\t\tif (RocketChat.settings.get('Accounts_Default_User_Preferences_desktopNotifications') === 'all') {\n\t\t\treturn true;\n\t\t}\n\t\tif (RocketChat.settings.get('Accounts_Default_User_Preferences_desktopNotifications') === 'nothing') {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn roomType === 'd' || (!disableAllMessageNotifications && (hasMentionToAll || hasMentionToHere)) || isHighlighted || desktopNotifications === 'all' || hasMentionToUser;\n}\n","import s from 'underscore.string';\n\nlet contentHeader;\nRocketChat.settings.get('Email_Header', (key, value) => {\n\tcontentHeader = RocketChat.placeholders.replace(value || '');\n});\n\nlet contentFooter;\nRocketChat.settings.get('Email_Footer', (key, value) => {\n\tcontentFooter = RocketChat.placeholders.replace(value || '');\n});\n\nconst divisorMessage = '<hr style=\"margin: 20px auto; border: none; border-bottom: 1px solid #dddddd;\">';\n\nfunction getEmailContent({ message, user, room }) {\n\tconst lng = user && user.language || RocketChat.settings.get('language') || 'en';\n\n\tconst roomName = s.escapeHTML(`#${ RocketChat.roomTypes.getRoomName(room.t, room) }`);\n\tconst userName = s.escapeHTML(RocketChat.settings.get('UI_Use_Real_Name') ? message.u.name || message.u.username : message.u.username);\n\n\tconst header = TAPi18n.__(room.t === 'd' ? 'User_sent_a_message_to_you' : 'User_sent_a_message_on_channel', {\n\t\tusername: userName,\n\t\tchannel: roomName,\n\t\tlng\n\t});\n\n\tif (message.msg !== '') {\n\t\tlet messageContent = s.escapeHTML(message.msg);\n\t\tmessage = RocketChat.callbacks.run('renderMessage', message);\n\t\tif (message.tokens && message.tokens.length > 0) {\n\t\t\tmessage.tokens.forEach((token) => {\n\t\t\t\ttoken.text = token.text.replace(/([^\\$])(\\$[^\\$])/gm, '$1$$$2');\n\t\t\t\tmessageContent = messageContent.replace(token.token, token.text);\n\t\t\t});\n\t\t}\n\t\treturn `${ header }<br/><br/>${ messageContent.replace(/\\n/gm, '<br/>') }`;\n\t}\n\n\tif (message.file) {\n\t\tconst fileHeader = TAPi18n.__(room.t === 'd' ? 'User_uploaded_a_file_to_you' : 'User_uploaded_a_file_on_channel', {\n\t\t\tusername: userName,\n\t\t\tchannel: roomName,\n\t\t\tlng\n\t\t});\n\n\t\tlet content = `${ TAPi18n.__('Attachment_File_Uploaded') }: ${ s.escapeHTML(message.file.name) }`;\n\n\t\tif (message.attachments && message.attachments.length === 1 && message.attachments[0].description !== '') {\n\t\t\tcontent += `<br/><br/>${ s.escapeHTML(message.attachments[0].description) }`;\n\t\t}\n\n\t\treturn `${ fileHeader }<br/><br/>${ content }`;\n\t}\n\n\tif (message.attachments.length > 0) {\n\t\tconst [ attachment ] = message.attachments;\n\n\t\tlet content = '';\n\n\t\tif (attachment.title) {\n\t\t\tcontent += `${ s.escapeHTML(attachment.title) }<br/>`;\n\t\t}\n\t\tif (attachment.text) {\n\t\t\tcontent += `${ s.escapeHTML(attachment.text) }<br/>`;\n\t\t}\n\n\t\treturn `${ header }<br/><br/>${ content }`;\n\t}\n\n\treturn header;\n}\n\nfunction getMessageLink(room, sub) {\n\tconst roomPath = RocketChat.roomTypes.getRouteLink(room.t, sub);\n\tconst path = Meteor.absoluteUrl(roomPath ? roomPath.replace(/^\\//, '') : '');\n\tconst style = [\n\t\t'color: #fff;',\n\t\t'padding: 9px 12px;',\n\t\t'border-radius: 4px;',\n\t\t'background-color: #04436a;',\n\t\t'text-decoration: none;'\n\t].join(' ');\n\tconst message = TAPi18n.__('Offline_Link_Message');\n\treturn `<p style=\"text-align:center;margin-bottom:8px;\"><a style=\"${ style }\" href=\"${ path }\">${ message }</a>`;\n}\n\nexport function sendEmail({ message, user, subscription, room, emailAddress, toAll }) {\n\tlet emailSubject;\n\tconst username = RocketChat.settings.get('UI_Use_Real_Name') ? message.u.name : message.u.username;\n\n\tif (room.t === 'd') {\n\t\temailSubject = RocketChat.placeholders.replace(RocketChat.settings.get('Offline_DM_Email'), {\n\t\t\tuser: username,\n\t\t\troom: RocketChat.roomTypes.getRoomName(room.t, room)\n\t\t});\n\t} else if (toAll) {\n\t\temailSubject = RocketChat.placeholders.replace(RocketChat.settings.get('Offline_Mention_All_Email'), {\n\t\t\tuser: username,\n\t\t\troom: RocketChat.roomTypes.getRoomName(room.t, room)\n\t\t});\n\t} else {\n\t\temailSubject = RocketChat.placeholders.replace(RocketChat.settings.get('Offline_Mention_Email'), {\n\t\t\tuser: username,\n\t\t\troom: RocketChat.roomTypes.getRoomName(room.t, room)\n\t\t});\n\t}\n\tconst content = getEmailContent({\n\t\tmessage,\n\t\tuser,\n\t\troom\n\t});\n\n\tconst link = getMessageLink(room, subscription);\n\n\tif (RocketChat.settings.get('Direct_Reply_Enable')) {\n\t\tcontentFooter = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Footer_Direct_Reply') || '');\n\t}\n\n\tconst email = {\n\t\tto: emailAddress,\n\t\tsubject: emailSubject,\n\t\thtml: contentHeader + content + divisorMessage + link + contentFooter\n\t};\n\n\t// using user full-name/channel name in from address\n\tif (room.t === 'd') {\n\t\temail.from = `${ String(message.u.name).replace(/@/g, '%40').replace(/[<>,]/g, '') } <${ RocketChat.settings.get('From_Email') }>`;\n\t} else {\n\t\temail.from = `${ String(room.name).replace(/@/g, '%40').replace(/[<>,]/g, '') } <${ RocketChat.settings.get('From_Email') }>`;\n\t}\n\t// If direct reply enabled, email content with headers\n\tif (RocketChat.settings.get('Direct_Reply_Enable')) {\n\t\tconst replyto = RocketChat.settings.get('Direct_Reply_ReplyTo') ? RocketChat.settings.get('Direct_Reply_ReplyTo') : RocketChat.settings.get('Direct_Reply_Username');\n\t\temail.headers = {\n\t\t\t// Reply-To header with format \"username+messageId@domain\"\n\t\t\t'Reply-To': `${ replyto.split('@')[0].split(RocketChat.settings.get('Direct_Reply_Separator'))[0] }${ RocketChat.settings.get('Direct_Reply_Separator') }${ message._id }@${ replyto.split('@')[1] }`\n\t\t};\n\t}\n\n\tMeteor.defer(() => {\n\t\tRocketChat.metrics.notificationsSent.inc({ notification_type: 'email' });\n\t\tEmail.send(email);\n\t});\n}\n\nexport function shouldNotifyEmail({\n\tdisableAllMessageNotifications,\n\tstatusConnection,\n\temailNotifications,\n\tisHighlighted,\n\thasMentionToUser,\n\thasMentionToAll,\n\troomType\n}) {\n\n\t// use connected (don't need to send him an email)\n\tif (statusConnection === 'online') {\n\t\treturn false;\n\t}\n\n\t// user/room preference to nothing\n\tif (emailNotifications === 'nothing') {\n\t\treturn false;\n\t}\n\n\t// no user or room preference\n\tif (emailNotifications == null) {\n\t\tif (disableAllMessageNotifications) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// default server preference is disabled\n\t\tif (RocketChat.settings.get('Accounts_Default_User_Preferences_emailNotificationMode') === 'nothing') {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn roomType === 'd' || isHighlighted || emailNotifications === 'all' || hasMentionToUser || (!disableAllMessageNotifications && hasMentionToAll);\n}\n","import s from 'underscore.string';\n\n/**\n* This function returns a string ready to be shown in the notification\n*\n* @param {object} message the message to be parsed\n*/\nexport function parseMessageTextPerUser(messageText, message, receiver) {\n\tif (!message.msg && message.attachments && message.attachments[0]) {\n\t\tconst lng = receiver.language || RocketChat.settings.get('language') || 'en';\n\n\t\treturn message.attachments[0].image_type ? TAPi18n.__('User_uploaded_image', {lng}) : TAPi18n.__('User_uploaded_file', {lng});\n\t}\n\n\treturn messageText;\n}\n\n/**\n * Replaces @username with full name\n *\n * @param {string} message The message to replace\n * @param {object[]} mentions Array of mentions used to make replacements\n *\n * @returns {string}\n */\nexport function replaceMentionedUsernamesWithFullNames(message, mentions) {\n\tif (!mentions || !mentions.length) {\n\t\treturn message;\n\t}\n\tmentions.forEach((mention) => {\n\t\tif (mention.name) {\n\t\t\tmessage = message.replace(new RegExp(s.escapeRegExp(`@${ mention.username }`), 'g'), mention.name);\n\t\t}\n\t});\n\treturn message;\n}\n\n/**\n * Checks if a message contains a user highlight\n *\n * @param {string} message\n * @param {array|undefined} highlights\n *\n * @returns {boolean}\n */\nexport function messageContainsHighlight(message, highlights) {\n\tif (! highlights || highlights.length === 0) { return false; }\n\n\treturn highlights.some(function(highlight) {\n\t\tconst regexp = new RegExp(s.escapeRegExp(highlight), 'i');\n\t\treturn regexp.test(message.msg);\n\t});\n}\n\nexport function callJoinRoom(user, rid) {\n\treturn new Promise((resolve, reject) => {\n\t\tMeteor.runAsUser(user._id, () => Meteor.call('joinRoom', rid, (error, result) => {\n\t\t\tif (error) {\n\t\t\t\treturn reject(error);\n\t\t\t}\n\t\t\treturn resolve(result);\n\t\t}));\n\t});\n}\n","const CATEGORY_MESSAGE = 'MESSAGE';\nconst CATEGORY_MESSAGE_NOREPLY = 'MESSAGE_NOREPLY';\n\nlet alwaysNotifyMobileBoolean;\nRocketChat.settings.get('Notifications_Always_Notify_Mobile', (key, value) => {\n\talwaysNotifyMobileBoolean = value;\n});\n\nlet SubscriptionRaw;\nMeteor.startup(() => {\n\tSubscriptionRaw = RocketChat.models.Subscriptions.model.rawCollection();\n});\n\nasync function getBadgeCount(userId) {\n\tconst [ result ] = await SubscriptionRaw.aggregate([\n\t\t{ $match: { 'u._id': userId } },\n\t\t{\n\t\t\t$group: {\n\t\t\t\t_id: 'total',\n\t\t\t\ttotal: { $sum: '$unread' }\n\t\t\t}\n\t\t}\n\t]).toArray();\n\n\tconst { total } = result;\n\treturn total;\n}\n\nfunction canSendMessageToRoom(room, username) {\n\treturn !((room.muted || []).includes(username));\n}\n\nexport async function sendSinglePush({ room, message, userId, receiverUsername, senderUsername, senderName, notificationMessage }) {\n\tlet username = '';\n\tif (RocketChat.settings.get('Push_show_username_room')) {\n\t\tusername = RocketChat.settings.get('UI_Use_Real_Name') === true ? senderName : senderUsername;\n\t}\n\n\tRocketChat.PushNotification.send({\n\t\troomId: message.rid,\n\t\tpayload: {\n\t\t\thost: Meteor.absoluteUrl(),\n\t\t\trid: message.rid,\n\t\t\tsender: message.u,\n\t\t\ttype: room.t,\n\t\t\tname: room.name\n\t\t},\n\t\troomName: RocketChat.settings.get('Push_show_username_room') && room.t !== 'd' ? `#${ RocketChat.roomTypes.getRoomName(room.t, room) }` : '',\n\t\tusername,\n\t\tmessage: RocketChat.settings.get('Push_show_message') ? notificationMessage : ' ',\n\t\tbadge: await getBadgeCount(userId),\n\t\tusersTo: {\n\t\t\tuserId\n\t\t},\n\t\tcategory: canSendMessageToRoom(room, receiverUsername) ? CATEGORY_MESSAGE : CATEGORY_MESSAGE_NOREPLY\n\t});\n}\n\nexport function shouldNotifyMobile({\n\tdisableAllMessageNotifications,\n\tmobilePushNotifications,\n\thasMentionToAll,\n\tisHighlighted,\n\thasMentionToUser,\n\tstatusConnection,\n\troomType\n}) {\n\tif (disableAllMessageNotifications && mobilePushNotifications == null) {\n\t\treturn false;\n\t}\n\n\tif (mobilePushNotifications === 'nothing') {\n\t\treturn false;\n\t}\n\n\tif (!alwaysNotifyMobileBoolean && statusConnection === 'online') {\n\t\treturn false;\n\t}\n\n\tif (!mobilePushNotifications) {\n\t\tif (RocketChat.settings.get('Accounts_Default_User_Preferences_mobileNotifications') === 'all') {\n\t\t\treturn true;\n\t\t}\n\t\tif (RocketChat.settings.get('Accounts_Default_User_Preferences_mobileNotifications') === 'nothing') {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn roomType === 'd' || (!disableAllMessageNotifications && hasMentionToAll) || isHighlighted || mobilePushNotifications === 'all' || hasMentionToUser;\n}\n","import ModelsBaseDb from './_BaseDb';\nimport ModelsBaseCache from './_BaseCache';\n\nRocketChat.models._CacheControl = new Meteor.EnvironmentVariable();\n\nclass ModelsBase {\n\tconstructor(nameOrModel, useCache) {\n\t\tthis._db = new ModelsBaseDb(nameOrModel, this);\n\t\tthis.model = this._db.model;\n\t\tthis.collectionName = this._db.collectionName;\n\t\tthis.name = this._db.name;\n\n\t\tthis._useCache = useCache === true;\n\n\t\tthis.cache = new ModelsBaseCache(this);\n\t\t// TODO_CACHE: remove\n\t\tthis.on = this.cache.on.bind(this.cache);\n\t\tthis.emit = this.cache.emit.bind(this.cache);\n\t\tthis.getDynamicView = this.cache.getDynamicView.bind(this.cache);\n\t\tthis.processQueryOptionsOnResult = this.cache.processQueryOptionsOnResult.bind(this.cache);\n\t\t// END_TODO_CACHE\n\n\t\tthis.db = this;\n\n\t\tif (this._useCache) {\n\t\t\tthis.db = new this.constructor(this.model, false);\n\t\t}\n\t}\n\n\tget useCache() {\n\t\tif (RocketChat.models._CacheControl.get() === false) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this._useCache;\n\t}\n\n\tget origin() {\n\t\treturn this.useCache === true ? 'cache' : '_db';\n\t}\n\n\tarrayToCursor(data) {\n\t\treturn {\n\t\t\tfetch() {\n\t\t\t\treturn data;\n\t\t\t},\n\t\t\tcount() {\n\t\t\t\treturn data.length;\n\t\t\t},\n\t\t\tforEach(fn) {\n\t\t\t\treturn data.forEach(fn);\n\t\t\t}\n\t\t};\n\t}\n\n\tsetUpdatedAt(/*record, checkQuery, query*/) {\n\t\treturn this._db.setUpdatedAt(...arguments);\n\t}\n\n\tfind() {\n\t\ttry {\n\t\t\treturn this[this.origin].find(...arguments);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on find', e, ...arguments);\n\t\t}\n\t}\n\n\tfindOne() {\n\t\ttry {\n\t\t\treturn this[this.origin].findOne(...arguments);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on find', e, ...arguments);\n\t\t}\n\t}\n\n\tfindOneById() {\n\t\ttry {\n\t\t\treturn this[this.origin].findOneById(...arguments);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on find', e, ...arguments);\n\t\t}\n\t}\n\n\tfindOneByIds(ids, options) {\n\t\tcheck(ids, [String]);\n\n\t\ttry {\n\t\t\treturn this[this.origin].findOneByIds(ids, options);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on find', e, ...arguments);\n\t\t}\n\t}\n\n\tinsert(/*record*/) {\n\t\treturn this._db.insert(...arguments);\n\t}\n\n\tupdate(/*query, update, options*/) {\n\t\treturn this._db.update(...arguments);\n\t}\n\n\tupsert(/*query, update*/) {\n\t\treturn this._db.upsert(...arguments);\n\t}\n\n\tremove(/*query*/) {\n\t\treturn this._db.remove(...arguments);\n\t}\n\n\tinsertOrUpsert() {\n\t\treturn this._db.insertOrUpsert(...arguments);\n\t}\n\n\tallow() {\n\t\treturn this._db.allow(...arguments);\n\t}\n\n\tdeny() {\n\t\treturn this._db.deny(...arguments);\n\t}\n\n\tensureIndex() {\n\t\treturn this._db.ensureIndex(...arguments);\n\t}\n\n\tdropIndex() {\n\t\treturn this._db.dropIndex(...arguments);\n\t}\n\n\ttryEnsureIndex() {\n\t\treturn this._db.tryEnsureIndex(...arguments);\n\t}\n\n\ttryDropIndex() {\n\t\treturn this._db.tryDropIndex(...arguments);\n\t}\n\n\ttrashFind(/*query, options*/) {\n\t\treturn this._db.trashFind(...arguments);\n\t}\n\n\ttrashFindDeletedAfter(/*deletedAt, query, options*/) {\n\t\treturn this._db.trashFindDeletedAfter(...arguments);\n\t}\n\n\t// dinamicTrashFindAfter(method, deletedAt, ...args) {\n\t// \tconst scope = {\n\t// \t\tfind: (query={}) => {\n\t// \t\t\treturn this.trashFindDeletedAfter(deletedAt, query, { fields: {_id: 1, _deletedAt: 1} });\n\t// \t\t}\n\t// \t};\n\n\t// \tscope.model = {\n\t// \t\tfind: scope.find\n\t// \t};\n\n\t// \treturn this[method].apply(scope, args);\n\t// }\n\n\t// dinamicFindAfter(method, updatedAt, ...args) {\n\t// \tconst scope = {\n\t// \t\tfind: (query={}, options) => {\n\t// \t\t\tquery._updatedAt = {\n\t// \t\t\t\t$gt: updatedAt\n\t// \t\t\t};\n\n\t// \t\t\treturn this.find(query, options);\n\t// \t\t}\n\t// \t};\n\n\t// \tscope.model = {\n\t// \t\tfind: scope.find\n\t// \t};\n\n\t// \treturn this[method].apply(scope, args);\n\t// }\n\n\t// dinamicFindChangesAfter(method, updatedAt, ...args) {\n\t// \treturn {\n\t// \t\tupdate: this.dinamicFindAfter(method, updatedAt, ...args).fetch(),\n\t// \t\tremove: this.dinamicTrashFindAfter(method, updatedAt, ...args).fetch()\n\t// \t};\n\t// }\n\n}\n\nRocketChat.models._Base = ModelsBase;\n","/* globals InstanceStatus */\nimport _ from 'underscore';\nimport s from 'underscore.string';\n\nRocketChat.models.Avatars = new class extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper('avatars');\n\n\t\tthis.model.before.insert((userId, doc) => {\n\t\t\tdoc.instanceId = InstanceStatus.id();\n\t\t});\n\n\t\tthis.tryEnsureIndex({ name: 1 });\n\t}\n\n\tinsertAvatarFileInit(name, userId, store, file, extra) {\n\t\tconst fileData = {\n\t\t\t_id: name,\n\t\t\tname,\n\t\t\tuserId,\n\t\t\tstore,\n\t\t\tcomplete: false,\n\t\t\tuploading: true,\n\t\t\tprogress: 0,\n\t\t\textension: s.strRightBack(file.name, '.'),\n\t\t\tuploadedAt: new Date()\n\t\t};\n\n\t\t_.extend(fileData, file, extra);\n\n\t\treturn this.insertOrUpsert(fileData);\n\t}\n\n\tupdateFileComplete(fileId, userId, file) {\n\t\tif (!fileId) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst filter = {\n\t\t\t_id: fileId,\n\t\t\tuserId\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tcomplete: true,\n\t\t\t\tuploading: false,\n\t\t\t\tprogress: 1\n\t\t\t}\n\t\t};\n\n\t\tupdate.$set = _.extend(file, update.$set);\n\n\t\tif (this.model.direct && this.model.direct.update) {\n\t\t\treturn this.model.direct.update(filter, update);\n\t\t} else {\n\t\t\treturn this.update(filter, update);\n\t\t}\n\t}\n\n\tfindOneByName(name) {\n\t\treturn this.findOne({ name });\n\t}\n\n\tupdateFileNameById(fileId, name) {\n\t\tconst filter = { _id: fileId };\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tname\n\t\t\t}\n\t\t};\n\t\tif (this.model.direct && this.model.direct.update) {\n\t\t\treturn this.model.direct.update(filter, update);\n\t\t} else {\n\t\t\treturn this.update(filter, update);\n\t\t}\n\t}\n\n\t// @TODO deprecated\n\tupdateFileCompleteByNameAndUserId(name, userId, url) {\n\t\tif (!name) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst filter = {\n\t\t\tname,\n\t\t\tuserId\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tcomplete: true,\n\t\t\t\tuploading: false,\n\t\t\t\tprogress: 1,\n\t\t\t\turl\n\t\t\t}\n\t\t};\n\n\t\tif (this.model.direct && this.model.direct.update) {\n\t\t\treturn this.model.direct.update(filter, update);\n\t\t} else {\n\t\t\treturn this.update(filter, update);\n\t\t}\n\t}\n\n\tdeleteFile(fileId) {\n\t\tif (this.model.direct && this.model.direct.remove) {\n\t\t\treturn this.model.direct.remove({ _id: fileId });\n\t\t} else {\n\t\t\treturn this.remove({ _id: fileId });\n\t\t}\n\t}\n};\n","import _ from 'underscore';\n\nRocketChat.models.Messages = new class extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper('message');\n\n\t\tthis.tryEnsureIndex({ 'rid': 1, 'ts': 1 });\n\t\tthis.tryEnsureIndex({ 'ts': 1 });\n\t\tthis.tryEnsureIndex({ 'u._id': 1 });\n\t\tthis.tryEnsureIndex({ 'editedAt': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'editedBy._id': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'rid': 1, 't': 1, 'u._id': 1 });\n\t\tthis.tryEnsureIndex({ 'expireAt': 1 }, { expireAfterSeconds: 0 });\n\t\tthis.tryEnsureIndex({ 'msg': 'text' });\n\t\tthis.tryEnsureIndex({ 'file._id': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'mentions.username': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'pinned': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'snippeted': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'location': '2dsphere' });\n\t\tthis.tryEnsureIndex({ 'slackBotId': 1, 'slackTs': 1 }, { sparse: 1 });\n\t}\n\n\tcountVisibleByRoomIdBetweenTimestampsInclusive(roomId, afterTimestamp, beforeTimestamp, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true\n\t\t\t},\n\t\t\trid: roomId,\n\t\t\tts: {\n\t\t\t\t$gte: afterTimestamp,\n\t\t\t\t$lte: beforeTimestamp\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options).count();\n\t}\n\n\t// FIND\n\tfindByMention(username, options) {\n\t\tconst query =\t{'mentions.username': username};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByMentionAndRoomId(username, rid, options) {\n\t\tconst query = {\n\t\t\t_hidden: { $ne: true },\n\t\t\t'mentions.username': username,\n\t\t\trid\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByRoomId(roomId, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true\n\t\t\t},\n\n\t\t\trid: roomId\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByRoomIdNotContainingTypes(roomId, types, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true\n\t\t\t},\n\n\t\t\trid: roomId\n\t\t};\n\n\t\tif (Match.test(types, [String]) && (types.length > 0)) {\n\t\t\tquery.t =\n\t\t\t{$nin: types};\n\t\t}\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindInvisibleByRoomId(roomId, options) {\n\t\tconst query = {\n\t\t\t_hidden: true,\n\t\t\trid: roomId\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByRoomIdAfterTimestamp(roomId, timestamp, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true\n\t\t\t},\n\t\t\trid: roomId,\n\t\t\tts: {\n\t\t\t\t$gt: timestamp\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindForUpdates(roomId, timestamp, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true\n\t\t\t},\n\t\t\trid: roomId,\n\t\t\t_updatedAt: {\n\t\t\t\t$gt: timestamp\n\t\t\t}\n\t\t};\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByRoomIdBeforeTimestamp(roomId, timestamp, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true\n\t\t\t},\n\t\t\trid: roomId,\n\t\t\tts: {\n\t\t\t\t$lt: timestamp\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByRoomIdBeforeTimestampInclusive(roomId, timestamp, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true\n\t\t\t},\n\t\t\trid: roomId,\n\t\t\tts: {\n\t\t\t\t$lte: timestamp\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByRoomIdBetweenTimestamps(roomId, afterTimestamp, beforeTimestamp, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true\n\t\t\t},\n\t\t\trid: roomId,\n\t\t\tts: {\n\t\t\t\t$gt: afterTimestamp,\n\t\t\t\t$lt: beforeTimestamp\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByRoomIdBetweenTimestampsInclusive(roomId, afterTimestamp, beforeTimestamp, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true\n\t\t\t},\n\t\t\trid: roomId,\n\t\t\tts: {\n\t\t\t\t$gte: afterTimestamp,\n\t\t\t\t$lte: beforeTimestamp\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByRoomIdBeforeTimestampNotContainingTypes(roomId, timestamp, types, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true\n\t\t\t},\n\t\t\trid: roomId,\n\t\t\tts: {\n\t\t\t\t$lt: timestamp\n\t\t\t}\n\t\t};\n\n\t\tif (Match.test(types, [String]) && (types.length > 0)) {\n\t\t\tquery.t =\n\t\t\t{$nin: types};\n\t\t}\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByRoomIdBetweenTimestampsNotContainingTypes(roomId, afterTimestamp, beforeTimestamp, types, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true\n\t\t\t},\n\t\t\trid: roomId,\n\t\t\tts: {\n\t\t\t\t$gt: afterTimestamp,\n\t\t\t\t$lt: beforeTimestamp\n\t\t\t}\n\t\t};\n\n\t\tif (Match.test(types, [String]) && (types.length > 0)) {\n\t\t\tquery.t =\n\t\t\t{$nin: types};\n\t\t}\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleCreatedOrEditedAfterTimestamp(timestamp, options) {\n\t\tconst query = {\n\t\t\t_hidden: { $ne: true },\n\t\t\t$or: [{\n\t\t\t\tts: {\n\t\t\t\t\t$gt: timestamp\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t'editedAt': {\n\t\t\t\t\t$gt: timestamp\n\t\t\t\t}\n\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindStarredByUserAtRoom(userId, roomId, options) {\n\t\tconst query = {\n\t\t\t_hidden: { $ne: true },\n\t\t\t'starred._id': userId,\n\t\t\trid: roomId\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindPinnedByRoom(roomId, options) {\n\t\tconst query = {\n\t\t\tt: { $ne: 'rm' },\n\t\t\t_hidden: { $ne: true },\n\t\t\tpinned: true,\n\t\t\trid: roomId\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindSnippetedByRoom(roomId, options) {\n\t\tconst query = {\n\t\t\t_hidden: { $ne: true },\n\t\t\tsnippeted: true,\n\t\t\trid: roomId\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tgetLastTimestamp(options) {\n\t\tif (options == null) { options = {}; }\n\t\tconst query = { ts: { $exists: 1 } };\n\t\toptions.sort = { ts: -1 };\n\t\toptions.limit = 1;\n\t\tconst [message] = this.find(query, options).fetch();\n\t\treturn message && message.ts;\n\t}\n\n\tfindByRoomIdAndMessageIds(rid, messageIds, options) {\n\t\tconst query = {\n\t\t\trid,\n\t\t\t_id: {\n\t\t\t\t$in: messageIds\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindOneBySlackBotIdAndSlackTs(slackBotId, slackTs) {\n\t\tconst query = {\n\t\t\tslackBotId,\n\t\t\tslackTs\n\t\t};\n\n\t\treturn this.findOne(query);\n\t}\n\n\tfindOneBySlackTs(slackTs) {\n\t\tconst query = {slackTs};\n\n\t\treturn this.findOne(query);\n\t}\n\n\tfindByRoomIdAndType(roomId, type, options) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\tt: type\n\t\t};\n\n\t\tif (options == null) { options = {}; }\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByRoomId(roomId, options) {\n\t\tconst query = {\n\t\t\trid: roomId\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tgetLastVisibleMessageSentWithNoTypeByRoomId(rid, messageId) {\n\t\tconst query = {\n\t\t\trid,\n\t\t\t_hidden: { $ne: true },\n\t\t\tt: { $exists: false }\n\t\t};\n\n\t\tif (messageId) {\n\t\t\tquery._id = { $ne: messageId };\n\t\t}\n\n\t\tconst options = {\n\t\t\tsort: {\n\t\t\t\tts: -1\n\t\t\t}\n\t\t};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tcloneAndSaveAsHistoryById(_id) {\n\t\tconst me = RocketChat.models.Users.findOneById(Meteor.userId());\n\t\tconst record = this.findOneById(_id);\n\t\trecord._hidden = true;\n\t\trecord.parent = record._id;\n\t\trecord.editedAt = new Date;\n\t\trecord.editedBy = {\n\t\t\t_id: Meteor.userId(),\n\t\t\tusername: me.username\n\t\t};\n\t\tdelete record._id;\n\t\treturn this.insert(record);\n\t}\n\n\t// UPDATE\n\tsetHiddenById(_id, hidden) {\n\t\tif (hidden == null) { hidden = true; }\n\t\tconst query =\t{_id};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t_hidden: hidden\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetAsDeletedByIdAndUser(_id, user) {\n\t\tconst query =\t{_id};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tmsg: '',\n\t\t\t\tt: 'rm',\n\t\t\t\turls: [],\n\t\t\t\tmentions: [],\n\t\t\t\tattachments: [],\n\t\t\t\treactions: [],\n\t\t\t\teditedAt: new Date(),\n\t\t\t\teditedBy: {\n\t\t\t\t\t_id: user._id,\n\t\t\t\t\tusername: user.username\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetPinnedByIdAndUserId(_id, pinnedBy, pinned, pinnedAt) {\n\t\tif (pinned == null) { pinned = true; }\n\t\tif (pinnedAt == null) { pinnedAt = 0; }\n\t\tconst query =\t{_id};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tpinned,\n\t\t\t\tpinnedAt: pinnedAt || new Date,\n\t\t\t\tpinnedBy\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetSnippetedByIdAndUserId(message, snippetName, snippetedBy, snippeted, snippetedAt) {\n\t\tif (snippeted == null) { snippeted = true; }\n\t\tif (snippetedAt == null) { snippetedAt = 0; }\n\t\tconst query =\t{_id: message._id};\n\n\t\tconst msg = `\\`\\`\\`${ message.msg }\\`\\`\\``;\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tmsg,\n\t\t\t\tsnippeted,\n\t\t\t\tsnippetedAt: snippetedAt || new Date,\n\t\t\t\tsnippetedBy,\n\t\t\t\tsnippetName\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetUrlsById(_id, urls) {\n\t\tconst query =\t{_id};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\turls\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tupdateAllUsernamesByUserId(userId, username) {\n\t\tconst query =\t{'u._id': userId};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'u.username': username\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tupdateUsernameOfEditByUserId(userId, username) {\n\t\tconst query =\t{'editedBy._id': userId};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'editedBy.username': username\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tupdateUsernameAndMessageOfMentionByIdAndOldUsername(_id, oldUsername, newUsername, newMessage) {\n\t\tconst query = {\n\t\t\t_id,\n\t\t\t'mentions.username': oldUsername\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'mentions.$.username': newUsername,\n\t\t\t\t'msg': newMessage\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tupdateUserStarById(_id, userId, starred) {\n\t\tlet update;\n\t\tconst query =\t{_id};\n\n\t\tif (starred) {\n\t\t\tupdate = {\n\t\t\t\t$addToSet: {\n\t\t\t\t\tstarred: { _id: userId }\n\t\t\t\t}\n\t\t\t};\n\t\t} else {\n\t\t\tupdate = {\n\t\t\t\t$pull: {\n\t\t\t\t\tstarred: { _id: Meteor.userId() }\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\treturn this.update(query, update);\n\t}\n\n\tupgradeEtsToEditAt() {\n\t\tconst query =\t{ets: { $exists: 1 }};\n\n\t\tconst update = {\n\t\t\t$rename: {\n\t\t\t\t'ets': 'editedAt'\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tsetMessageAttachments(_id, attachments) {\n\t\tconst query =\t{_id};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tattachments\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetSlackBotIdAndSlackTs(_id, slackBotId, slackTs) {\n\t\tconst query =\t{_id};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tslackBotId,\n\t\t\t\tslackTs\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tunlinkUserId(userId, newUserId, newUsername, newNameAlias) {\n\t\tconst query = {\n\t\t\t'u._id': userId\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'alias': newNameAlias,\n\t\t\t\t'u._id': newUserId,\n\t\t\t\t'u.username' : newUsername,\n\t\t\t\t'u.name' : undefined\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\t// INSERT\n\tcreateWithTypeRoomIdMessageAndUser(type, roomId, message, user, extraData) {\n\t\tconst room = RocketChat.models.Rooms.findOneById(roomId, { fields: { sysMes: 1 }});\n\t\tif ((room != null ? room.sysMes : undefined) === false) {\n\t\t\treturn;\n\t\t}\n\t\tconst record = {\n\t\t\tt: type,\n\t\t\trid: roomId,\n\t\t\tts: new Date,\n\t\t\tmsg: message,\n\t\t\tu: {\n\t\t\t\t_id: user._id,\n\t\t\t\tusername: user.username\n\t\t\t},\n\t\t\tgroupable: false\n\t\t};\n\n\t\tif (RocketChat.settings.get('Message_Read_Receipt_Enabled')) {\n\t\t\trecord.unread = true;\n\t\t}\n\n\t\t_.extend(record, extraData);\n\n\t\trecord._id = this.insertOrUpsert(record);\n\t\tRocketChat.models.Rooms.incMsgCountById(room._id, 1);\n\t\treturn record;\n\t}\n\n\tcreateNavigationHistoryWithRoomIdMessageAndUser(roomId, message, user, extraData) {\n\t\tconst type = 'livechat_navigation_history';\n\t\tconst room = RocketChat.models.Rooms.findOneById(roomId, { fields: { sysMes: 1 }});\n\t\tif ((room != null ? room.sysMes : undefined) === false) {\n\t\t\treturn;\n\t\t}\n\t\tconst record = {\n\t\t\tt: type,\n\t\t\trid: roomId,\n\t\t\tts: new Date,\n\t\t\tmsg: message,\n\t\t\tu: {\n\t\t\t\t_id: user._id,\n\t\t\t\tusername: user.username\n\t\t\t},\n\t\t\tgroupable: false\n\t\t};\n\n\t\tif (RocketChat.settings.get('Message_Read_Receipt_Enabled')) {\n\t\t\trecord.unread = true;\n\t\t}\n\n\t\t_.extend(record, extraData);\n\n\t\trecord._id = this.insertOrUpsert(record);\n\t\treturn record;\n\t}\n\n\tcreateUserJoinWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('uj', roomId, message, user, extraData);\n\t}\n\n\tcreateUserLeaveWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('ul', roomId, message, user, extraData);\n\t}\n\n\tcreateUserRemovedWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('ru', roomId, message, user, extraData);\n\t}\n\n\tcreateUserAddedWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('au', roomId, message, user, extraData);\n\t}\n\n\tcreateCommandWithRoomIdAndUser(command, roomId, user, extraData) {\n\t\treturn this.createWithTypeRoomIdMessageAndUser('command', roomId, command, user, extraData);\n\t}\n\n\tcreateUserMutedWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('user-muted', roomId, message, user, extraData);\n\t}\n\n\tcreateUserUnmutedWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('user-unmuted', roomId, message, user, extraData);\n\t}\n\n\tcreateNewModeratorWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('new-moderator', roomId, message, user, extraData);\n\t}\n\n\tcreateModeratorRemovedWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('moderator-removed', roomId, message, user, extraData);\n\t}\n\n\tcreateNewOwnerWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('new-owner', roomId, message, user, extraData);\n\t}\n\n\tcreateOwnerRemovedWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('owner-removed', roomId, message, user, extraData);\n\t}\n\n\tcreateNewLeaderWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('new-leader', roomId, message, user, extraData);\n\t}\n\n\tcreateLeaderRemovedWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('leader-removed', roomId, message, user, extraData);\n\t}\n\n\tcreateSubscriptionRoleAddedWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('subscription-role-added', roomId, message, user, extraData);\n\t}\n\n\tcreateSubscriptionRoleRemovedWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('subscription-role-removed', roomId, message, user, extraData);\n\t}\n\n\t// REMOVE\n\tremoveById(_id) {\n\t\tconst query =\t{_id};\n\n\t\treturn this.remove(query);\n\t}\n\n\tremoveByRoomId(roomId) {\n\t\tconst query =\t{rid: roomId};\n\n\t\treturn this.remove(query);\n\t}\n\n\tremoveByUserId(userId) {\n\t\tconst query =\t{'u._id': userId};\n\n\t\treturn this.remove(query);\n\t}\n\n\tgetMessageByFileId(fileID) {\n\t\treturn this.findOne({ 'file._id': fileID });\n\t}\n\n\tsetAsRead(rid, until) {\n\t\treturn this.update({\n\t\t\trid,\n\t\t\tunread: true,\n\t\t\tts: { $lt: until }\n\t\t}, {\n\t\t\t$unset: {\n\t\t\t\tunread: 1\n\t\t\t}\n\t\t}, {\n\t\t\tmulti: true\n\t\t});\n\t}\n\n\tsetAsReadById(_id) {\n\t\treturn this.update({\n\t\t\t_id\n\t\t}, {\n\t\t\t$unset: {\n\t\t\t\tunread: 1\n\t\t\t}\n\t\t});\n\t}\n\n\tfindUnreadMessagesByRoomAndDate(rid, after) {\n\t\tconst query = {\n\t\t\tunread: true,\n\t\t\trid\n\t\t};\n\n\t\tif (after) {\n\t\t\tquery.ts = { $gt: after };\n\t\t}\n\n\t\treturn this.find(query, {\n\t\t\tfields: {\n\t\t\t\t_id: 1\n\t\t\t}\n\t\t});\n\t}\n};\n","import _ from 'underscore';\n\nRocketChat.models.Reports = new class extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper('reports');\n\t}\n\tcreateWithMessageDescriptionAndUserId(message, description, userId, extraData) {\n\t\tconst record = {\n\t\t\tmessage,\n\t\t\tdescription,\n\t\t\tts: new Date(),\n\t\t\tuserId\n\t\t};\n\t\t_.extend(record, extraData);\n\t\trecord._id = this.insert(record);\n\t\treturn record;\n\t}\n};\n","import _ from 'underscore';\nimport s from 'underscore.string';\n\nclass ModelRooms extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper(...arguments);\n\n\t\tthis.tryEnsureIndex({ 'name': 1 }, { unique: 1, sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'default': 1 });\n\t\tthis.tryEnsureIndex({ 'usernames': 1 });\n\t\tthis.tryEnsureIndex({ 't': 1 });\n\t\tthis.tryEnsureIndex({ 'u._id': 1 });\n\n\t\tthis.cache.ignoreUpdatedFields = ['msgs', 'lm'];\n\t\tthis.cache.ensureIndex(['t', 'name'], 'unique');\n\t\tthis.cache.options = {fields: {usernames: 0}};\n\t}\n\n\tfindOneByIdOrName(_idOrName, options) {\n\t\tconst query = {\n\t\t\t$or: [{\n\t\t\t\t_id: _idOrName\n\t\t\t}, {\n\t\t\t\tname: _idOrName\n\t\t\t}]\n\t\t};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneByImportId(_id, options) {\n\t\tconst query = {importIds: _id};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneByName(name, options) {\n\t\tconst query = {name};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneByNameAndNotId(name, rid) {\n\t\tconst query = {\n\t\t\t_id: { $ne: rid },\n\t\t\tname\n\t\t};\n\n\t\treturn this.findOne(query);\n\t}\n\n\tfindOneByDisplayName(fname, options) {\n\t\tconst query = {fname};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneByNameAndType(name, type, options) {\n\t\tconst query = {\n\t\t\tname,\n\t\t\tt: type\n\t\t};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneByIdContainingUsername(_id, username, options) {\n\t\tconst query = {\n\t\t\t_id,\n\t\t\tusernames: username\n\t\t};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneByNameAndTypeNotContainingUsername(name, type, username, options) {\n\t\tconst query = {\n\t\t\tname,\n\t\t\tt: type,\n\t\t\tusernames: {\n\t\t\t\t$ne: username\n\t\t\t}\n\t\t};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\n\t// FIND\n\n\tfindWithUsername(username, options) {\n\t\treturn this.find({ usernames: username }, options);\n\t}\n\n\tfindById(roomId, options) {\n\t\treturn this.find({ _id: roomId }, options);\n\t}\n\n\tfindByIds(roomIds, options) {\n\t\treturn this.find({ _id: {$in: [].concat(roomIds)} }, options);\n\t}\n\n\tfindByType(type, options) {\n\t\tconst query = {t: type};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByTypes(types, options) {\n\t\tconst query = {\n\t\t\tt: {\n\t\t\t\t$in: types\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByUserId(userId, options) {\n\t\tconst query = {'u._id': userId};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindBySubscriptionUserId(userId, options) {\n\t\tlet data;\n\t\tif (this.useCache) {\n\t\t\tdata = RocketChat.models.Subscriptions.findByUserId(userId).fetch();\n\t\t\tdata = data.map(function(item) {\n\t\t\t\tif (item._room) {\n\t\t\t\t\treturn item._room;\n\t\t\t\t}\n\t\t\t\tconsole.log('Empty Room for Subscription', item);\n\t\t\t});\n\t\t\tdata = data.filter(item => item);\n\t\t\treturn this.arrayToCursor(this.processQueryOptionsOnResult(data, options));\n\t\t}\n\n\t\tdata = RocketChat.models.Subscriptions.findByUserId(userId, {fields: {rid: 1}}).fetch();\n\t\tdata = data.map(item => item.rid);\n\n\t\tconst query = {\n\t\t\t_id: {\n\t\t\t\t$in: data\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindBySubscriptionUserIdUpdatedAfter(userId, _updatedAt, options) {\n\t\tif (this.useCache) {\n\t\t\tlet data = RocketChat.models.Subscriptions.findByUserId(userId).fetch();\n\t\t\tdata = data.map(function(item) {\n\t\t\t\tif (item._room) {\n\t\t\t\t\treturn item._room;\n\t\t\t\t}\n\t\t\t\tconsole.log('Empty Room for Subscription', item);\n\t\t\t});\n\t\t\tdata = data.filter(item => item && item._updatedAt > _updatedAt);\n\t\t\treturn this.arrayToCursor(this.processQueryOptionsOnResult(data, options));\n\t\t}\n\n\t\tlet ids = RocketChat.models.Subscriptions.findByUserId(userId, {fields: {rid: 1}}).fetch();\n\t\tids = ids.map(item => item.rid);\n\n\t\tconst query = {\n\t\t\t_id: {\n\t\t\t\t$in: ids\n\t\t\t},\n\t\t\t_updatedAt: {\n\t\t\t\t$gt: _updatedAt\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByNameContaining(name, options) {\n\t\tconst nameRegex = new RegExp(s.trim(s.escapeRegExp(name)), 'i');\n\n\t\tconst query = {\n\t\t\t$or: [\n\t\t\t\t{name: nameRegex},\n\t\t\t\t{\n\t\t\t\t\tt: 'd',\n\t\t\t\t\tusernames: nameRegex\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByNameContainingTypesWithUsername(name, types, options) {\n\t\tconst nameRegex = new RegExp(s.trim(s.escapeRegExp(name)), 'i');\n\n\t\tconst $or = [];\n\t\tfor (const type of Array.from(types)) {\n\t\t\tconst obj = {name: nameRegex, t: type.type};\n\t\t\tif (type.username != null) {\n\t\t\t\tobj.usernames = type.username;\n\t\t\t}\n\t\t\tif (type.ids != null) {\n\t\t\t\tobj._id = {$in: type.ids};\n\t\t\t}\n\t\t\t$or.push(obj);\n\t\t}\n\n\t\tconst query = {$or};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindContainingTypesWithUsername(types, options) {\n\n\t\tconst $or = [];\n\t\tfor (const type of Array.from(types)) {\n\t\t\tconst obj = {t: type.type};\n\t\t\tif (type.username != null) {\n\t\t\t\tobj.usernames = type.username;\n\t\t\t}\n\t\t\tif (type.ids != null) {\n\t\t\t\tobj._id = {$in: type.ids};\n\t\t\t}\n\t\t\t$or.push(obj);\n\t\t}\n\n\t\tconst query = {$or};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByNameContainingAndTypes(name, types, options) {\n\t\tconst nameRegex = new RegExp(s.trim(s.escapeRegExp(name)), 'i');\n\n\t\tconst query = {\n\t\t\tt: {\n\t\t\t\t$in: types\n\t\t\t},\n\t\t\t$or: [\n\t\t\t\t{name: nameRegex},\n\t\t\t\t{\n\t\t\t\t\tt: 'd',\n\t\t\t\t\tusernames: nameRegex\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByNameAndType(name, type, options) {\n\t\tconst query = {\n\t\t\tt: type,\n\t\t\tname\n\t\t};\n\n\t\t// do not use cache\n\t\treturn this._db.find(query, options);\n\t}\n\n\tfindByNameAndTypeNotDefault(name, type, options) {\n\t\tconst query = {\n\t\t\tt: type,\n\t\t\tname,\n\t\t\tdefault: {\n\t\t\t\t$ne: true\n\t\t\t}\n\t\t};\n\n\t\t// do not use cache\n\t\treturn this._db.find(query, options);\n\t}\n\n\tfindByNameAndTypesNotContainingUsername(name, types, username, options) {\n\t\tconst query = {\n\t\t\tt: {\n\t\t\t\t$in: types\n\t\t\t},\n\t\t\tname,\n\t\t\tusernames: {\n\t\t\t\t$ne: username\n\t\t\t}\n\t\t};\n\n\t\t// do not use cache\n\t\treturn this._db.find(query, options);\n\t}\n\n\tfindByNameStartingAndTypes(name, types, options) {\n\t\tconst nameRegex = new RegExp(`^${ s.trim(s.escapeRegExp(name)) }`, 'i');\n\n\t\tconst query = {\n\t\t\tt: {\n\t\t\t\t$in: types\n\t\t\t},\n\t\t\t$or: [\n\t\t\t\t{name: nameRegex},\n\t\t\t\t{\n\t\t\t\t\tt: 'd',\n\t\t\t\t\tusernames: nameRegex\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByDefaultAndTypes(defaultValue, types, options) {\n\t\tconst query = {\n\t\t\tdefault: defaultValue,\n\t\t\tt: {\n\t\t\t\t$in: types\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByTypeContainingUsername(type, username, options) {\n\t\tconst query = {\n\t\t\tt: type,\n\t\t\tusernames: username\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByTypeContainingUsernames(type, username, options) {\n\t\tconst query = {\n\t\t\tt: type,\n\t\t\tusernames: { $all: [].concat(username) }\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByTypesAndNotUserIdContainingUsername(types, userId, username, options) {\n\t\tconst query = {\n\t\t\tt: {\n\t\t\t\t$in: types\n\t\t\t},\n\t\t\tuid: {\n\t\t\t\t$ne: userId\n\t\t\t},\n\t\t\tusernames: username\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByContainingUsername(username, options) {\n\t\tconst query = {usernames: username};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByTypeAndName(type, name, options) {\n\t\tif (this.useCache) {\n\t\t\treturn this.cache.findByIndex('t,name', [type, name], options);\n\t\t}\n\n\t\tconst query = {\n\t\t\tname,\n\t\t\tt: type\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByTypeAndNameContainingUsername(type, name, username, options) {\n\t\tconst query = {\n\t\t\tname,\n\t\t\tt: type,\n\t\t\tusernames: username\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByTypeAndArchivationState(type, archivationstate, options) {\n\t\tconst query = {t: type};\n\n\t\tif (archivationstate) {\n\t\t\tquery.archived = true;\n\t\t} else {\n\t\t\tquery.archived = { $ne: true };\n\t\t}\n\n\t\treturn this.find(query, options);\n\t}\n\n\t// UPDATE\n\taddImportIds(_id, importIds) {\n\t\timportIds = [].concat(importIds);\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$addToSet: {\n\t\t\t\timportIds: {\n\t\t\t\t\t$each: importIds\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tarchiveById(_id) {\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tarchived: true\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tunarchiveById(_id) {\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tarchived: false\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\taddUsernameById(_id, username, muted) {\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$addToSet: {\n\t\t\t\tusernames: username\n\t\t\t}\n\t\t};\n\n\t\tif (muted) {\n\t\t\tupdate.$addToSet.muted = username;\n\t\t}\n\n\t\treturn this.update(query, update);\n\t}\n\n\taddUsernamesById(_id, usernames) {\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$addToSet: {\n\t\t\t\tusernames: {\n\t\t\t\t\t$each: usernames\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\taddUsernameByName(name, username) {\n\t\tconst query = {name};\n\n\t\tconst update = {\n\t\t\t$addToSet: {\n\t\t\t\tusernames: username\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tremoveUsernameById(_id, username) {\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$pull: {\n\t\t\t\tusernames: username\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tremoveUsernamesById(_id, usernames) {\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$pull: {\n\t\t\t\tusernames: {\n\t\t\t\t\t$in: usernames\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tremoveUsernameFromAll(username) {\n\t\tconst query = {usernames: username};\n\n\t\tconst update = {\n\t\t\t$pull: {\n\t\t\t\tusernames: username\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tremoveUsernameByName(name, username) {\n\t\tconst query = {name};\n\n\t\tconst update = {\n\t\t\t$pull: {\n\t\t\t\tusernames: username\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetNameById(_id, name, fname) {\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tname,\n\t\t\t\tfname\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetFnameById(_id, fname) {\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tfname\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tincMsgCountById(_id, inc) {\n\t\tif (inc == null) { inc = 1; }\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$inc: {\n\t\t\t\tmsgs: inc\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tincMsgCountAndSetLastMessageById(_id, inc, lastMessageTimestamp, lastMessage) {\n\t\tif (inc == null) { inc = 1; }\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tlm: lastMessageTimestamp\n\t\t\t},\n\t\t\t$inc: {\n\t\t\t\tmsgs: inc\n\t\t\t}\n\t\t};\n\n\t\tif (lastMessage) {\n\t\t\tupdate.$set.lastMessage = lastMessage;\n\t\t}\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetLastMessageById(_id, lastMessage) {\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tlastMessage\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\treplaceUsername(previousUsername, username) {\n\t\tconst query = {usernames: previousUsername};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'usernames.$': username\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\treplaceMutedUsername(previousUsername, username) {\n\t\tconst query = {muted: previousUsername};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'muted.$': username\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\treplaceUsernameOfUserByUserId(userId, username) {\n\t\tconst query = {'u._id': userId};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'u.username': username\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tsetJoinCodeById(_id, joinCode) {\n\t\tlet update;\n\t\tconst query = {_id};\n\n\t\tif ((joinCode != null ? joinCode.trim() : undefined) !== '') {\n\t\t\tupdate = {\n\t\t\t\t$set: {\n\t\t\t\t\tjoinCodeRequired: true,\n\t\t\t\t\tjoinCode\n\t\t\t\t}\n\t\t\t};\n\t\t} else {\n\t\t\tupdate = {\n\t\t\t\t$set: {\n\t\t\t\t\tjoinCodeRequired: false\n\t\t\t\t},\n\t\t\t\t$unset: {\n\t\t\t\t\tjoinCode: 1\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetUserById(_id, user) {\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tu: {\n\t\t\t\t\t_id: user._id,\n\t\t\t\t\tusername: user.username\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetTypeById(_id, type) {\n\t\tconst query = {_id};\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tt: type\n\t\t\t}\n\t\t};\n\t\tif (type === 'p') {\n\t\t\tupdate.$unset = {default: ''};\n\t\t}\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetTopicById(_id, topic) {\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\ttopic\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetAnnouncementById(_id, announcement, announcementDetails) {\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tannouncement,\n\t\t\t\tannouncementDetails\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetCustomFieldsById(_id, customFields) {\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tcustomFields\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tmuteUsernameByRoomId(_id, username) {\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$addToSet: {\n\t\t\t\tmuted: username\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tunmuteUsernameByRoomId(_id, username) {\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$pull: {\n\t\t\t\tmuted: username\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsaveDefaultById(_id, defaultValue) {\n\t\tconst query = {_id};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tdefault: defaultValue === 'true'\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetTopicAndTagsById(_id, topic, tags) {\n\t\tconst setData = {};\n\t\tconst unsetData = {};\n\n\t\tif (topic != null) {\n\t\t\tif (!_.isEmpty(s.trim(topic))) {\n\t\t\t\tsetData.topic = s.trim(topic);\n\t\t\t} else {\n\t\t\t\tunsetData.topic = 1;\n\t\t\t}\n\t\t}\n\n\t\tif (tags != null) {\n\t\t\tif (!_.isEmpty(s.trim(tags))) {\n\t\t\t\tsetData.tags = s.trim(tags).split(',').map(tag => s.trim(tag));\n\t\t\t} else {\n\t\t\t\tunsetData.tags = 1;\n\t\t\t}\n\t\t}\n\n\t\tconst update = {};\n\n\t\tif (!_.isEmpty(setData)) {\n\t\t\tupdate.$set = setData;\n\t\t}\n\n\t\tif (!_.isEmpty(unsetData)) {\n\t\t\tupdate.$unset = unsetData;\n\t\t}\n\n\t\tif (_.isEmpty(update)) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn this.update({ _id }, update);\n\t}\n\n\t// INSERT\n\tcreateWithTypeNameUserAndUsernames(type, name, fname, user, usernames, extraData) {\n\t\tconst room = {\n\t\t\tname,\n\t\t\tfname,\n\t\t\tt: type,\n\t\t\tusernames,\n\t\t\tmsgs: 0,\n\t\t\tu: {\n\t\t\t\t_id: user._id,\n\t\t\t\tusername: user.username\n\t\t\t}\n\t\t};\n\n\t\t_.extend(room, extraData);\n\n\t\troom._id = this.insert(room);\n\t\treturn room;\n\t}\n\n\tcreateWithIdTypeAndName(_id, type, name, extraData) {\n\t\tconst room = {\n\t\t\t_id,\n\t\t\tts: new Date(),\n\t\t\tt: type,\n\t\t\tname,\n\t\t\tusernames: [],\n\t\t\tmsgs: 0\n\t\t};\n\n\t\t_.extend(room, extraData);\n\n\t\tthis.insert(room);\n\t\treturn room;\n\t}\n\n\tcreateWithFullRoomData(room) {\n\t\tdelete room._id;\n\n\t\troom._id = this.insert(room);\n\t\treturn room;\n\t}\n\n\n\t// REMOVE\n\tremoveById(_id) {\n\t\tconst query = {_id};\n\n\t\treturn this.remove(query);\n\t}\n\n\tremoveByTypeContainingUsername(type, username) {\n\t\tconst query = {\n\t\t\tt: type,\n\t\t\tusernames: username\n\t\t};\n\n\t\treturn this.remove(query);\n\t}\n}\n\nRocketChat.models.Rooms = new ModelRooms('room', true);\n","class ModelSettings extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper(...arguments);\n\n\t\tthis.tryEnsureIndex({ 'blocked': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'hidden': 1 }, { sparse: 1 });\n\t}\n\n\t// FIND\n\tfindById(_id) {\n\t\tconst query = {_id};\n\n\t\treturn this.find(query);\n\t}\n\n\tfindOneNotHiddenById(_id) {\n\t\tconst query = {\n\t\t\t_id,\n\t\t\thidden: { $ne: true }\n\t\t};\n\n\t\treturn this.findOne(query);\n\t}\n\n\tfindByIds(_id = []) {\n\t\t_id = [].concat(_id);\n\n\t\tconst query = {\n\t\t\t_id: {\n\t\t\t\t$in: _id\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query);\n\t}\n\n\tfindByRole(role, options) {\n\t\tconst query = {role};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindPublic(options) {\n\t\tconst query = {public: true};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindNotHiddenPublic(ids = []) {\n\t\tconst filter = {\n\t\t\thidden: { $ne: true },\n\t\t\tpublic: true\n\t\t};\n\n\t\tif (ids.length > 0) {\n\t\t\tfilter._id =\n\t\t\t\t{$in: ids};\n\t\t}\n\n\t\treturn this.find(filter, { fields: {_id: 1, value: 1} });\n\t}\n\n\tfindNotHiddenPublicUpdatedAfter(updatedAt) {\n\t\tconst filter = {\n\t\t\thidden: { $ne: true },\n\t\t\tpublic: true,\n\t\t\t_updatedAt: {\n\t\t\t\t$gt: updatedAt\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(filter, { fields: {_id: 1, value: 1} });\n\t}\n\n\tfindNotHiddenPrivate() {\n\t\treturn this.find({\n\t\t\thidden: { $ne: true },\n\t\t\tpublic: { $ne: true }\n\t\t});\n\t}\n\n\tfindNotHidden(options) {\n\t\treturn this.find({ hidden: { $ne: true } }, options);\n\t}\n\n\tfindNotHiddenUpdatedAfter(updatedAt) {\n\t\treturn this.find({\n\t\t\thidden: { $ne: true },\n\t\t\t_updatedAt: {\n\t\t\t\t$gt: updatedAt\n\t\t\t}\n\t\t});\n\t}\n\n\tfindSetupWizardSettings() {\n\t\treturn this.find({ wizard: { '$exists': true, '$ne': null } });\n\t}\n\n\t// UPDATE\n\tupdateValueById(_id, value) {\n\t\tconst query = {\n\t\t\tblocked: { $ne: true },\n\t\t\tvalue: { $ne: value },\n\t\t\t_id\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tvalue\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tupdateValueAndEditorById(_id, value, editor) {\n\t\tconst query = {\n\t\t\tblocked: { $ne: true },\n\t\t\tvalue: { $ne: value },\n\t\t\t_id\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tvalue,\n\t\t\t\teditor\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tupdateValueNotHiddenById(_id, value) {\n\t\tconst query = {\n\t\t\t_id,\n\t\t\thidden: { $ne: true },\n\t\t\tblocked: { $ne: true }\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tvalue\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tupdateOptionsById(_id, options) {\n\t\tconst query = {\n\t\t\tblocked: { $ne: true },\n\t\t\t_id\n\t\t};\n\n\t\tconst update = {$set: options};\n\n\t\treturn this.update(query, update);\n\t}\n\n\t// INSERT\n\tcreateWithIdAndValue(_id, value) {\n\t\tconst record = {\n\t\t\t_id,\n\t\t\tvalue,\n\t\t\t_createdAt: new Date\n\t\t};\n\n\t\treturn this.insert(record);\n\t}\n\n\t// REMOVE\n\tremoveById(_id) {\n\t\tconst query = {\n\t\t\tblocked: { $ne: true },\n\t\t\t_id\n\t\t};\n\n\t\treturn this.remove(query);\n\t}\n}\n\nRocketChat.models.Settings = new ModelSettings('settings', true);\n","class ModelSubscriptions extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper(...arguments);\n\n\t\tthis.tryEnsureIndex({ 'rid': 1, 'u._id': 1 }, { unique: 1 });\n\t\tthis.tryEnsureIndex({ 'rid': 1, 'alert': 1, 'u._id': 1 });\n\t\tthis.tryEnsureIndex({ 'rid': 1, 'roles': 1 });\n\t\tthis.tryEnsureIndex({ 'u._id': 1, 'name': 1, 't': 1 });\n\t\tthis.tryEnsureIndex({ 'open': 1 });\n\t\tthis.tryEnsureIndex({ 'alert': 1 });\n\n\t\tthis.tryEnsureIndex({ rid: 1, 'u._id': 1, open: 1 });\n\n\t\tthis.tryEnsureIndex({ 'ts': 1 });\n\t\tthis.tryEnsureIndex({ 'ls': 1 });\n\t\tthis.tryEnsureIndex({ 'audioNotifications': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'desktopNotifications': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'mobilePushNotifications': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'emailNotifications': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'autoTranslate': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'autoTranslateLanguage': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'userHighlights.0': 1 }, { sparse: 1 });\n\n\t\tthis.cache.ensureIndex('rid', 'array');\n\t\tthis.cache.ensureIndex('u._id', 'array');\n\t\tthis.cache.ensureIndex('name', 'array');\n\t\tthis.cache.ensureIndex(['rid', 'u._id'], 'unique');\n\t\tthis.cache.ensureIndex(['name', 'u._id'], 'unique');\n\t}\n\n\n\t// FIND ONE\n\tfindOneByRoomIdAndUserId(roomId, userId, options) {\n\t\tif (this.useCache) {\n\t\t\treturn this.cache.findByIndex('rid,u._id', [roomId, userId], options).fetch();\n\t\t}\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': userId\n\t\t};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneByRoomNameAndUserId(roomName, userId) {\n\t\tif (this.useCache) {\n\t\t\treturn this.cache.findByIndex('name,u._id', [roomName, userId]).fetch();\n\t\t}\n\t\tconst query = {\n\t\t\tname: roomName,\n\t\t\t'u._id': userId\n\t\t};\n\n\t\treturn this.findOne(query);\n\t}\n\n\t// FIND\n\tfindByUserId(userId, options) {\n\t\tif (this.useCache) {\n\t\t\treturn this.cache.findByIndex('u._id', userId, options);\n\t\t}\n\n\t\tconst query =\n\t\t\t{ 'u._id': userId };\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByUserIdUpdatedAfter(userId, updatedAt, options) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\t_updatedAt: {\n\t\t\t\t$gt: updatedAt\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByRoomIdAndRoles(roomId, roles, options) {\n\t\troles = [].concat(roles);\n\t\tconst query = {\n\t\t\t'rid': roomId,\n\t\t\t'roles': { $in: roles }\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByType(types, options) {\n\t\tconst query = {\n\t\t\tt: {\n\t\t\t\t$in: types\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByTypeAndUserId(type, userId, options) {\n\t\tconst query = {\n\t\t\tt: type,\n\t\t\t'u._id': userId\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByTypeNameAndUserId(type, name, userId, options) {\n\t\tconst query = {\n\t\t\tt: type,\n\t\t\tname,\n\t\t\t'u._id': userId\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByRoomId(roomId, options) {\n\t\tif (this.useCache) {\n\t\t\treturn this.cache.findByIndex('rid', roomId, options);\n\t\t}\n\n\t\tconst query =\n\t\t\t{ rid: roomId };\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByRoomIdAndNotUserId(roomId, userId, options) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': {\n\t\t\t\t$ne: userId\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByRoomWithUserHighlights(roomId, options) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'userHighlights.0': { $exists: true }\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tgetLastSeen(options) {\n\t\tif (options == null) {\n\t\t\toptions = {};\n\t\t}\n\t\tconst query = { ls: { $exists: 1 } };\n\t\toptions.sort = { ls: -1 };\n\t\toptions.limit = 1;\n\t\tconst [subscription] = this.find(query, options).fetch();\n\t\treturn subscription && subscription.ls;\n\t}\n\n\tfindByRoomIdAndUserIds(roomId, userIds) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': {\n\t\t\t\t$in: userIds\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query);\n\t}\n\n\tfindByRoomIdAndUserIdsOrAllMessages(roomId, userIds) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t$or: [\n\t\t\t\t{ 'u._id': { $in: userIds } },\n\t\t\t\t{ emailNotifications: 'all' }\n\t\t\t]\n\t\t};\n\n\t\treturn this.find(query);\n\t}\n\n\tfindUnreadByUserId(userId) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\tunread: {\n\t\t\t\t$gt: 0\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, { fields: { unread: 1 } });\n\t}\n\n\tgetMinimumLastSeenByRoomId(rid) {\n\t\treturn this.db.findOne({\n\t\t\trid\n\t\t}, {\n\t\t\tsort: {\n\t\t\t\tls: 1\n\t\t\t},\n\t\t\tfields: {\n\t\t\t\tls: 1\n\t\t\t}\n\t\t});\n\t}\n\n\t// UPDATE\n\tarchiveByRoomId(roomId) {\n\t\tconst query =\n\t\t\t{ rid: roomId };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\talert: false,\n\t\t\t\topen: false,\n\t\t\t\tarchived: true\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tunarchiveByRoomId(roomId) {\n\t\tconst query =\n\t\t\t{ rid: roomId };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\talert: false,\n\t\t\t\topen: true,\n\t\t\t\tarchived: false\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\thideByRoomIdAndUserId(roomId, userId) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': userId\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\talert: false,\n\t\t\t\topen: false\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\topenByRoomIdAndUserId(roomId, userId) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': userId\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\topen: true\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetAsReadByRoomIdAndUserId(roomId, userId) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': userId\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\topen: true,\n\t\t\t\talert: false,\n\t\t\t\tunread: 0,\n\t\t\t\tuserMentions: 0,\n\t\t\t\tgroupMentions: 0,\n\t\t\t\tls: new Date\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetAsUnreadByRoomIdAndUserId(roomId, userId, firstMessageUnreadTimestamp) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': userId\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\topen: true,\n\t\t\t\talert: true,\n\t\t\t\tls: firstMessageUnreadTimestamp\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetCustomFieldsDirectMessagesByUserId(userId, fields) {\n\t\tconst values = {};\n\t\tObject.keys(fields).forEach(key => {\n\t\t\tvalues[`customFields.${ key }`] = fields[key];\n\t\t});\n\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\t't': 'd'\n\t\t};\n\t\tconst update = { $set: values };\n\t\tconst options = { 'multi': true };\n\n\t\treturn this.update(query, update, options);\n\t}\n\n\tsetFavoriteByRoomIdAndUserId(roomId, userId, favorite) {\n\t\tif (favorite == null) {\n\t\t\tfavorite = true;\n\t\t}\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': userId\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tf: favorite\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tupdateNameAndAlertByRoomId(roomId, name, fname) {\n\t\tconst query =\n\t\t\t{ rid: roomId };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tname,\n\t\t\t\tfname,\n\t\t\t\talert: true\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tupdateDisplayNameByRoomId(roomId, fname) {\n\t\tconst query =\n\t\t\t{ rid: roomId };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tfname\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tsetUserUsernameByUserId(userId, username) {\n\t\tconst query =\n\t\t\t{ 'u._id': userId };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'u.username': username\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tsetNameForDirectRoomsWithOldName(oldName, name) {\n\t\tconst query = {\n\t\t\tname: oldName,\n\t\t\tt: 'd'\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tname\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tincUnreadForRoomIdExcludingUserId(roomId, userId, inc) {\n\t\tif (inc == null) {\n\t\t\tinc = 1;\n\t\t}\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': {\n\t\t\t\t$ne: userId\n\t\t\t}\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\talert: true,\n\t\t\t\topen: true\n\t\t\t},\n\t\t\t$inc: {\n\t\t\t\tunread: inc\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tincGroupMentionsAndUnreadForRoomIdExcludingUserId(roomId, userId, incGroup = 1, incUnread = 1) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': {\n\t\t\t\t$ne: userId\n\t\t\t}\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\talert: true,\n\t\t\t\topen: true\n\t\t\t},\n\t\t\t$inc: {\n\t\t\t\tunread: incUnread,\n\t\t\t\tgroupMentions: incGroup\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tincUserMentionsAndUnreadForRoomIdAndUserIds(roomId, userIds, incUser = 1, incUnread = 1) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': {\n\t\t\t\t$in: userIds\n\t\t\t}\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\talert: true,\n\t\t\t\topen: true\n\t\t\t},\n\t\t\t$inc: {\n\t\t\t\tunread: incUnread,\n\t\t\t\tuserMentions: incUser\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tignoreUser({_id, ignoredUser : ignored, ignore = true}) {\n\t\tconst query = {\n\t\t\t_id\n\t\t};\n\t\tconst update = {\n\t\t};\n\t\tif (ignore) {\n\t\t\tupdate.$addToSet = { ignored };\n\t\t} else {\n\t\t\tupdate.$pull = { ignored };\n\t\t}\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetAlertForRoomIdExcludingUserId(roomId, userId) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': {\n\t\t\t\t$ne: userId\n\t\t\t},\n\t\t\talert: { $ne: true }\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\talert: true\n\t\t\t}\n\t\t};\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tsetOpenForRoomIdExcludingUserId(roomId, userId) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': {\n\t\t\t\t$ne: userId\n\t\t\t},\n\t\t\topen: { $ne: true }\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\topen: true\n\t\t\t}\n\t\t};\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tsetBlockedByRoomId(rid, blocked, blocker) {\n\t\tconst query = {\n\t\t\trid,\n\t\t\t'u._id': blocked\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tblocked: true\n\t\t\t}\n\t\t};\n\n\t\tconst query2 = {\n\t\t\trid,\n\t\t\t'u._id': blocker\n\t\t};\n\n\t\tconst update2 = {\n\t\t\t$set: {\n\t\t\t\tblocker: true\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update) && this.update(query2, update2);\n\t}\n\n\tunsetBlockedByRoomId(rid, blocked, blocker) {\n\t\tconst query = {\n\t\t\trid,\n\t\t\t'u._id': blocked\n\t\t};\n\n\t\tconst update = {\n\t\t\t$unset: {\n\t\t\t\tblocked: 1\n\t\t\t}\n\t\t};\n\n\t\tconst query2 = {\n\t\t\trid,\n\t\t\t'u._id': blocker\n\t\t};\n\n\t\tconst update2 = {\n\t\t\t$unset: {\n\t\t\t\tblocker: 1\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update) && this.update(query2, update2);\n\t}\n\n\tupdateCustomFieldsByRoomId(rid, cfields) {\n\t\tconst query = {rid};\n\t\tconst customFields = cfields || {};\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tcustomFields\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tupdateTypeByRoomId(roomId, type) {\n\t\tconst query =\n\t\t\t{ rid: roomId };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tt: type\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\taddRoleById(_id, role) {\n\t\tconst query =\n\t\t\t{ _id };\n\n\t\tconst update = {\n\t\t\t$addToSet: {\n\t\t\t\troles: role\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tremoveRoleById(_id, role) {\n\t\tconst query =\n\t\t\t{ _id };\n\n\t\tconst update = {\n\t\t\t$pull: {\n\t\t\t\troles: role\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetArchivedByUsername(username, archived) {\n\t\tconst query = {\n\t\t\tt: 'd',\n\t\t\tname: username\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tarchived\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tclearDesktopNotificationUserPreferences(userId) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\tdesktopPrefOrigin: 'user'\n\t\t};\n\n\t\tconst update = {\n\t\t\t$unset: {\n\t\t\t\tdesktopNotifications: 1,\n\t\t\t\tdesktopPrefOrigin: 1\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tupdateDesktopNotificationUserPreferences(userId, desktopNotifications) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\tdesktopPrefOrigin: {\n\t\t\t\t$ne: 'subscription'\n\t\t\t}\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tdesktopNotifications,\n\t\t\t\tdesktopPrefOrigin: 'user'\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tclearMobileNotificationUserPreferences(userId) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\tmobilePrefOrigin: 'user'\n\t\t};\n\n\t\tconst update = {\n\t\t\t$unset: {\n\t\t\t\tmobilePushNotifications: 1,\n\t\t\t\tmobilePrefOrigin: 1\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tupdateMobileNotificationUserPreferences(userId, mobilePushNotifications) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\tmobilePrefOrigin: {\n\t\t\t\t$ne: 'subscription'\n\t\t\t}\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tmobilePushNotifications,\n\t\t\t\tmobilePrefOrigin: 'user'\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tclearEmailNotificationUserPreferences(userId) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\temailPrefOrigin: 'user'\n\t\t};\n\n\t\tconst update = {\n\t\t\t$unset: {\n\t\t\t\temailNotifications: 1,\n\t\t\t\temailPrefOrigin: 1\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tupdateEmailNotificationUserPreferences(userId, emailNotifications) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\temailPrefOrigin: {\n\t\t\t\t$ne: 'subscription'\n\t\t\t}\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\temailNotifications,\n\t\t\t\temailPrefOrigin: 'user'\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tupdateUserHighlights(userId, userHighlights) {\n\t\tconst query = {\n\t\t\t'u._id': userId\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tuserHighlights\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\t// INSERT\n\tcreateWithRoomAndUser(room, user, extraData) {\n\t\tconst subscription = {\n\t\t\topen: false,\n\t\t\talert: false,\n\t\t\tunread: 0,\n\t\t\tuserMentions: 0,\n\t\t\tgroupMentions: 0,\n\t\t\tts: room.ts,\n\t\t\trid: room._id,\n\t\t\tname: room.name,\n\t\t\tfname: room.fname,\n\t\t\tcustomFields: room.customFields,\n\t\t\tt: room.t,\n\t\t\tu: {\n\t\t\t\t_id: user._id,\n\t\t\t\tusername: user.username,\n\t\t\t\tname: user.name\n\t\t\t},\n\t\t\t...RocketChat.getDefaultSubscriptionPref(user),\n\t\t\t...extraData\n\t\t};\n\n\t\treturn this.insert(subscription);\n\t}\n\n\n\t// REMOVE\n\tremoveByUserId(userId) {\n\t\tconst query =\n\t\t\t{ 'u._id': userId };\n\n\t\treturn this.remove(query);\n\t}\n\n\tremoveByRoomId(roomId) {\n\t\tconst query =\n\t\t\t{ rid: roomId };\n\n\t\treturn this.remove(query);\n\t}\n\n\tremoveByRoomIdAndUserId(roomId, userId) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': userId\n\t\t};\n\n\t\treturn this.remove(query);\n\t}\n}\n\nRocketChat.models.Subscriptions = new ModelSubscriptions('subscription', true);\n","/* globals InstanceStatus */\nimport _ from 'underscore';\nimport s from 'underscore.string';\n\nRocketChat.models.Uploads = new class extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper('uploads');\n\n\t\tthis.model.before.insert((userId, doc) => {\n\t\t\tdoc.instanceId = InstanceStatus.id();\n\t\t});\n\n\t\tthis.tryEnsureIndex({ 'rid': 1 });\n\t\tthis.tryEnsureIndex({ 'uploadedAt': 1 });\n\t}\n\n\tfindNotHiddenFilesOfRoom(roomId, limit) {\n\t\tconst fileQuery = {\n\t\t\trid: roomId,\n\t\t\tcomplete: true,\n\t\t\tuploading: false,\n\t\t\t_hidden: {\n\t\t\t\t$ne: true\n\t\t\t}\n\t\t};\n\n\t\tconst fileOptions = {\n\t\t\tlimit,\n\t\t\tsort: {\n\t\t\t\tuploadedAt: -1\n\t\t\t},\n\t\t\tfields: {\n\t\t\t\t_id: 1,\n\t\t\t\tuserId: 1,\n\t\t\t\trid: 1,\n\t\t\t\tname: 1,\n\t\t\t\tdescription: 1,\n\t\t\t\ttype: 1,\n\t\t\t\turl: 1,\n\t\t\t\tuploadedAt: 1\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(fileQuery, fileOptions);\n\t}\n\n\tinsertFileInit(userId, store, file, extra) {\n\t\tconst fileData = {\n\t\t\tuserId,\n\t\t\tstore,\n\t\t\tcomplete: false,\n\t\t\tuploading: true,\n\t\t\tprogress: 0,\n\t\t\textension: s.strRightBack(file.name, '.'),\n\t\t\tuploadedAt: new Date()\n\t\t};\n\n\t\t_.extend(fileData, file, extra);\n\n\t\tif (this.model.direct && this.model.direct.insert != null) {\n\t\t\tfile = this.model.direct.insert(fileData);\n\t\t} else {\n\t\t\tfile = this.insert(fileData);\n\t\t}\n\n\t\treturn file;\n\t}\n\n\tupdateFileComplete(fileId, userId, file) {\n\t\tlet result;\n\t\tif (!fileId) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst filter = {\n\t\t\t_id: fileId,\n\t\t\tuserId\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tcomplete: true,\n\t\t\t\tuploading: false,\n\t\t\t\tprogress: 1\n\t\t\t}\n\t\t};\n\n\t\tupdate.$set = _.extend(file, update.$set);\n\n\t\tif (this.model.direct && this.model.direct.update != null) {\n\t\t\tresult = this.model.direct.update(filter, update);\n\t\t} else {\n\t\t\tresult = this.update(filter, update);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tdeleteFile(fileId) {\n\t\tif (this.model.direct && this.model.direct.remove != null) {\n\t\t\treturn this.model.direct.remove({ _id: fileId });\n\t\t} else {\n\t\t\treturn this.remove({ _id: fileId });\n\t\t}\n\t}\n};\n","import _ from 'underscore';\nimport s from 'underscore.string';\n\nclass ModelUsers extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper(...arguments);\n\n\t\tthis.tryEnsureIndex({ 'roles': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'name': 1 });\n\t\tthis.tryEnsureIndex({ 'lastLogin': 1 });\n\t\tthis.tryEnsureIndex({ 'status': 1 });\n\t\tthis.tryEnsureIndex({ 'active': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'statusConnection': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'type': 1 });\n\n\t\tthis.cache.ensureIndex('username', 'unique');\n\t}\n\n\tfindOneByImportId(_id, options) {\n\t\treturn this.findOne({ importIds: _id }, options);\n\t}\n\n\tfindOneByUsername(username, options) {\n\t\tif (typeof username === 'string') {\n\t\t\tusername = new RegExp(`^${ username }$`, 'i');\n\t\t}\n\n\t\tconst query = {username};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneByEmailAddress(emailAddress, options) {\n\t\tconst query =\t{'emails.address': new RegExp(`^${ s.escapeRegExp(emailAddress) }$`, 'i')};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneAdmin(admin, options) {\n\t\tconst query =\t{admin};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneByIdAndLoginToken(_id, token, options) {\n\t\tconst query = {\n\t\t\t_id,\n\t\t\t'services.resume.loginTokens.hashedToken' : Accounts._hashLoginToken(token)\n\t\t};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneById(userId, options) {\n\t\tconst query =\t{_id: userId};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\t// FIND\n\tfindById(userId) {\n\t\tconst query =\t{_id: userId};\n\n\t\treturn this.find(query);\n\t}\n\n\tfindUsersNotOffline(options) {\n\t\tconst query = {\n\t\t\tusername: {\n\t\t\t\t$exists: 1\n\t\t\t},\n\t\t\tstatus: {\n\t\t\t\t$in: ['online', 'away', 'busy']\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\n\tfindByUsername(username, options) {\n\t\tconst query =\t{username};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindUsersByUsernamesWithHighlights(usernames, options) {\n\t\tif (this.useCache) {\n\t\t\tconst result = {\n\t\t\t\tfetch() {\n\t\t\t\t\treturn RocketChat.models.Users.getDynamicView('highlights').data().filter(record => usernames.indexOf(record.username) > -1);\n\t\t\t\t},\n\t\t\t\tcount() {\n\t\t\t\t\treturn result.fetch().length;\n\t\t\t\t},\n\t\t\t\tforEach(fn) {\n\t\t\t\t\treturn result.fetch().forEach(fn);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn result;\n\t\t}\n\n\t\tconst query = {\n\t\t\tusername: { $in: usernames },\n\t\t\t'settings.preferences.highlights.0': {\n\t\t\t\t$exists: true\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindActiveByUsernameOrNameRegexWithExceptions(searchTerm, exceptions, options) {\n\t\tif (exceptions == null) { exceptions = []; }\n\t\tif (options == null) { options = {}; }\n\t\tif (!_.isArray(exceptions)) {\n\t\t\texceptions = [ exceptions ];\n\t\t}\n\n\t\tconst termRegex = new RegExp(s.escapeRegExp(searchTerm), 'i');\n\t\tconst query = {\n\t\t\t$or: [{\n\t\t\t\tusername: termRegex\n\t\t\t}, {\n\t\t\t\tname: termRegex\n\t\t\t}],\n\t\t\tactive: true,\n\t\t\ttype: {\n\t\t\t\t$in: ['user', 'bot']\n\t\t\t},\n\t\t\t$and: [{\n\t\t\t\tusername: {\n\t\t\t\t\t$exists: true\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\tusername: {\n\t\t\t\t\t$nin: exceptions\n\t\t\t\t}\n\t\t\t}]\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByActiveUsersExcept(searchTerm, exceptions, options) {\n\t\tif (exceptions == null) { exceptions = []; }\n\t\tif (options == null) { options = {}; }\n\t\tif (!_.isArray(exceptions)) {\n\t\t\texceptions = [ exceptions ];\n\t\t}\n\n\t\tconst termRegex = new RegExp(s.escapeRegExp(searchTerm), 'i');\n\n\t\tconst orStmt = _.reduce(RocketChat.settings.get('Accounts_SearchFields').trim().split(','), function(acc, el) {\n\t\t\tacc.push({ [el.trim()]: termRegex });\n\t\t\treturn acc;\n\t\t}, []);\n\t\tconst query = {\n\t\t\t$and: [\n\t\t\t\t{\n\t\t\t\t\tactive: true,\n\t\t\t\t\t$or: orStmt\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tusername: { $exists: true, $nin: exceptions }\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\t// do not use cache\n\t\treturn this._db.find(query, options);\n\t}\n\n\tfindUsersByNameOrUsername(nameOrUsername, options) {\n\t\tconst query = {\n\t\t\tusername: {\n\t\t\t\t$exists: 1\n\t\t\t},\n\n\t\t\t$or: [\n\t\t\t\t{name: nameOrUsername},\n\t\t\t\t{username: nameOrUsername}\n\t\t\t],\n\n\t\t\ttype: {\n\t\t\t\t$in: ['user']\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByUsernameNameOrEmailAddress(usernameNameOrEmailAddress, options) {\n\t\tconst query = {\n\t\t\t$or: [\n\t\t\t\t{name: usernameNameOrEmailAddress},\n\t\t\t\t{username: usernameNameOrEmailAddress},\n\t\t\t\t{'emails.address': usernameNameOrEmailAddress}\n\t\t\t],\n\t\t\ttype: {\n\t\t\t\t$in: ['user', 'bot']\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindLDAPUsers(options) {\n\t\tconst query =\t{ldap: true};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindCrowdUsers(options) {\n\t\tconst query =\t{crowd: true};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tgetLastLogin(options) {\n\t\tif (options == null) { options = {}; }\n\t\tconst query = { lastLogin: { $exists: 1 } };\n\t\toptions.sort = { lastLogin: -1 };\n\t\toptions.limit = 1;\n\t\tconst [user] = this.find(query, options).fetch();\n\t\treturn user && user.lastLogin;\n\t}\n\n\tfindUsersByUsernames(usernames, options) {\n\t\tconst query = {\n\t\t\tusername: {\n\t\t\t\t$in: usernames\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindUsersByIds(ids, options) {\n\t\tconst query = {\n\t\t\t_id: {\n\t\t\t\t$in: ids\n\t\t\t}\n\t\t};\n\t\treturn this.find(query, options);\n\t}\n\n\t// UPDATE\n\taddImportIds(_id, importIds) {\n\t\timportIds = [].concat(importIds);\n\n\t\tconst query =\t{_id};\n\n\t\tconst update = {\n\t\t\t$addToSet: {\n\t\t\t\timportIds: {\n\t\t\t\t\t$each: importIds\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tupdateLastLoginById(_id) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tlastLogin: new Date\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetServiceId(_id, serviceName, serviceId) {\n\t\tconst update =\n\t\t{$set: {}};\n\n\t\tconst serviceIdKey = `services.${ serviceName }.id`;\n\t\tupdate.$set[serviceIdKey] = serviceId;\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetUsername(_id, username) {\n\t\tconst update =\n\t\t{$set: {username}};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetEmail(_id, email) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\temails: [{\n\t\t\t\t\taddress: email,\n\t\t\t\t\tverified: false\n\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetEmailVerified(_id, email) {\n\t\tconst query = {\n\t\t\t_id,\n\t\t\temails: {\n\t\t\t\t$elemMatch: {\n\t\t\t\t\taddress: email,\n\t\t\t\t\tverified: false\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'emails.$.verified': true\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetName(_id, name) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tname\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetCustomFields(_id, fields) {\n\t\tconst values = {};\n\t\tObject.keys(fields).forEach(key => {\n\t\t\tvalues[`customFields.${ key }`] = fields[key];\n\t\t});\n\n\t\tconst update = {$set: values};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetAvatarOrigin(_id, origin) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tavatarOrigin: origin\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tunsetAvatarOrigin(_id) {\n\t\tconst update = {\n\t\t\t$unset: {\n\t\t\t\tavatarOrigin: 1\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetUserActive(_id, active) {\n\t\tif (active == null) { active = true; }\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tactive\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetAllUsersActive(active) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tactive\n\t\t\t}\n\t\t};\n\n\t\treturn this.update({}, update, { multi: true });\n\t}\n\n\tunsetLoginTokens(_id) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'services.resume.loginTokens' : []\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tunsetRequirePasswordChange(_id) {\n\t\tconst update = {\n\t\t\t$unset: {\n\t\t\t\t'requirePasswordChange' : true,\n\t\t\t\t'requirePasswordChangeReason' : true\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tresetPasswordAndSetRequirePasswordChange(_id, requirePasswordChange, requirePasswordChangeReason) {\n\t\tconst update = {\n\t\t\t$unset: {\n\t\t\t\t'services.password': 1\n\t\t\t},\n\t\t\t$set: {\n\t\t\t\trequirePasswordChange,\n\t\t\t\trequirePasswordChangeReason\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetLanguage(_id, language) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tlanguage\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetProfile(_id, profile) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'settings.profile': profile\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tclearSettings(_id) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tsettings: {}\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetPreferences(_id, preferences) {\n\t\tconst settings = Object.assign(\n\t\t\t{},\n\t\t\t...Object.keys(preferences).map(key => {\n\t\t\t\treturn {[`settings.preferences.${ key }`]: preferences[key]};\n\t\t\t})\n\t\t);\n\n\t\tconst update = {\n\t\t\t$set: settings\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetUtcOffset(_id, utcOffset) {\n\t\tconst query = {\n\t\t\t_id,\n\t\t\tutcOffset: {\n\t\t\t\t$ne: utcOffset\n\t\t\t}\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tutcOffset\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsaveUserById(_id, data) {\n\t\tconst setData = {};\n\t\tconst unsetData = {};\n\n\t\tif (data.name != null) {\n\t\t\tif (!_.isEmpty(s.trim(data.name))) {\n\t\t\t\tsetData.name = s.trim(data.name);\n\t\t\t} else {\n\t\t\t\tunsetData.name = 1;\n\t\t\t}\n\t\t}\n\n\t\tif (data.email != null) {\n\t\t\tif (!_.isEmpty(s.trim(data.email))) {\n\t\t\t\tsetData.emails = [{address: s.trim(data.email)}];\n\t\t\t} else {\n\t\t\t\tunsetData.emails = 1;\n\t\t\t}\n\t\t}\n\n\t\tif (data.phone != null) {\n\t\t\tif (!_.isEmpty(s.trim(data.phone))) {\n\t\t\t\tsetData.phone = [{phoneNumber: s.trim(data.phone)}];\n\t\t\t} else {\n\t\t\t\tunsetData.phone = 1;\n\t\t\t}\n\t\t}\n\n\t\tconst update = {};\n\n\t\tif (!_.isEmpty(setData)) {\n\t\t\tupdate.$set = setData;\n\t\t}\n\n\t\tif (!_.isEmpty(unsetData)) {\n\t\t\tupdate.$unset = unsetData;\n\t\t}\n\n\t\tif (_.isEmpty(update)) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn this.update({ _id }, update);\n\t}\n\n\tsetReason(_id, reason) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\treason\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tunsetReason(_id) {\n\t\tconst update = {\n\t\t\t$unset: {\n\t\t\t\treason: true\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\taddBannerById(_id, banner) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t[`banners.${ banner.id }`]: banner\n\t\t\t}\n\t\t};\n\n\t\treturn this.update({ _id }, update);\n\t}\n\n\tremoveBannerById(_id, banner) {\n\t\tconst update = {\n\t\t\t$unset: {\n\t\t\t\t[`banners.${ banner.id }`]: true\n\t\t\t}\n\t\t};\n\n\t\treturn this.update({ _id }, update);\n\t}\n\n\t// INSERT\n\tcreate(data) {\n\t\tconst user = {\n\t\t\tcreatedAt: new Date,\n\t\t\tavatarOrigin: 'none'\n\t\t};\n\n\t\t_.extend(user, data);\n\n\t\treturn this.insert(user);\n\t}\n\n\n\t// REMOVE\n\tremoveById(_id) {\n\t\treturn this.remove(_id);\n\t}\n\n\t/*\nFind users to send a message by email if:\n- he is not online\n- has a verified email\n- has not disabled email notifications\n- `active` is equal to true (false means they were deactivated and can't login)\n*/\n\tgetUsersToSendOfflineEmail(usersIds) {\n\t\tconst query = {\n\t\t\t_id: {\n\t\t\t\t$in: usersIds\n\t\t\t},\n\t\t\tactive: true,\n\t\t\tstatus: 'offline',\n\t\t\tstatusConnection: {\n\t\t\t\t$ne: 'online'\n\t\t\t},\n\t\t\t'emails.verified': true\n\t\t};\n\n\t\tconst options = {\n\t\t\tfields: {\n\t\t\t\tname: 1,\n\t\t\t\tusername: 1,\n\t\t\t\temails: 1,\n\t\t\t\t'settings.preferences.emailNotificationMode': 1,\n\t\t\t\tlanguage: 1\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n}\n\nRocketChat.models.Users = new ModelUsers(Meteor.users, true);\n","import _ from 'underscore';\n\nRocketChat.models.ExportOperations = new class ModelExportOperations extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper('export_operations');\n\n\t\tthis.tryEnsureIndex({ 'userId': 1 });\n\t\tthis.tryEnsureIndex({ 'status': 1 });\n\t}\n\n\t// FIND\n\tfindById(id) {\n\t\tconst query = {_id: id};\n\n\t\treturn this.find(query);\n\t}\n\n\tfindLastOperationByUser(userId, fullExport = false, options = {}) {\n\t\tconst query = {\n\t\t\tuserId,\n\t\t\tfullExport\n\t\t};\n\n\t\toptions.sort = {'createdAt' : -1};\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindPendingByUser(userId, options) {\n\t\tconst query = {\n\t\t\tuserId,\n\t\t\tstatus: {\n\t\t\t\t$nin: ['completed']\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindAllPending(options) {\n\t\tconst query = {\n\t\t\tstatus: { $nin: ['completed'] }\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\t// UPDATE\n\tupdateOperation(data) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\troomList: data.roomList,\n\t\t\t\tstatus: data.status,\n\t\t\t\tfileList: data.fileList,\n\t\t\t\tgeneratedFile: data.generatedFile\n\t\t\t}\n\t\t};\n\n\t\treturn this.update(data._id, update);\n\t}\n\n\n\t// INSERT\n\tcreate(data) {\n\t\tconst exportOperation = {\n\t\t\tcreatedAt: new Date\n\t\t};\n\n\t\t_.extend(exportOperation, data);\n\n\t\treturn this.insert(exportOperation);\n\t}\n\n\n\t// REMOVE\n\tremoveById(_id) {\n\t\treturn this.remove(_id);\n\t}\n};\n","import _ from 'underscore';\n\nRocketChat.models.UserDataFiles = new class ModelUserDataFiles extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper('user_data_files');\n\n\t\tthis.tryEnsureIndex({ 'userId': 1 });\n\t}\n\n\t// FIND\n\tfindById(id) {\n\t\tconst query = {_id: id};\n\t\treturn this.find(query);\n\t}\n\n\tfindLastFileByUser(userId, options = {}) {\n\t\tconst query = {\n\t\t\tuserId\n\t\t};\n\n\t\toptions.sort = {'_updatedAt' : -1};\n\t\treturn this.findOne(query, options);\n\t}\n\n\t// INSERT\n\tcreate(data) {\n\t\tconst userDataFile = {\n\t\t\tcreatedAt: new Date\n\t\t};\n\n\t\t_.extend(userDataFile, data);\n\n\t\treturn this.insert(userDataFile);\n\t}\n\n\t// REMOVE\n\tremoveById(_id) {\n\t\treturn this.remove(_id);\n\t}\n};\n","/* eslint new-cap: 0 */\nimport _ from 'underscore';\nimport loki from 'lokijs';\nimport {EventEmitter} from 'events';\nimport objectPath from 'object-path';\n\nconst logger = new Logger('BaseCache');\n\nconst lokiEq = loki.LokiOps.$eq;\nconst lokiNe = loki.LokiOps.$ne;\n\nloki.LokiOps.$eq = function(a, b) {\n\tif (Array.isArray(a)) {\n\t\treturn a.indexOf(b) !== -1;\n\t}\n\treturn lokiEq(a, b);\n};\n\nloki.LokiOps.$ne = function(a, b) {\n\tif (Array.isArray(a)) {\n\t\treturn a.indexOf(b) === -1;\n\t}\n\treturn lokiNe(a, b);\n};\n\nconst lokiIn = loki.LokiOps.$in;\nloki.LokiOps.$in = function(a, b) {\n\tif (Array.isArray(a)) {\n\t\treturn a.some(subA => lokiIn(subA, b));\n\t}\n\treturn lokiIn(a, b);\n};\n\nloki.LokiOps.$nin = function(a, b) {\n\treturn !loki.LokiOps.$in(a, b);\n};\n\nloki.LokiOps.$all = function(a, b) {\n\treturn b.every(subB => a.includes(subB));\n};\n\nloki.LokiOps.$exists = function(a, b) {\n\tif (b) {\n\t\treturn loki.LokiOps.$ne(a, undefined);\n\t}\n\n\treturn loki.LokiOps.$eq(a, undefined);\n};\n\nloki.LokiOps.$elemMatch = function(a, b) {\n\treturn _.findWhere(a, b);\n};\n\nconst ignore = [\n\t'emit',\n\t'load',\n\t'on',\n\t'addToAllIndexes'\n];\n\nfunction traceMethodCalls(target) {\n\ttarget._stats = {};\n\n\tfor (const property in target) {\n\t\tif (typeof target[property] === 'function' && ignore.indexOf(property) === -1) {\n\t\t\ttarget._stats[property] = {\n\t\t\t\tcalls: 0,\n\t\t\t\ttime: 0,\n\t\t\t\tavg: 0\n\t\t\t};\n\t\t\tconst origMethod = target[property];\n\t\t\ttarget[property] = function(...args) {\n\n\t\t\t\tif (target.loaded !== true) {\n\t\t\t\t\treturn origMethod.apply(target, args);\n\t\t\t\t}\n\n\t\t\t\tconst startTime = RocketChat.statsTracker.now();\n\t\t\t\tconst result = origMethod.apply(target, args);\n\t\t\t\tconst time = Math.round(RocketChat.statsTracker.now() - startTime) / 1000;\n\t\t\t\ttarget._stats[property].time += time;\n\t\t\t\ttarget._stats[property].calls++;\n\t\t\t\ttarget._stats[property].avg = target._stats[property].time / target._stats[property].calls;\n\n\t\t\t\treturn result;\n\t\t\t};\n\t\t}\n\t}\n\n\tsetInterval(function() {\n\t\tfor (const property in target._stats) {\n\t\t\tif (target._stats.hasOwnProperty(property) && target._stats[property].time > 0) {\n\t\t\t\tconst tags = [`property:${ property }`, `collection:${ target.collectionName }`];\n\t\t\t\tRocketChat.statsTracker.timing('cache.methods.time', target._stats[property].avg, tags);\n\t\t\t\tRocketChat.statsTracker.increment('cache.methods.totalTime', target._stats[property].time, tags);\n\t\t\t\tRocketChat.statsTracker.increment('cache.methods.count', target._stats[property].calls, tags);\n\t\t\t\ttarget._stats[property].avg = 0;\n\t\t\t\ttarget._stats[property].time = 0;\n\t\t\t\ttarget._stats[property].calls = 0;\n\t\t\t}\n\t\t}\n\t}, 10000);\n\n\ttarget._getStatsAvg = function() {\n\t\tconst stats = [];\n\t\tfor (const property in target._stats) {\n\t\t\tif (target._stats.hasOwnProperty(property)) {\n\t\t\t\tstats.push([Math.round(target._stats[property].avg*100)/100, property]);\n\t\t\t}\n\t\t}\n\t\treturn _.sortBy(stats, function(record) {\n\t\t\treturn record[0];\n\t\t});\n\t};\n}\n\nclass Adapter {\n\tloadDatabase(/*dbname, callback*/) {}\n\tsaveDatabase(/*dbname, dbstring, callback*/) {}\n\tdeleteDatabase(/*dbname, callback*/) {}\n}\n\nconst db = new loki('rocket.chat.json', {adapter: Adapter});\n\nclass ModelsBaseCache extends EventEmitter {\n\tconstructor(model) {\n\t\tsuper();\n\n\t\ttraceMethodCalls(this);\n\n\t\tthis.indexes = {};\n\t\tthis.ignoreUpdatedFields = ['_updatedAt'];\n\n\t\tthis.query = {};\n\t\tthis.options = {};\n\n\t\tthis.ensureIndex('_id', 'unique');\n\n\t\tthis.joins = {};\n\n\t\tthis.on('inserted', (...args) => { this.emit('changed', 'inserted', ...args); });\n\t\tthis.on('removed', (...args) => { this.emit('changed', 'removed', ...args); });\n\t\tthis.on('updated', (...args) => { this.emit('changed', 'updated', ...args); });\n\n\t\tthis.on('beforeinsert', (...args) => { this.emit('beforechange', 'inserted', ...args); });\n\t\tthis.on('beforeremove', (...args) => { this.emit('beforechange', 'removed', ...args); });\n\t\tthis.on('beforeupdate', (...args) => { this.emit('beforechange', 'updated', ...args); });\n\n\t\tthis.on('inserted', (...args) => { this.emit('sync', 'inserted', ...args); });\n\t\tthis.on('updated', (...args) => { this.emit('sync', 'updated', ...args); });\n\t\tthis.on('beforeremove', (...args) => { this.emit('sync', 'removed', ...args); });\n\n\t\tthis.db = db;\n\n\t\tthis.model = model;\n\n\t\tthis.collectionName = this.model._db.collectionName;\n\t\tthis.collection = this.db.addCollection(this.collectionName);\n\t}\n\n\thasOne(join, {field, link}) {\n\t\tthis.join({join, field, link, multi: false});\n\t}\n\n\thasMany(join, {field, link}) {\n\t\tthis.join({join, field, link, multi: true});\n\t}\n\n\tjoin({join, field, link, multi}) {\n\t\tif (!RocketChat.models[join]) {\n\t\t\tconsole.log(`Invalid cache model ${ join }`);\n\t\t\treturn;\n\t\t}\n\n\t\tRocketChat.models[join].cache.on('inserted', (record) => {\n\t\t\tthis.processRemoteJoinInserted({join, field, link, multi, record});\n\t\t});\n\n\t\tRocketChat.models[join].cache.on('beforeupdate', (record, diff) => {\n\t\t\tif (diff[link.remote]) {\n\t\t\t\tthis.processRemoteJoinRemoved({join, field, link, multi, record});\n\t\t\t}\n\t\t});\n\n\t\tRocketChat.models[join].cache.on('updated', (record, diff) => {\n\t\t\tif (diff[link.remote]) {\n\t\t\t\tthis.processRemoteJoinInserted({join, field, link, multi, record});\n\t\t\t}\n\t\t});\n\n\t\tRocketChat.models[join].cache.on('removed', (record) => {\n\t\t\tthis.processRemoteJoinRemoved({join, field, link, multi, record});\n\t\t});\n\n\t\tthis.on('inserted', (localRecord) => {\n\t\t\tthis.processLocalJoinInserted({join, field, link, multi, localRecord});\n\t\t});\n\n\t\tthis.on('beforeupdate', (localRecord, diff) => {\n\t\t\tif (diff[link.local]) {\n\t\t\t\tif (multi === true) {\n\t\t\t\t\tlocalRecord[field] = [];\n\t\t\t\t} else {\n\t\t\t\t\tlocalRecord[field] = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.on('updated', (localRecord, diff) => {\n\t\t\tif (diff[link.local]) {\n\t\t\t\tthis.processLocalJoinInserted({join, field, link, multi, localRecord});\n\t\t\t}\n\t\t});\n\t}\n\n\tprocessRemoteJoinInserted({field, link, multi, record}) {\n\t\tlet localRecords = this._findByIndex(link.local, objectPath.get(record, link.remote));\n\n\t\tif (!localRecords) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Array.isArray(localRecords)) {\n\t\t\tlocalRecords = [localRecords];\n\t\t}\n\n\t\tfor (let i = 0; i < localRecords.length; i++) {\n\t\t\tconst localRecord = localRecords[i];\n\t\t\tif (multi === true && !localRecord[field]) {\n\t\t\t\tlocalRecord[field] = [];\n\t\t\t}\n\n\t\t\tif (typeof link.where === 'function' && link.where(localRecord, record) === false) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet mutableRecord = record;\n\n\t\t\tif (typeof link.transform === 'function') {\n\t\t\t\tmutableRecord = link.transform(localRecord, mutableRecord);\n\t\t\t}\n\n\t\t\tif (multi === true) {\n\t\t\t\tlocalRecord[field].push(mutableRecord);\n\t\t\t} else {\n\t\t\t\tlocalRecord[field] = mutableRecord;\n\t\t\t}\n\n\t\t\tthis.emit(`join:${ field }:inserted`, localRecord, mutableRecord);\n\t\t\tthis.emit(`join:${ field }:changed`, 'inserted', localRecord, mutableRecord);\n\t\t}\n\t}\n\n\tprocessLocalJoinInserted({join, field, link, multi, localRecord}) {\n\t\tlet records = RocketChat.models[join].cache._findByIndex(link.remote, objectPath.get(localRecord, link.local));\n\n\t\tif (!Array.isArray(records)) {\n\t\t\trecords = [records];\n\t\t}\n\n\t\tfor (let i = 0; i < records.length; i++) {\n\t\t\tlet record = records[i];\n\n\t\t\tif (typeof link.where === 'function' && link.where(localRecord, record) === false) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (typeof link.transform === 'function') {\n\t\t\t\trecord = link.transform(localRecord, record);\n\t\t\t}\n\n\t\t\tif (multi === true) {\n\t\t\t\tlocalRecord[field].push(record);\n\t\t\t} else {\n\t\t\t\tlocalRecord[field] = record;\n\t\t\t}\n\n\t\t\tthis.emit(`join:${ field }:inserted`, localRecord, record);\n\t\t\tthis.emit(`join:${ field }:changed`, 'inserted', localRecord, record);\n\t\t}\n\t}\n\n\tprocessRemoteJoinRemoved({field, link, multi, record}) {\n\t\tlet localRecords = this._findByIndex(link.local, objectPath.get(record, link.remote));\n\n\t\tif (!localRecords) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Array.isArray(localRecords)) {\n\t\t\tlocalRecords = [localRecords];\n\t\t}\n\n\t\tfor (let i = 0; i < localRecords.length; i++) {\n\t\t\tconst localRecord = localRecords[i];\n\n\t\t\tif (multi === true) {\n\t\t\t\tif (Array.isArray(localRecord[field])) {\n\t\t\t\t\tif (typeof link.remove === 'function') {\n\t\t\t\t\t\tlink.remove(localRecord[field], record);\n\t\t\t\t\t} else if (localRecord[field].indexOf(record) > -1) {\n\t\t\t\t\t\tlocalRecord[field].splice(localRecord[field].indexOf(record), 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlocalRecord[field] = undefined;\n\t\t\t}\n\n\t\t\tthis.emit(`join:${ field }:removed`, localRecord, record);\n\t\t\tthis.emit(`join:${ field }:changed`, 'removed', localRecord, record);\n\t\t}\n\t}\n\n\tensureIndex(fields, type='array') {\n\t\tif (!Array.isArray(fields)) {\n\t\t\tfields = [fields];\n\t\t}\n\n\t\tthis.indexes[fields.join(',')] = {\n\t\t\ttype,\n\t\t\tfields,\n\t\t\tdata: {}\n\t\t};\n\t}\n\n\taddToAllIndexes(record) {\n\t\tfor (const indexName in this.indexes) {\n\t\t\tif (this.indexes.hasOwnProperty(indexName)) {\n\t\t\t\tthis.addToIndex(indexName, record);\n\t\t\t}\n\t\t}\n\t}\n\n\taddToIndex(indexName, record) {\n\t\tconst index = this.indexes[indexName];\n\t\tif (!index) {\n\t\t\tconsole.error(`Index not defined ${ indexName }`);\n\t\t\treturn;\n\t\t}\n\n\t\tconst keys = [];\n\t\tfor (const field of index.fields) {\n\t\t\tkeys.push(objectPath.get(record, field));\n\t\t}\n\t\tconst key = keys.join('|');\n\n\t\tif (index.type === 'unique') {\n\t\t\tindex.data[key] = record;\n\t\t\treturn;\n\t\t}\n\n\t\tif (index.type === 'array') {\n\t\t\tif (!index.data[key]) {\n\t\t\t\tindex.data[key] = [];\n\t\t\t}\n\t\t\tindex.data[key].push(record);\n\t\t\treturn;\n\t\t}\n\t}\n\n\tremoveFromAllIndexes(record) {\n\t\tfor (const indexName in this.indexes) {\n\t\t\tif (this.indexes.hasOwnProperty(indexName)) {\n\t\t\t\tthis.removeFromIndex(indexName, record);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveFromIndex(indexName, record) {\n\t\tconst index = this.indexes[indexName];\n\t\tif (!this.indexes[indexName]) {\n\t\t\tconsole.error(`Index not defined ${ indexName }`);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!index.data) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet key = [];\n\t\tfor (const field of index.fields) {\n\t\t\tkey.push(objectPath.get(record, field));\n\t\t}\n\t\tkey = key.join('|');\n\n\t\tif (index.type === 'unique') {\n\t\t\tindex.data[key] = undefined;\n\t\t\treturn;\n\t\t}\n\n\t\tif (index.type === 'array') {\n\t\t\tif (!index.data[key]) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst i = index.data[key].indexOf(record);\n\t\t\tif (i > -1) {\n\t\t\t\tindex.data[key].splice(i, 1);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n\n\t_findByIndex(index, keys) {\n\t\tconst key = [].concat(keys).join('|');\n\t\tif (!this.indexes[index]) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.indexes[index].data) {\n\t\t\tconst result = this.indexes[index].data[key];\n\t\t\tif (result) {\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\n\t\tif (this.indexes[index].type === 'array') {\n\t\t\treturn [];\n\t\t}\n\t}\n\n\tfindByIndex(index, keys, options={}) {\n\t\treturn {\n\t\t\tfetch: () => {\n\t\t\t\treturn this.processQueryOptionsOnResult(this._findByIndex(index, keys), options);\n\t\t\t},\n\n\t\t\tcount: () => {\n\t\t\t\tconst records = this.findByIndex(index, keys, options).fetch();\n\t\t\t\tif (Array.isArray(records)) {\n\t\t\t\t\treturn records.length;\n\t\t\t\t}\n\t\t\t\treturn !records ? 0 : 1;\n\t\t\t},\n\n\t\t\tforEach: (fn) => {\n\t\t\t\tconst records = this.findByIndex(index, keys, options).fetch();\n\t\t\t\tif (Array.isArray(records)) {\n\t\t\t\t\treturn records.forEach(fn);\n\t\t\t\t}\n\t\t\t\tif (records) {\n\t\t\t\t\treturn fn(records);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tload() {\n\t\tif (this.model._useCache === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tconsole.log('Will load cache for', this.collectionName);\n\t\tthis.emit('beforeload');\n\t\tthis.loaded = false;\n\t\tconst time = RocketChat.statsTracker.now();\n\t\tconst data = this.model.db.find(this.query, this.options).fetch();\n\t\tfor (let i=0; i < data.length; i++) {\n\t\t\tthis.insert(data[i]);\n\t\t}\n\t\tconsole.log(String(data.length), 'records load from', this.collectionName);\n\t\tRocketChat.statsTracker.timing('cache.load', RocketChat.statsTracker.now() - time, [`collection:${ this.collectionName }`]);\n\n\t\tthis.startSync();\n\t\tthis.loaded = true;\n\t\tthis.emit('afterload');\n\t}\n\n\tstartSync() {\n\t\tif (this.model._useCache === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.model._db.on('change', ({action, id, data/*, oplog*/}) => {\n\t\t\tswitch (action) {\n\t\t\t\tcase 'insert':\n\t\t\t\t\tdata._id = id;\n\t\t\t\t\tthis.insert(data);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'remove':\n\t\t\t\t\tthis.removeById(id);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'update:record':\n\t\t\t\t\tthis.updateDiffById(id, data);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'update:diff':\n\t\t\t\t\tthis.updateDiffById(id, data);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'update:query':\n\t\t\t\t\tthis.update(data.query, data.update, data.options);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t}\n\n\tprocessQueryOptionsOnResult(result, options={}) {\n\t\tif (result === undefined || result === null) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (Array.isArray(result)) {\n\t\t\tif (options.sort) {\n\t\t\t\tresult = result.sort((a, b) => {\n\t\t\t\t\tlet r = 0;\n\t\t\t\t\tfor (const field in options.sort) {\n\t\t\t\t\t\tif (options.sort.hasOwnProperty(field)) {\n\t\t\t\t\t\t\tconst direction = options.sort[field];\n\t\t\t\t\t\t\tlet valueA;\n\t\t\t\t\t\t\tlet valueB;\n\t\t\t\t\t\t\tif (field.indexOf('.') > -1) {\n\t\t\t\t\t\t\t\tvalueA = objectPath.get(a, field);\n\t\t\t\t\t\t\t\tvalueB = objectPath.get(b, field);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvalueA = a[field];\n\t\t\t\t\t\t\t\tvalueB = b[field];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (valueA > valueB) {\n\t\t\t\t\t\t\t\tr = direction;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (valueA < valueB) {\n\t\t\t\t\t\t\t\tr = -direction;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn r;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (typeof options.skip === 'number') {\n\t\t\t\tresult.splice(0, options.skip);\n\t\t\t}\n\n\t\t\tif (typeof options.limit === 'number' && options.limit !== 0) {\n\t\t\t\tresult.splice(options.limit);\n\t\t\t}\n\t\t}\n\n\t\tif (!options.fields) {\n\t\t\toptions.fields = {};\n\t\t}\n\n\t\tconst fieldsToRemove = [];\n\t\tconst fieldsToGet = [];\n\n\t\tfor (const field in options.fields) {\n\t\t\tif (options.fields.hasOwnProperty(field)) {\n\t\t\t\tif (options.fields[field] === 0) {\n\t\t\t\t\tfieldsToRemove.push(field);\n\t\t\t\t} else if (options.fields[field] === 1) {\n\t\t\t\t\tfieldsToGet.push(field);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (fieldsToRemove.length > 0 && fieldsToGet.length > 0) {\n\t\t\tconsole.warn('Can\\'t mix remove and get fields');\n\t\t\tfieldsToRemove.splice(0, fieldsToRemove.length);\n\t\t}\n\n\t\tif (fieldsToGet.length > 0 && fieldsToGet.indexOf('_id') === -1) {\n\t\t\tfieldsToGet.push('_id');\n\t\t}\n\n\t\tconst pickFields = (obj, fields) => {\n\t\t\tconst picked = {};\n\t\t\tfields.forEach((field) => {\n\t\t\t\tif (field.indexOf('.') !== -1) {\n\t\t\t\t\tobjectPath.set(picked, field, objectPath.get(obj, field));\n\t\t\t\t} else {\n\t\t\t\t\tpicked[field] = obj[field];\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn picked;\n\t\t};\n\n\t\tif (fieldsToRemove.length > 0 || fieldsToGet.length > 0) {\n\t\t\tif (Array.isArray(result)) {\n\t\t\t\tresult = result.map((record) => {\n\t\t\t\t\tif (fieldsToRemove.length > 0) {\n\t\t\t\t\t\treturn _.omit(record, ...fieldsToRemove);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (fieldsToGet.length > 0) {\n\t\t\t\t\t\treturn pickFields(record, fieldsToGet);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tif (fieldsToRemove.length > 0) {\n\t\t\t\t\treturn _.omit(result, ...fieldsToRemove);\n\t\t\t\t}\n\n\t\t\t\tif (fieldsToGet.length > 0) {\n\t\t\t\t\treturn pickFields(result, fieldsToGet);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprocessQuery(query, parentField) {\n\t\tif (!query) {\n\t\t\treturn query;\n\t\t}\n\n\t\tif (Match.test(query, String)) {\n\t\t\treturn {\n\t\t\t\t_id: query\n\t\t\t};\n\t\t}\n\n\t\tif (Object.keys(query).length > 1 && parentField !== '$elemMatch') {\n\t\t\tconst and = [];\n\t\t\tfor (const field in query) {\n\t\t\t\tif (query.hasOwnProperty(field)) {\n\t\t\t\t\tand.push({\n\t\t\t\t\t\t[field]: query[field]\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tquery = {$and: and};\n\t\t}\n\n\t\tfor (const field in query) {\n\t\t\tif (query.hasOwnProperty(field)) {\n\t\t\t\tconst value = query[field];\n\t\t\t\tif (value instanceof RegExp && field !== '$regex') {\n\t\t\t\t\tquery[field] = {\n\t\t\t\t\t\t$regex: value\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (field === '$and' || field === '$or') {\n\t\t\t\t\tquery[field] = value.map((subValue) => {\n\t\t\t\t\t\treturn this.processQuery(subValue, field);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (Match.test(value, Object) && Object.keys(value).length > 0) {\n\t\t\t\t\tquery[field] = this.processQuery(value, field);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn query;\n\t}\n\n\tfind(query, options={}) {\n\t\treturn {\n\t\t\tfetch: () => {\n\t\t\t\ttry {\n\t\t\t\t\tquery = this.processQuery(query);\n\t\t\t\t\treturn this.processQueryOptionsOnResult(this.collection.find(query), options);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('Exception on cache find for', this.collectionName);\n\t\t\t\t\tconsole.error('Query:', JSON.stringify(query, null, 2));\n\t\t\t\t\tconsole.error('Options:', JSON.stringify(options, null, 2));\n\t\t\t\t\tconsole.error(e.stack);\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tcount: () => {\n\t\t\t\ttry {\n\t\t\t\t\tquery = this.processQuery(query);\n\t\t\t\t\tconst { limit, skip } = options;\n\t\t\t\t\treturn this.processQueryOptionsOnResult(this.collection.find(query), { limit, skip }).length;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('Exception on cache find for', this.collectionName);\n\t\t\t\t\tconsole.error('Query:', JSON.stringify(query, null, 2));\n\t\t\t\t\tconsole.error('Options:', JSON.stringify(options, null, 2));\n\t\t\t\t\tconsole.error(e.stack);\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tforEach: (fn) => {\n\t\t\t\treturn this.find(query, options).fetch().forEach(fn);\n\t\t\t},\n\n\t\t\tobserve: (obj) => {\n\t\t\t\tlogger.debug(this.collectionName, 'Falling back observe to model with query:', query);\n\t\t\t\treturn this.model.db.find(...arguments).observe(obj);\n\t\t\t},\n\n\t\t\tobserveChanges: (obj) => {\n\t\t\t\tlogger.debug(this.collectionName, 'Falling back observeChanges to model with query:', query);\n\t\t\t\treturn this.model.db.find(...arguments).observeChanges(obj);\n\t\t\t},\n\n\t\t\t_publishCursor: (cursor, sub, collection) => {\n\t\t\t\tlogger.debug(this.collectionName, 'Falling back _publishCursor to model with query:', query);\n\t\t\t\treturn this.model.db.find(...arguments)._publishCursor(cursor, sub, collection);\n\t\t\t}\n\t\t};\n\t}\n\n\tfindOne(query, options) {\n\t\ttry {\n\t\t\tquery = this.processQuery(query);\n\t\t\treturn this.processQueryOptionsOnResult(this.collection.findOne(query), options);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on cache findOne for', this.collectionName);\n\t\t\tconsole.error('Query:', JSON.stringify(query, null, 2));\n\t\t\tconsole.error('Options:', JSON.stringify(options, null, 2));\n\t\t\tconsole.error(e.stack);\n\t\t\tthrow e;\n\t\t}\n\t}\n\n\tfindOneById(_id, options) {\n\t\treturn this.findByIndex('_id', _id, options).fetch();\n\t}\n\n\tfindOneByIds(ids, options) {\n\t\tconst query = this.processQuery({ _id: { $in: ids }});\n\t\treturn this.processQueryOptionsOnResult(this.collection.findOne(query), options);\n\t}\n\n\tfindWhere(query, options) {\n\t\tquery = this.processQuery(query);\n\t\treturn this.processQueryOptionsOnResult(this.collection.findWhere(query), options);\n\t}\n\n\taddDynamicView() {\n\t\treturn this.collection.addDynamicView(...arguments);\n\t}\n\n\tgetDynamicView() {\n\t\treturn this.collection.getDynamicView(...arguments);\n\t}\n\n\tinsert(record) {\n\t\tif (Array.isArray(record)) {\n\t\t\tfor (const item of record) {\n\t\t\t\tthis.insert(item);\n\t\t\t}\n\t\t} else {\n\t\t\t// TODO remove - ignore updates in room.usernames\n\t\t\tif (this.collectionName === 'rocketchat_room' && record.usernames) {\n\t\t\t\tdelete record.usernames;\n\t\t\t}\n\t\t\tthis.emit('beforeinsert', record);\n\t\t\tthis.addToAllIndexes(record);\n\t\t\tthis.collection.insert(record);\n\t\t\tthis.emit('inserted', record);\n\t\t}\n\t}\n\n\tupdateDiffById(id, diff) {\n\t\t// TODO remove - ignore updates in room.usernames\n\t\tif (this.collectionName === 'rocketchat_room' && diff.usernames) {\n\t\t\tdelete diff.usernames;\n\t\t}\n\n\t\tconst record = this._findByIndex('_id', id);\n\t\tif (!record) {\n\t\t\tconsole.error('Cache.updateDiffById: No record', this.collectionName, id, diff);\n\t\t\treturn;\n\t\t}\n\t\tthis.removeFromAllIndexes(record);\n\n\t\tconst updatedFields = _.without(Object.keys(diff), ...this.ignoreUpdatedFields);\n\n\t\tif (updatedFields.length > 0) {\n\t\t\tthis.emit('beforeupdate', record, diff);\n\t\t}\n\n\t\tfor (const key in diff) {\n\t\t\tif (diff.hasOwnProperty(key)) {\n\t\t\t\tobjectPath.set(record, key, diff[key]);\n\t\t\t}\n\t\t}\n\n\t\tthis.collection.update(record);\n\t\tthis.addToAllIndexes(record);\n\n\t\tif (updatedFields.length > 0) {\n\t\t\tthis.emit('updated', record, diff);\n\t\t}\n\t}\n\n\tupdateRecord(record, update) {\n\t\t// TODO remove - ignore updates in room.usernames\n\t\tif (this.collectionName === 'rocketchat_room' && (record.usernames || (record.$set && record.$set.usernames))) {\n\t\t\tdelete record.usernames;\n\t\t\tif (record.$set && record.$set.usernames) {\n\t\t\t\tdelete record.$set.usernames;\n\t\t\t}\n\t\t}\n\n\t\tthis.removeFromAllIndexes(record);\n\n\t\tconst topLevelFields = Object.keys(update).map(field => field.split('.')[0]);\n\t\tconst updatedFields = _.without(topLevelFields, ...this.ignoreUpdatedFields);\n\n\t\tif (updatedFields.length > 0) {\n\t\t\tthis.emit('beforeupdate', record, record);\n\t\t}\n\n\t\tif (update.$set) {\n\t\t\t_.each(update.$set, (value, field) => {\n\t\t\t\tobjectPath.set(record, field, value);\n\t\t\t});\n\t\t}\n\n\t\tif (update.$unset) {\n\t\t\t_.each(update.$unset, (value, field) => {\n\t\t\t\tobjectPath.del(record, field);\n\t\t\t});\n\t\t}\n\n\t\tif (update.$min) {\n\t\t\t_.each(update.$min, (value, field) => {\n\t\t\t\tconst curValue = objectPath.get(record, field);\n\t\t\t\tif (curValue === undefined || value < curValue) {\n\t\t\t\t\tobjectPath.set(record, field, value);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (update.$max) {\n\t\t\t_.each(update.$max, (value, field) => {\n\t\t\t\tconst curValue = objectPath.get(record, field);\n\t\t\t\tif (curValue === undefined || value > curValue) {\n\t\t\t\t\tobjectPath.set(record, field, value);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (update.$inc) {\n\t\t\t_.each(update.$inc, (value, field) => {\n\t\t\t\tlet curValue = objectPath.get(record, field);\n\t\t\t\tif (curValue === undefined) {\n\t\t\t\t\tcurValue = value;\n\t\t\t\t} else {\n\t\t\t\t\tcurValue += value;\n\t\t\t\t}\n\t\t\t\tobjectPath.set(record, field, curValue);\n\t\t\t});\n\t\t}\n\n\t\tif (update.$mul) {\n\t\t\t_.each(update.$mul, (value, field) => {\n\t\t\t\tlet curValue = objectPath.get(record, field);\n\t\t\t\tif (curValue === undefined) {\n\t\t\t\t\tcurValue = 0;\n\t\t\t\t} else {\n\t\t\t\t\tcurValue *= value;\n\t\t\t\t}\n\t\t\t\tobjectPath.set(record, field, curValue);\n\t\t\t});\n\t\t}\n\n\t\tif (update.$rename) {\n\t\t\t_.each(update.$rename, (value, field) => {\n\t\t\t\tconst curValue = objectPath.get(record, field);\n\t\t\t\tif (curValue !== undefined) {\n\t\t\t\t\tobjectPath.set(record, value, curValue);\n\t\t\t\t\tobjectPath.del(record, field);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (update.$pullAll) {\n\t\t\t_.each(update.$pullAll, (value, field) => {\n\t\t\t\tlet curValue = objectPath.get(record, field);\n\t\t\t\tif (Array.isArray(curValue)) {\n\t\t\t\t\tcurValue = _.difference(curValue, value);\n\t\t\t\t\tobjectPath.set(record, field, curValue);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (update.$pop) {\n\t\t\t_.each(update.$pop, (value, field) => {\n\t\t\t\tconst curValue = objectPath.get(record, field);\n\t\t\t\tif (Array.isArray(curValue)) {\n\t\t\t\t\tif (value === -1) {\n\t\t\t\t\t\tcurValue.shift();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurValue.pop();\n\t\t\t\t\t}\n\t\t\t\t\tobjectPath.set(record, field, curValue);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (update.$addToSet) {\n\t\t\t_.each(update.$addToSet, (value, field) => {\n\t\t\t\tlet curValue = objectPath.get(record, field);\n\t\t\t\tif (curValue === undefined) {\n\t\t\t\t\tcurValue = [];\n\t\t\t\t}\n\t\t\t\tif (Array.isArray(curValue)) {\n\t\t\t\t\tconst length = curValue.length;\n\n\t\t\t\t\tif (value && value.$each && Array.isArray(value.$each)) {\n\t\t\t\t\t\tfor (const valueItem of value.$each) {\n\t\t\t\t\t\t\tif (curValue.indexOf(valueItem) === -1) {\n\t\t\t\t\t\t\t\tcurValue.push(valueItem);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (curValue.indexOf(value) === -1) {\n\t\t\t\t\t\tcurValue.push(value);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (curValue.length > length) {\n\t\t\t\t\t\tobjectPath.set(record, field, curValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.collection.update(record);\n\t\tthis.addToAllIndexes(record);\n\n\t\tif (updatedFields.length > 0) {\n\t\t\tthis.emit('updated', record, record);\n\t\t}\n\t}\n\n\tupdate(query, update, options = {}) {\n\t\tlet records = options.multi ? this.find(query).fetch() : this.findOne(query) || [];\n\t\tif (!Array.isArray(records)) {\n\t\t\trecords = [records];\n\t\t}\n\n\t\tfor (const record of records) {\n\t\t\tthis.updateRecord(record, update);\n\t\t}\n\t}\n\n\tremoveById(id) {\n\t\tconst record = this._findByIndex('_id', id);\n\t\tif (record) {\n\t\t\tthis.emit('beforeremove', record);\n\t\t\tthis.collection.removeWhere({_id: id});\n\t\t\tthis.removeFromAllIndexes(record);\n\t\t\tthis.emit('removed', record);\n\t\t}\n\t}\n}\n\nexport default ModelsBaseCache;\n","/* globals MongoInternals */\nimport _ from 'underscore';\n\nconst baseName = 'rocketchat_';\nimport {EventEmitter} from 'events';\n\nconst trash = new Mongo.Collection(`${ baseName }_trash`);\ntry {\n\ttrash._ensureIndex({ collection: 1 });\n\ttrash._ensureIndex({ _deletedAt: 1 }, { expireAfterSeconds: 60 * 60 * 24 * 30 });\n} catch (e) {\n\tconsole.log(e);\n}\n\nconst isOplogAvailable = MongoInternals.defaultRemoteCollectionDriver().mongo._oplogHandle && !!MongoInternals.defaultRemoteCollectionDriver().mongo._oplogHandle.onOplogEntry;\nlet isOplogEnabled = isOplogAvailable;\nRocketChat.settings.get('Force_Disable_OpLog_For_Cache', (key, value) => {\n\tisOplogEnabled = isOplogAvailable && value === false;\n});\n\nclass ModelsBaseDb extends EventEmitter {\n\tconstructor(model, baseModel) {\n\t\tsuper();\n\n\t\tif (Match.test(model, String)) {\n\t\t\tthis.name = model;\n\t\t\tthis.collectionName = this.baseName + this.name;\n\t\t\tthis.model = new Mongo.Collection(this.collectionName);\n\t\t} else {\n\t\t\tthis.name = model._name;\n\t\t\tthis.collectionName = this.name;\n\t\t\tthis.model = model;\n\t\t}\n\n\t\tthis.baseModel = baseModel;\n\n\t\tthis.wrapModel();\n\n\t\t// When someone start listening for changes we start oplog if available\n\t\tthis.once('newListener', (event/*, listener*/) => {\n\t\t\tif (event === 'change') {\n\t\t\t\tif (isOplogEnabled) {\n\t\t\t\t\tconst query = {\n\t\t\t\t\t\tcollection: this.collectionName\n\t\t\t\t\t};\n\n\t\t\t\t\tMongoInternals.defaultRemoteCollectionDriver().mongo._oplogHandle.onOplogEntry(query, this.processOplogRecord.bind(this));\n\t\t\t\t\tMongoInternals.defaultRemoteCollectionDriver().mongo._oplogHandle._defineTooFarBehind(Number.MAX_SAFE_INTEGER);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.tryEnsureIndex({ '_updatedAt': 1 });\n\t}\n\n\tget baseName() {\n\t\treturn baseName;\n\t}\n\n\tsetUpdatedAt(record = {}) {\n\n\t\t// TODO: Check if this can be deleted, Rodrigo does not rememebr WHY he added it. So he removed it to fix issue #5541\n\t\t// setUpdatedAt(record = {}, checkQuery = false, query) {\n\t\t// if (checkQuery === true) {\n\t\t// \tif (!query || Object.keys(query).length === 0) {\n\t\t// \t\tthrow new Meteor.Error('Models._Base: Empty query');\n\t\t// \t}\n\t\t// }\n\n\t\tif (/(^|,)\\$/.test(Object.keys(record).join(','))) {\n\t\t\trecord.$set = record.$set || {};\n\t\t\trecord.$set._updatedAt = new Date;\n\t\t} else {\n\t\t\trecord._updatedAt = new Date;\n\t\t}\n\n\t\treturn record;\n\t}\n\n\twrapModel() {\n\t\tthis.originals = {\n\t\t\tinsert: this.model.insert.bind(this.model),\n\t\t\tupdate: this.model.update.bind(this.model),\n\t\t\tremove: this.model.remove.bind(this.model)\n\t\t};\n\t\tconst self = this;\n\n\t\tthis.model.insert = function() {\n\t\t\treturn self.insert(...arguments);\n\t\t};\n\n\t\tthis.model.update = function() {\n\t\t\treturn self.update(...arguments);\n\t\t};\n\n\t\tthis.model.remove = function() {\n\t\t\treturn self.remove(...arguments);\n\t\t};\n\t}\n\n\tfind() {\n\t\treturn this.model.find(...arguments);\n\t}\n\n\tfindOne() {\n\t\treturn this.model.findOne(...arguments);\n\t}\n\n\tfindOneById(_id, options) {\n\t\treturn this.model.findOne({ _id }, options);\n\t}\n\n\tfindOneByIds(ids, options) {\n\t\treturn this.model.findOne({ _id: { $in: ids }}, options);\n\t}\n\n\tdefineSyncStrategy(query, modifier, options) {\n\t\tif (this.baseModel.useCache === false) {\n\t\t\treturn 'db';\n\t\t}\n\n\t\tif (options.upsert === true) {\n\t\t\treturn 'db';\n\t\t}\n\n\t\t// const dbModifiers = [\n\t\t// \t'$currentDate',\n\t\t// \t'$bit',\n\t\t// \t'$pull',\n\t\t// \t'$pushAll',\n\t\t// \t'$push',\n\t\t// \t'$setOnInsert'\n\t\t// ];\n\n\t\tconst cacheAllowedModifiers = [\n\t\t\t'$set',\n\t\t\t'$unset',\n\t\t\t'$min',\n\t\t\t'$max',\n\t\t\t'$inc',\n\t\t\t'$mul',\n\t\t\t'$rename',\n\t\t\t'$pullAll',\n\t\t\t'$pop',\n\t\t\t'$addToSet'\n\t\t];\n\n\t\tconst notAllowedModifiers = Object.keys(modifier).filter(i => i.startsWith('$') && cacheAllowedModifiers.includes(i) === false);\n\n\t\tif (notAllowedModifiers.length > 0) {\n\t\t\treturn 'db';\n\t\t}\n\n\t\tconst placeholderFields = Object.keys(query).filter(item => item.indexOf('$') > -1);\n\t\tif (placeholderFields.length > 0) {\n\t\t\treturn 'db';\n\t\t}\n\n\t\treturn 'cache';\n\t}\n\n\tupdateHasPositionalOperator(update) {\n\t\treturn Object.keys(update).some(key => key.includes('.$') || (!Match.test(update[key], Object) && this.updateHasPositionalOperator(update[key])));\n\t}\n\n\tprocessOplogRecord(action) {\n\t\tif (isOplogEnabled === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (action.op.op === 'i') {\n\t\t\tthis.emit('change', {\n\t\t\t\taction: 'insert',\n\t\t\t\tid: action.op.o._id,\n\t\t\t\tdata: action.op.o,\n\t\t\t\toplog: true\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tif (action.op.op === 'u') {\n\t\t\tif (!action.op.o.$set && !action.op.o.$unset) {\n\t\t\t\tthis.emit('change', {\n\t\t\t\t\taction: 'update:record',\n\t\t\t\t\tid: action.id,\n\t\t\t\t\tdata: action.op.o,\n\t\t\t\t\toplog: true\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst diff = {};\n\t\t\tif (action.op.o.$set) {\n\t\t\t\tfor (const key in action.op.o.$set) {\n\t\t\t\t\tif (action.op.o.$set.hasOwnProperty(key)) {\n\t\t\t\t\t\tdiff[key] = action.op.o.$set[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (action.op.o.$unset) {\n\t\t\t\tfor (const key in action.op.o.$unset) {\n\t\t\t\t\tif (action.op.o.$unset.hasOwnProperty(key)) {\n\t\t\t\t\t\tdiff[key] = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.emit('change', {\n\t\t\t\taction: 'update:diff',\n\t\t\t\tid: action.id,\n\t\t\t\tdata: diff,\n\t\t\t\toplog: true\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tif (action.op.op === 'd') {\n\t\t\tthis.emit('change', {\n\t\t\t\taction: 'remove',\n\t\t\t\tid: action.id,\n\t\t\t\toplog: true\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t}\n\n\tinsert(record) {\n\t\tthis.setUpdatedAt(record);\n\n\t\tconst result = this.originals.insert(...arguments);\n\t\tif (!isOplogEnabled && this.listenerCount('change') > 0) {\n\t\t\tthis.emit('change', {\n\t\t\t\taction: 'insert',\n\t\t\t\tid: result,\n\t\t\t\tdata: _.extend({}, record),\n\t\t\t\toplog: false\n\t\t\t});\n\t\t}\n\n\t\trecord._id = result;\n\n\t\treturn result;\n\t}\n\n\tupdate(query, update, options = {}) {\n\t\tthis.setUpdatedAt(update, true, query);\n\n\t\tconst strategy = this.defineSyncStrategy(query, update, options);\n\t\tlet ids = [];\n\t\tif (!isOplogEnabled && this.listenerCount('change') > 0 && strategy === 'db') {\n\t\t\tconst findOptions = {fields: {_id: 1}};\n\t\t\tlet records = options.multi ? this.find(query, findOptions).fetch() : this.findOne(query, findOptions) || [];\n\t\t\tif (!Array.isArray(records)) {\n\t\t\t\trecords = [records];\n\t\t\t}\n\n\t\t\tids = records.map(item => item._id);\n\t\t\tif (options.upsert !== true && this.updateHasPositionalOperator(update) === false) {\n\t\t\t\tquery = {\n\t\t\t\t\t_id: {\n\t\t\t\t\t\t$in: ids\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tconst result = this.originals.update(query, update, options);\n\n\t\tif (!isOplogEnabled && this.listenerCount('change') > 0) {\n\t\t\tif (strategy === 'db') {\n\t\t\t\tif (options.upsert === true) {\n\t\t\t\t\tif (result.insertedId) {\n\t\t\t\t\t\tthis.emit('change', {\n\t\t\t\t\t\t\taction: 'insert',\n\t\t\t\t\t\t\tid: result.insertedId,\n\t\t\t\t\t\t\tdata: this.findOne({_id: result.insertedId}),\n\t\t\t\t\t\t\toplog: false\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tquery = {\n\t\t\t\t\t\t_id: {\n\t\t\t\t\t\t\t$in: ids\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tlet records = options.multi ? this.find(query).fetch() : this.findOne(query) || [];\n\t\t\t\tif (!Array.isArray(records)) {\n\t\t\t\t\trecords = [records];\n\t\t\t\t}\n\t\t\t\tfor (const record of records) {\n\t\t\t\t\tthis.emit('change', {\n\t\t\t\t\t\taction: 'update:record',\n\t\t\t\t\t\tid: record._id,\n\t\t\t\t\t\tdata: record,\n\t\t\t\t\t\toplog: false\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.emit('change', {\n\t\t\t\t\taction: 'update:query',\n\t\t\t\t\tid: undefined,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tquery,\n\t\t\t\t\t\tupdate,\n\t\t\t\t\t\toptions\n\t\t\t\t\t},\n\t\t\t\t\toplog: false\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tupsert(query, update, options = {}) {\n\t\toptions.upsert = true;\n\t\toptions._returnObject = true;\n\t\treturn this.update(query, update, options);\n\t}\n\n\tremove(query) {\n\t\tconst records = this.model.find(query).fetch();\n\n\t\tconst ids = [];\n\t\tfor (const record of records) {\n\t\t\tids.push(record._id);\n\n\t\t\trecord._deletedAt = new Date;\n\t\t\trecord.__collection__ = this.name;\n\n\t\t\ttrash.upsert({_id: record._id}, _.omit(record, '_id'));\n\t\t}\n\n\t\tquery = { _id: { $in: ids } };\n\n\t\tconst result = this.originals.remove(query);\n\n\t\tif (!isOplogEnabled && this.listenerCount('change') > 0) {\n\t\t\tfor (const record of records) {\n\t\t\t\tthis.emit('change', {\n\t\t\t\t\taction: 'remove',\n\t\t\t\t\tid: record._id,\n\t\t\t\t\tdata: _.extend({}, record),\n\t\t\t\t\toplog: false\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tinsertOrUpsert(...args) {\n\t\tif (args[0] && args[0]._id) {\n\t\t\tconst _id = args[0]._id;\n\t\t\tdelete args[0]._id;\n\t\t\targs.unshift({\n\t\t\t\t_id\n\t\t\t});\n\n\t\t\tthis.upsert(...args);\n\t\t\treturn _id;\n\t\t} else {\n\t\t\treturn this.insert(...args);\n\t\t}\n\t}\n\n\tallow() {\n\t\treturn this.model.allow(...arguments);\n\t}\n\n\tdeny() {\n\t\treturn this.model.deny(...arguments);\n\t}\n\n\tensureIndex() {\n\t\treturn this.model._ensureIndex(...arguments);\n\t}\n\n\tdropIndex() {\n\t\treturn this.model._dropIndex(...arguments);\n\t}\n\n\ttryEnsureIndex() {\n\t\ttry {\n\t\t\treturn this.ensureIndex(...arguments);\n\t\t} catch (e) {\n\t\t\tconsole.error('Error creating index:', this.name, '->', ...arguments, e);\n\t\t}\n\t}\n\n\ttryDropIndex() {\n\t\ttry {\n\t\t\treturn this.dropIndex(...arguments);\n\t\t} catch (e) {\n\t\t\tconsole.error('Error dropping index:', this.name, '->', ...arguments, e);\n\t\t}\n\t}\n\n\ttrashFind(query, options) {\n\t\tquery.__collection__ = this.name;\n\n\t\treturn trash.find(query, options);\n\t}\n\n\ttrashFindDeletedAfter(deletedAt, query = {}, options) {\n\t\tquery.__collection__ = this.name;\n\t\tquery._deletedAt = {\n\t\t\t$gt: deletedAt\n\t\t};\n\n\t\treturn trash.find(query, options);\n\t}\n}\n\nexport default ModelsBaseDb;\n","import _ from 'underscore';\n\nconst AccessTokenServices = {};\n\nRocketChat.registerAccessTokenService = function(serviceName, handleAccessTokenRequest) {\n\tAccessTokenServices[serviceName] = {\n\t\tserviceName,\n\t\thandleAccessTokenRequest\n\t};\n};\n\n// Listen to calls to `login` with an oauth option set. This is where\n// users actually get logged in to meteor via oauth.\nAccounts.registerLoginHandler(function(options) {\n\tif (!options.accessToken) {\n\t\treturn undefined; // don't handle\n\t}\n\n\tcheck(options, Match.ObjectIncluding({\n\t\tserviceName: String\n\t}));\n\n\tconst service = AccessTokenServices[options.serviceName];\n\n\t// Skip everything if there's no service set by the oauth middleware\n\tif (!service) {\n\t\tthrow new Error(`Unexpected AccessToken service ${ options.serviceName }`);\n\t}\n\n\t// Make sure we're configured\n\tif (!ServiceConfiguration.configurations.findOne({service: service.serviceName})) {\n\t\tthrow new ServiceConfiguration.ConfigError();\n\t}\n\n\tif (!_.contains(Accounts.oauth.serviceNames(), service.serviceName)) {\n\t\t// serviceName was not found in the registered services list.\n\t\t// This could happen because the service never registered itself or\n\t\t// unregisterService was called on it.\n\t\treturn {\n\t\t\ttype: 'oauth',\n\t\t\terror: new Meteor.Error(\n\t\t\t\tAccounts.LoginCancelledError.numericError,\n\t\t\t\t`No registered oauth service found for: ${ service.serviceName }`\n\t\t\t)\n\t\t};\n\t}\n\n\tconst oauthResult = service.handleAccessTokenRequest(options);\n\n\treturn Accounts.updateOrCreateUserFromExternalService(service.serviceName, oauthResult.serviceData, oauthResult.options);\n});\n\n\n\n","import _ from 'underscore';\nimport { OAuth } from 'meteor/oauth';\nconst crypto = Npm.require('crypto');\nconst whitelisted = [\n\t'id',\n\t'email',\n\t'name',\n\t'first_name',\n\t'last_name',\n\t'link',\n\t'gender',\n\t'locale',\n\t'age_range'];\n\nconst FB_API_VERSION = 'v2.9';\nconst FB_URL = 'https://graph.facebook.com';\n\nconst getIdentity = function(accessToken, fields, secret) {\n\tconst hmac = crypto.createHmac('sha256', OAuth.openSecret(secret));\n\thmac.update(accessToken);\n\n\ttry {\n\t\treturn HTTP.get(`${ FB_URL }/${ FB_API_VERSION }/me`, {\n\t\t\tparams: {\n\t\t\t\taccess_token: accessToken,\n\t\t\t\tappsecret_proof: hmac.digest('hex'),\n\t\t\t\tfields: fields.join(',')\n\t\t\t}\n\t\t}).data;\n\t} catch (err) {\n\t\tthrow _.extend(new Error(`Failed to fetch identity from Facebook. ${ err.message }`),\n\t\t\t{response: err.response});\n\t}\n};\n\nRocketChat.registerAccessTokenService('facebook', function(options) {\n\tcheck(options, Match.ObjectIncluding({\n\t\taccessToken: String,\n\t\tsecret: String,\n\t\texpiresIn: Match.Integer,\n\t\tidentity: Match.Maybe(Object)\n\t}));\n\n\tconst identity = options.identity || getIdentity(options.accessToken, whitelisted, options.secret);\n\n\tconst serviceData = {\n\t\taccessToken: options.accessToken,\n\t\texpiresAt: (+new Date) + (1000 * parseInt(options.expiresIn, 10))\n\t};\n\n\tconst fields = _.pick(identity, whitelisted);\n\t_.extend(serviceData, fields);\n\n\treturn {\n\t\tserviceData,\n\t\toptions: {\n\t\t\tprofile: {\n\t\t\t\tname: identity.name\n\t\t\t}\n\t\t}\n\t};\n});\n\n","import Twit from 'twit';\nimport _ from 'underscore';\n\nconst whitelistedFields = [\n\t'id',\n\t'name',\n\t'description',\n\t'profile_image_url',\n\t'profile_image_url_https',\n\t'lang',\n\t'email'\n];\n\nconst getIdentity = function(accessToken, appId, appSecret, accessTokenSecret) {\n\tconst Twitter = new Twit({\n\t\tconsumer_key: appId,\n\t\tconsumer_secret: appSecret,\n\t\taccess_token: accessToken,\n\t\taccess_token_secret: accessTokenSecret\n\t});\n\tconst syncTwitter = Meteor.wrapAsync(Twitter.get, Twitter);\n\ttry {\n\t\treturn syncTwitter('account/verify_credentials.json?include_email=true');\n\t} catch (err) {\n\t\tthrow _.extend(new Error(`Failed to fetch identity from Twwiter. ${ err.message }`),\n\t\t\t{response: err.response});\n\t}\n};\n\nRocketChat.registerAccessTokenService('twitter', function(options) {\n\tcheck(options, Match.ObjectIncluding({\n\t\taccessToken: String,\n\t\tappSecret: String,\n\t\tappId: String,\n\t\taccessTokenSecret: String,\n\t\texpiresIn: Match.Integer,\n\t\tidentity: Match.Maybe(Object)\n\t}));\n\n\tconst identity = options.identity || getIdentity(options.accessToken, options.appId, options.appSecret, options.accessTokenSecret);\n\n\tconst serviceData = {\n\t\taccessToken: options.accessToken,\n\t\texpiresAt: (+new Date) + (1000 * parseInt(options.expiresIn, 10))\n\t};\n\n\tconst fields = _.pick(identity, whitelistedFields);\n\t_.extend(serviceData, fields);\n\n\treturn {\n\t\tserviceData,\n\t\toptions: {\n\t\t\tprofile: {\n\t\t\t\tname: identity.name\n\t\t\t}\n\t\t}\n\t};\n});\n","/* globals Google */\nimport _ from 'underscore';\n\nfunction getIdentity(accessToken) {\n\ttry {\n\t\treturn HTTP.get(\n\t\t\t'https://www.googleapis.com/oauth2/v1/userinfo',\n\t\t\t{params: {access_token: accessToken}}).data;\n\t} catch (err) {\n\t\tthrow _.extend(new Error(`Failed to fetch identity from Google. ${ err.message }`), {response: err.response});\n\t}\n}\n\nfunction getScopes(accessToken) {\n\ttry {\n\t\treturn HTTP.get(\n\t\t\t'https://www.googleapis.com/oauth2/v1/tokeninfo',\n\t\t\t{params: {access_token: accessToken}}).data.scope.split(' ');\n\t} catch (err) {\n\t\tthrow _.extend(new Error(`Failed to fetch tokeninfo from Google. ${ err.message }`), {response: err.response});\n\t}\n}\n\n\nRocketChat.registerAccessTokenService('google', function(options) {\n\tcheck(options, Match.ObjectIncluding({\n\t\taccessToken: String,\n\t\tidToken: String,\n\t\texpiresIn: Match.Integer,\n\t\tscope: Match.Maybe(String),\n\t\tidentity: Match.Maybe(Object)\n\t}));\n\n\tconst identity = options.identity || getIdentity(options.accessToken);\n\n\tconst serviceData = {\n\t\taccessToken: options.accessToken,\n\t\tidToken: options.idToken,\n\t\texpiresAt: (+new Date) + (1000 * parseInt(options.expiresIn, 10)),\n\t\tscope: options.scopes || getScopes(options.accessToken)\n\t};\n\n\tconst fields = _.pick(identity, Google.whitelistedFields);\n\t_.extend(serviceData, fields);\n\n\t// only set the token in serviceData if it's there. this ensures\n\t// that we don't lose old ones (since we only get this on the first\n\t// log in attempt)\n\tif (options.refreshToken) {\n\t\tserviceData.refreshToken = options.refreshToken;\n\t}\n\n\treturn {\n\t\tserviceData,\n\t\toptions: {\n\t\t\tprofile: {\n\t\t\t\tname: identity.name\n\t\t\t}\n\t\t}\n\t};\n});\n","/* globals OAuth */\nimport _ from 'underscore';\n\nOAuth._redirectUri = _.wrap(OAuth._redirectUri, function(func, serviceName, ...args) {\n\tconst proxy = RocketChat.settings.get('Accounts_OAuth_Proxy_services').replace(/\\s/g, '').split(',');\n\tif (proxy.includes(serviceName)) {\n\t\treturn `${ RocketChat.settings.get('Accounts_OAuth_Proxy_host') }/oauth_redirect`;\n\t} else {\n\t\treturn func(serviceName, ...args);\n\t}\n\n});\n","import {StatsD} from 'node-dogstatsd';\n\nRocketChat.statsTracker = new (class StatsTracker {\n\tconstructor() {\n\t\tthis.StatsD = StatsD;\n\t\tthis.dogstatsd = new this.StatsD();\n\t}\n\n\ttrack(type, stats, ...args) {\n\t\tthis.dogstatsd[type](`RocketChat.${ stats }`, ...args);\n\t}\n\n\tnow() {\n\t\tconst hrtime = process.hrtime();\n\t\treturn (hrtime[0] * 1000000 + hrtime[1] / 1000);\n\t}\n\n\ttiming(stats, time, tags) {\n\t\tthis.track('timing', stats, time, tags);\n\t}\n\n\tincrement(stats, time, tags) {\n\t\tthis.track('increment', stats, time, tags);\n\t}\n\n\tdecrement(stats, time, tags) {\n\t\tthis.track('decrement', stats, time, tags);\n\t}\n\n\thistogram(stats, time, tags) {\n\t\tthis.track('histogram', stats, time, tags);\n\t}\n\n\tgauge(stats, time, tags) {\n\t\tthis.track('gauge', stats, time, tags);\n\t}\n\n\tunique(stats, time, tags) {\n\t\tthis.track('unique', stats, time, tags);\n\t}\n\n\tset(stats, time, tags) {\n\t\tthis.track('set', stats, time, tags);\n\t}\n});\n","RocketChat.models.Rooms.cache.hasMany('Subscriptions', {\n\tfield: 'usernames',\n\tlink: {\n\t\tlocal: '_id',\n\t\tremote: 'rid',\n\t\ttransform(room, subscription) {\n\t\t\treturn subscription.u.username;\n\t\t},\n\t\tremove(arr, subscription) {\n\t\t\tif (arr.indexOf(subscription.u.username) > -1) {\n\t\t\t\tarr.splice(arr.indexOf(subscription.u.username), 1);\n\t\t\t}\n\t\t}\n\t}\n});\n\n\nRocketChat.models.Subscriptions.cache.hasOne('Rooms', {\n\tfield: '_room',\n\tlink: {\n\t\tlocal: 'rid',\n\t\tremote: '_id'\n\t}\n});\n\n\nRocketChat.models.Subscriptions.cache.hasOne('Users', {\n\tfield: '_user',\n\tlink: {\n\t\tlocal: 'u._id',\n\t\tremote: '_id'\n\t}\n});\n\nRocketChat.models.Subscriptions.cache.hasOne('Users', {\n\tfield: 'fname',\n\tlink: {\n\t\tlocal: 'name',\n\t\tremote: 'username',\n\t\twhere(subscription/*, user*/) {\n\t\t\treturn subscription.t === 'd';\n\t\t},\n\t\ttransform(subscription, user) {\n\t\t\tif (user == null || subscription == null) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\t// Prevent client cache for old subscriptions with new names\n\t\t\t// Cuz when a user change his name, the subscription's _updateAt\n\t\t\t// will not change\n\t\t\tif (subscription._updatedAt < user._updatedAt) {\n\t\t\t\tsubscription._updatedAt = user._updatedAt;\n\t\t\t}\n\t\t\treturn user.name;\n\t\t}\n\t}\n});\n\nRocketChat.models.Users.cache.load();\nRocketChat.models.Rooms.cache.load();\nRocketChat.models.Subscriptions.cache.load();\nRocketChat.models.Settings.cache.load();\n\n\nRocketChat.models.Users.cache.addDynamicView('highlights').applyFind({\n\t'settings.preferences.highlights': {$size: {$gt: 0}}\n});\n\nRocketChat.models.Subscriptions.cache.addDynamicView('notifications').applyFind({\n\t$or: [\n\t\t{desktopNotifications: {$in: ['all', 'nothing']}},\n\t\t{mobilePushNotifications: {$in: ['all', 'nothing']}}\n\t]\n});\n","/* globals WebAppInternals*/\nimport _ from 'underscore';\n\nfunction testWebAppInternals(fn) {\n\ttypeof WebAppInternals !== 'undefined' && fn(WebAppInternals);\n}\nRocketChat.settings.onload('CDN_PREFIX', function(key, value) {\n\tif (_.isString(value) && value.trim()) {\n\t\treturn testWebAppInternals(WebAppInternals => WebAppInternals.setBundledJsCssPrefix(value));\n\t}\n});\n\nMeteor.startup(function() {\n\tconst value = RocketChat.settings.get('CDN_PREFIX');\n\tif (_.isString(value) && value.trim()) {\n\t\treturn testWebAppInternals(WebAppInternals => WebAppInternals.setBundledJsCssPrefix(value));\n\t}\n});\n","import _ from 'underscore';\nimport { IMAPIntercepter } from '../lib/interceptDirectReplyEmails.js';\nimport { POP3Helper } from '../lib/interceptDirectReplyEmails.js';\n\nconst startEmailIntercepter = _.debounce(Meteor.bindEnvironment(function() {\n\tconsole.log('Starting Email Intercepter...');\n\n\tif (RocketChat.settings.get('Direct_Reply_Enable') && RocketChat.settings.get('Direct_Reply_Protocol') && RocketChat.settings.get('Direct_Reply_Host') && RocketChat.settings.get('Direct_Reply_Port') && RocketChat.settings.get('Direct_Reply_Username') && RocketChat.settings.get('Direct_Reply_Password')) {\n\t\tif (RocketChat.settings.get('Direct_Reply_Protocol') === 'IMAP') {\n\t\t\t// stop already running IMAP instance\n\t\t\tif (RocketChat.IMAP && RocketChat.IMAP.isActive()) {\n\t\t\t\tconsole.log('Disconnecting already running IMAP instance...');\n\t\t\t\tRocketChat.IMAP.stop(Meteor.bindEnvironment(function() {\n\t\t\t\t\tconsole.log('Starting new IMAP instance......');\n\t\t\t\t\tRocketChat.IMAP = new IMAPIntercepter();\n\t\t\t\t\tRocketChat.IMAP.start();\n\t\t\t\t\treturn true;\n\t\t\t\t}));\n\t\t\t} else if (RocketChat.POP3 && RocketChat.POP3Helper && RocketChat.POP3Helper.isActive()) {\n\t\t\t\tconsole.log('Disconnecting already running POP instance...');\n\t\t\t\tRocketChat.POP3Helper.stop(Meteor.bindEnvironment(function() {\n\t\t\t\t\tconsole.log('Starting new IMAP instance......');\n\t\t\t\t\tRocketChat.IMAP = new IMAPIntercepter();\n\t\t\t\t\tRocketChat.IMAP.start();\n\t\t\t\t\treturn true;\n\t\t\t\t}));\n\t\t\t} else {\n\t\t\t\tconsole.log('Starting new IMAP instance......');\n\t\t\t\tRocketChat.IMAP = new IMAPIntercepter();\n\t\t\t\tRocketChat.IMAP.start();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else if (RocketChat.settings.get('Direct_Reply_Protocol') === 'POP') {\n\t\t\t// stop already running POP instance\n\t\t\tif (RocketChat.POP3 && RocketChat.POP3Helper && RocketChat.POP3Helper.isActive()) {\n\t\t\t\tconsole.log('Disconnecting already running POP instance...');\n\t\t\t\tRocketChat.POP3Helper.stop(Meteor.bindEnvironment(function() {\n\t\t\t\t\tconsole.log('Starting new POP instance......');\n\t\t\t\t\tRocketChat.POP3Helper = new POP3Helper();\n\t\t\t\t\tRocketChat.POP3Helper.start();\n\t\t\t\t\treturn true;\n\t\t\t\t}));\n\t\t\t} else if (RocketChat.IMAP && RocketChat.IMAP.isActive()) {\n\t\t\t\tconsole.log('Disconnecting already running IMAP instance...');\n\t\t\t\tRocketChat.IMAP.stop(Meteor.bindEnvironment(function() {\n\t\t\t\t\tconsole.log('Starting new POP instance......');\n\t\t\t\t\tRocketChat.POP3Helper = new POP3Helper();\n\t\t\t\t\tRocketChat.POP3Helper.start();\n\t\t\t\t\treturn true;\n\t\t\t\t}));\n\t\t\t} else {\n\t\t\t\tconsole.log('Starting new POP instance......');\n\t\t\t\tRocketChat.POP3Helper = new POP3Helper();\n\t\t\t\tRocketChat.POP3Helper.start();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t} else if (RocketChat.IMAP && RocketChat.IMAP.isActive()) {\n\t\t// stop IMAP instance\n\t\tRocketChat.IMAP.stop();\n\t} else if (RocketChat.POP3 && RocketChat.POP3Helper.isActive()) {\n\t\t// stop POP3 instance\n\t\tRocketChat.POP3Helper.stop();\n\t}\n}), 1000);\n\nRocketChat.settings.onload(/^Direct_Reply_.+/, startEmailIntercepter);\n","import _ from 'underscore';\n\nconst buildMailURL = _.debounce(function() {\n\tconsole.log('Updating process.env.MAIL_URL');\n\n\tif (RocketChat.settings.get('SMTP_Host')) {\n\t\tprocess.env.MAIL_URL = `${ RocketChat.settings.get('SMTP_Protocol') }://`;\n\n\t\tif (RocketChat.settings.get('SMTP_Username') && RocketChat.settings.get('SMTP_Password')) {\n\t\t\tprocess.env.MAIL_URL += `${ encodeURIComponent(RocketChat.settings.get('SMTP_Username')) }:${ encodeURIComponent(RocketChat.settings.get('SMTP_Password')) }@`;\n\t\t}\n\n\t\tprocess.env.MAIL_URL += encodeURIComponent(RocketChat.settings.get('SMTP_Host'));\n\n\t\tif (RocketChat.settings.get('SMTP_Port')) {\n\t\t\tprocess.env.MAIL_URL += `:${ parseInt(RocketChat.settings.get('SMTP_Port')) }`;\n\t\t}\n\n\t\tprocess.env.MAIL_URL += `?pool=${ RocketChat.settings.get('SMTP_Pool') }`;\n\n\t\tif (RocketChat.settings.get('SMTP_Protocol') === 'smtp' && RocketChat.settings.get('SMTP_IgnoreTLS')) {\n\t\t\tprocess.env.MAIL_URL += '&secure=false&ignoreTLS=true';\n\t\t}\n\n\t\treturn process.env.MAIL_URL;\n\t}\n}, 500);\n\nRocketChat.settings.onload('SMTP_Host', function(key, value) {\n\tif (_.isString(value)) {\n\t\treturn buildMailURL();\n\t}\n});\n\nRocketChat.settings.onload('SMTP_Port', function() {\n\treturn buildMailURL();\n});\n\nRocketChat.settings.onload('SMTP_Username', function(key, value) {\n\tif (_.isString(value)) {\n\t\treturn buildMailURL();\n\t}\n});\n\nRocketChat.settings.onload('SMTP_Password', function(key, value) {\n\tif (_.isString(value)) {\n\t\treturn buildMailURL();\n\t}\n});\n\nRocketChat.settings.onload('SMTP_Protocol', function() {\n\treturn buildMailURL();\n});\n\nRocketChat.settings.onload('SMTP_Pool', function() {\n\treturn buildMailURL();\n});\n\nRocketChat.settings.onload('SMTP_IgnoreTLS', function() {\n\treturn buildMailURL();\n});\n\nMeteor.startup(function() {\n\treturn buildMailURL();\n});\n","/* globals CustomOAuth */\nimport _ from 'underscore';\n\nconst logger = new Logger('rocketchat:lib', {\n\tmethods: {\n\t\toauth_updated: {\n\t\t\ttype: 'info'\n\t\t}\n\t}\n});\n\nfunction _OAuthServicesUpdate() {\n\tconst services = RocketChat.settings.get(/^(Accounts_OAuth_|Accounts_OAuth_Custom-)[a-z0-9_]+$/i);\n\tservices.forEach((service) => {\n\t\tlogger.oauth_updated(service.key);\n\t\tlet serviceName = service.key.replace('Accounts_OAuth_', '');\n\t\tif (serviceName === 'Meteor') {\n\t\t\tserviceName = 'meteor-developer';\n\t\t}\n\t\tif (/Accounts_OAuth_Custom-/.test(service.key)) {\n\t\t\tserviceName = service.key.replace('Accounts_OAuth_Custom-', '');\n\t\t}\n\t\tif (service.value === true) {\n\t\t\tconst data = {\n\t\t\t\tclientId: RocketChat.settings.get(`${ service.key }_id`),\n\t\t\t\tsecret: RocketChat.settings.get(`${ service.key }_secret`)\n\t\t\t};\n\t\t\tif (/Accounts_OAuth_Custom-/.test(service.key)) {\n\t\t\t\tdata.custom = true;\n\t\t\t\tdata.clientId = RocketChat.settings.get(`${ service.key }-id`);\n\t\t\t\tdata.secret = RocketChat.settings.get(`${ service.key }-secret`);\n\t\t\t\tdata.serverURL = RocketChat.settings.get(`${ service.key }-url`);\n\t\t\t\tdata.tokenPath = RocketChat.settings.get(`${ service.key }-token_path`);\n\t\t\t\tdata.identityPath = RocketChat.settings.get(`${ service.key }-identity_path`);\n\t\t\t\tdata.authorizePath = RocketChat.settings.get(`${ service.key }-authorize_path`);\n\t\t\t\tdata.scope = RocketChat.settings.get(`${ service.key }-scope`);\n\t\t\t\tdata.buttonLabelText = RocketChat.settings.get(`${ service.key }-button_label_text`);\n\t\t\t\tdata.buttonLabelColor = RocketChat.settings.get(`${ service.key }-button_label_color`);\n\t\t\t\tdata.loginStyle = RocketChat.settings.get(`${ service.key }-login_style`);\n\t\t\t\tdata.buttonColor = RocketChat.settings.get(`${ service.key }-button_color`);\n\t\t\t\tdata.tokenSentVia = RocketChat.settings.get(`${ service.key }-token_sent_via`);\n\t\t\t\tdata.identityTokenSentVia = RocketChat.settings.get(`${ service.key }-identity_token_sent_via`);\n\t\t\t\tdata.usernameField = RocketChat.settings.get(`${ service.key }-username_field`);\n\t\t\t\tdata.mergeUsers = RocketChat.settings.get(`${ service.key }-merge_users`);\n\t\t\t\tnew CustomOAuth(serviceName.toLowerCase(), {\n\t\t\t\t\tserverURL: data.serverURL,\n\t\t\t\t\ttokenPath: data.tokenPath,\n\t\t\t\t\tidentityPath: data.identityPath,\n\t\t\t\t\tauthorizePath: data.authorizePath,\n\t\t\t\t\tscope: data.scope,\n\t\t\t\t\tloginStyle: data.loginStyle,\n\t\t\t\t\ttokenSentVia: data.tokenSentVia,\n\t\t\t\t\tidentityTokenSentVia: data.identityTokenSentVia,\n\t\t\t\t\tusernameField: data.usernameField,\n\t\t\t\t\tmergeUsers: data.mergeUsers\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (serviceName === 'Facebook') {\n\t\t\t\tdata.appId = data.clientId;\n\t\t\t\tdelete data.clientId;\n\t\t\t}\n\t\t\tif (serviceName === 'Twitter') {\n\t\t\t\tdata.consumerKey = data.clientId;\n\t\t\t\tdelete data.clientId;\n\t\t\t}\n\t\t\tServiceConfiguration.configurations.upsert({\n\t\t\t\tservice: serviceName.toLowerCase()\n\t\t\t}, {\n\t\t\t\t$set: data\n\t\t\t});\n\t\t} else {\n\t\t\tServiceConfiguration.configurations.remove({\n\t\t\t\tservice: serviceName.toLowerCase()\n\t\t\t});\n\t\t}\n\t});\n}\n\nconst OAuthServicesUpdate = _.debounce(Meteor.bindEnvironment(_OAuthServicesUpdate), 2000);\n\nfunction OAuthServicesRemove(_id) {\n\tconst serviceName = _id.replace('Accounts_OAuth_Custom-', '');\n\treturn ServiceConfiguration.configurations.remove({\n\t\tservice: serviceName.toLowerCase()\n\t});\n}\n\nRocketChat.settings.get(/^Accounts_OAuth_.+/, function() {\n\treturn OAuthServicesUpdate(); // eslint-disable-line new-cap\n});\n\nRocketChat.settings.get(/^Accounts_OAuth_Custom-[a-z0-9_]+/, function(key, value) {\n\tif (!value) {\n\t\treturn OAuthServicesRemove(key);// eslint-disable-line new-cap\n\t}\n});\n","// Insert server unique id if it doesn't exist\nRocketChat.settings.add('uniqueID', process.env.DEPLOYMENT_ID || Random.id(), {\n\t'public': true,\n\thidden: true\n});\n\n// When you define a setting and want to add a description, you don't need to automatically define the i18nDescription\n// if you add a node to the i18n.json with the same setting name but with `_Description` it will automatically work.\n\nRocketChat.settings.addGroup('Accounts', function() {\n\tthis.add('Accounts_AllowAnonymousRead', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true\n\t});\n\tthis.add('Accounts_AllowAnonymousWrite', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t\tenableQuery: {\n\t\t\t_id: 'Accounts_AllowAnonymousRead',\n\t\t\tvalue: true\n\t\t}\n\t});\n\tthis.add('Accounts_AllowDeleteOwnAccount', false, {\n\t\ttype: 'boolean',\n\t\t'public': true,\n\t\tenableQuery: {\n\t\t\t_id: 'Accounts_AllowUserProfileChange',\n\t\t\tvalue: true\n\t\t}\n\t});\n\tthis.add('Accounts_AllowUserProfileChange', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Accounts_AllowUserAvatarChange', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Accounts_AllowRealNameChange', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Accounts_AllowUsernameChange', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Accounts_AllowEmailChange', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Accounts_AllowPasswordChange', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Accounts_CustomFieldsToShowInUserInfo', '', {\n\t\ttype: 'string',\n\t\tpublic: true\n\t});\n\tthis.add('Accounts_LoginExpiration', 90, {\n\t\ttype: 'int',\n\t\t'public': true\n\t});\n\tthis.add('Accounts_ShowFormLogin', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Accounts_EmailOrUsernamePlaceholder', '', {\n\t\ttype: 'string',\n\t\t'public': true,\n\t\ti18nLabel: 'Placeholder_for_email_or_username_login_field'\n\t});\n\tthis.add('Accounts_PasswordPlaceholder', '', {\n\t\ttype: 'string',\n\t\t'public': true,\n\t\ti18nLabel: 'Placeholder_for_password_login_field'\n\t});\n\tthis.add('Accounts_ConfirmPasswordPlaceholder', '', {\n\t\ttype: 'string',\n\t\t'public': true,\n\t\ti18nLabel: 'Placeholder_for_password_login_field'\n\t});\n\tthis.add('Accounts_ForgetUserSessionOnWindowClose', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Accounts_SearchFields', 'username, name, emails.address', {\n\t\ttype: 'string',\n\t\tpublic: true\n\t});\n\n\tthis.section('Two Factor Authentication', function() {\n\t\tthis.add('Accounts_TwoFactorAuthentication_MaxDelta', 1, {\n\t\t\ttype: 'int',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Accounts_TwoFactorAuthentication_MaxDelta'\n\t\t});\n\t});\n\n\tthis.section('Registration', function() {\n\t\tthis.add('Accounts_DefaultUsernamePrefixSuggestion', 'user', {\n\t\t\ttype: 'string'\n\t\t});\n\t\tthis.add('Accounts_RequireNameForSignUp', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_RequirePasswordConfirmation', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_EmailVerification', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'SMTP_Host',\n\t\t\t\tvalue: {\n\t\t\t\t\t$exists: 1,\n\t\t\t\t\t$ne: ''\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis.add('Accounts_ManuallyApproveNewUsers', false, {\n\t\t\t'public': true,\n\t\t\ttype: 'boolean'\n\t\t});\n\t\tthis.add('Accounts_AllowedDomainsList', '', {\n\t\t\ttype: 'string',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_BlockedDomainsList', '', {\n\t\t\ttype: 'string'\n\t\t});\n\t\tthis.add('Accounts_BlockedUsernameList', '', {\n\t\t\ttype: 'string'\n\t\t});\n\t\tthis.add('Accounts_UseDefaultBlockedDomainsList', true, {\n\t\t\ttype: 'boolean'\n\t\t});\n\t\tthis.add('Accounts_UseDNSDomainCheck', false, {\n\t\t\ttype: 'boolean'\n\t\t});\n\t\tthis.add('Accounts_RegistrationForm', 'Public', {\n\t\t\ttype: 'select',\n\t\t\t'public': true,\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'Public',\n\t\t\t\t\ti18nLabel: 'Accounts_RegistrationForm_Public'\n\t\t\t\t}, {\n\t\t\t\t\tkey: 'Disabled',\n\t\t\t\t\ti18nLabel: 'Accounts_RegistrationForm_Disabled'\n\t\t\t\t}, {\n\t\t\t\t\tkey: 'Secret URL',\n\t\t\t\t\ti18nLabel: 'Accounts_RegistrationForm_Secret_URL'\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\t\tthis.add('Accounts_RegistrationForm_SecretURL', Random.id(), {\n\t\t\ttype: 'string'\n\t\t});\n\t\tthis.add('Accounts_RegistrationForm_LinkReplacementText', 'New user registration is currently disabled', {\n\t\t\ttype: 'string',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_Registration_AuthenticationServices_Enabled', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_Registration_AuthenticationServices_Default_Roles', 'user', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Accounts_Registration_AuthenticationServices_Enabled',\n\t\t\t\tvalue: true\n\t\t\t}\n\t\t});\n\t\tthis.add('Accounts_PasswordReset', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_CustomFields', '', {\n\t\t\ttype: 'code',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Custom_Fields'\n\t\t});\n\t});\n\n\tthis.section('Accounts_Default_User_Preferences', function() {\n\t\tthis.add('Accounts_Default_User_Preferences_enableAutoAway', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Enable_Auto_Away'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_idleTimeLimit', 300, {\n\t\t\ttype: 'int',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Idle_Time_Limit'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_desktopNotificationDuration', 0, {\n\t\t\ttype: 'int',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Notification_Duration'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_audioNotifications', 'mentions', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'all',\n\t\t\t\t\ti18nLabel: 'All_messages'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mentions',\n\t\t\t\t\ti18nLabel: 'Mentions'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'nothing',\n\t\t\t\t\ti18nLabel: 'Nothing'\n\t\t\t\t}\n\t\t\t],\n\t\t\tpublic: true\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_desktopNotifications', 'mentions', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'all',\n\t\t\t\t\ti18nLabel: 'All_messages'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mentions',\n\t\t\t\t\ti18nLabel: 'Mentions'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'nothing',\n\t\t\t\t\ti18nLabel: 'Nothing'\n\t\t\t\t}\n\t\t\t],\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_mobileNotifications', 'mentions', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey : 'all',\n\t\t\t\t\ti18nLabel : 'All_messages'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey : 'mentions',\n\t\t\t\t\ti18nLabel : 'Mentions'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey : 'nothing',\n\t\t\t\t\ti18nLabel : 'Nothing'\n\t\t\t\t}\n\t\t\t],\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_unreadAlert', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Unread_Tray_Icon_Alert'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_useEmojis', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Use_Emojis'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_convertAsciiEmoji', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Convert_Ascii_Emojis'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_autoImageLoad', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Auto_Load_Images'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_saveMobileBandwidth', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Save_Mobile_Bandwidth'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_collapseMediaByDefault', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Collapse_Embedded_Media_By_Default'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_hideUsernames', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Hide_usernames'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_hideRoles', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Hide_roles'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_hideFlexTab', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Hide_flextab'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_hideAvatars', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Hide_Avatars'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_sidebarGroupByType', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Group_by_Type'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_sidebarViewMode', 'medium', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'extended',\n\t\t\t\t\ti18nLabel: 'Extended'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'medium',\n\t\t\t\t\ti18nLabel: 'Medium'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'condensed',\n\t\t\t\t\ti18nLabel: 'Condensed'\n\t\t\t\t}\n\t\t\t],\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Sidebar_list_mode'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_sidebarHideAvatar', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Hide_Avatars'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_sidebarShowUnread', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Unread_on_top'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_sidebarShowFavorites', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Group_favorites'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_sendOnEnter', 'normal', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'normal',\n\t\t\t\t\ti18nLabel: 'Enter_Normal'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'alternative',\n\t\t\t\t\ti18nLabel: 'Enter_Alternative'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'desktop',\n\t\t\t\t\ti18nLabel: 'Only_On_Desktop'\n\t\t\t\t}\n\t\t\t],\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Enter_Behaviour'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_messageViewMode', 0, {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 0,\n\t\t\t\t\ti18nLabel: 'Normal'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 1,\n\t\t\t\t\ti18nLabel: 'Cozy'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 2,\n\t\t\t\t\ti18nLabel: 'Compact'\n\t\t\t\t}\n\t\t\t],\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'MessageBox_view_mode'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_emailNotificationMode', 'mentions', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'nothing',\n\t\t\t\t\ti18nLabel: 'Email_Notification_Mode_Disabled'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mentions',\n\t\t\t\t\ti18nLabel: 'Email_Notification_Mode_All'\n\t\t\t\t}\n\t\t\t],\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Email_Notification_Mode'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_roomCounterSidebar', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Show_room_counter_on_sidebar'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_newRoomNotification', 'door', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'none',\n\t\t\t\t\ti18nLabel: 'None'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'door',\n\t\t\t\t\ti18nLabel: 'Default'\n\t\t\t\t}\n\t\t\t],\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'New_Room_Notification'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_newMessageNotification', 'chime', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'none',\n\t\t\t\t\ti18nLabel: 'None'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'chime',\n\t\t\t\t\ti18nLabel: 'Default'\n\t\t\t\t}\n\t\t\t],\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'New_Message_Notification'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_muteFocusedConversations', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Mute_Focused_Conversations'\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_notificationsSoundVolume', 100, {\n\t\t\ttype: 'int',\n\t\t\t'public': true,\n\t\t\ti18nLabel: 'Notifications_Sound_Volume'\n\t\t});\n\t});\n\n\tthis.section('Avatar', function() {\n\t\tthis.add('Accounts_AvatarResize', true, {\n\t\t\ttype: 'boolean'\n\t\t});\n\t\tthis.add('Accounts_AvatarSize', 200, {\n\t\t\ttype: 'int',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Accounts_AvatarResize',\n\t\t\t\tvalue: true\n\t\t\t}\n\t\t});\n\t\tthis.add('Accounts_AvatarCacheTime', 3600, {\n\t\t\ttype: 'int',\n\t\t\ti18nDescription: 'Accounts_AvatarCacheTime_description'\n\t\t});\n\n\t\treturn this.add('Accounts_SetDefaultAvatar', true, {\n\t\t\ttype: 'boolean'\n\t\t});\n\t});\n\n\tthis.section('Password_Policy', function() {\n\t\tthis.add('Accounts_Password_Policy_Enabled', false, {\n\t\t\ttype: 'boolean'\n\t\t});\n\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_Password_Policy_Enabled',\n\t\t\tvalue: true\n\t\t};\n\n\t\tthis.add('Accounts_Password_Policy_MinLength', 7, {\n\t\t\ttype: 'int',\n\t\t\tenableQuery\n\t\t});\n\n\t\tthis.add('Accounts_Password_Policy_MaxLength', -1, {\n\t\t\ttype: 'int',\n\t\t\tenableQuery\n\t\t});\n\n\t\tthis.add('Accounts_Password_Policy_ForbidRepeatingCharacters', true, {\n\t\t\ttype: 'boolean',\n\t\t\tenableQuery\n\t\t});\n\n\t\tthis.add('Accounts_Password_Policy_ForbidRepeatingCharactersCount', 3, {\n\t\t\ttype: 'int',\n\t\t\tenableQuery\n\t\t});\n\n\t\tthis.add('Accounts_Password_Policy_AtLeastOneLowercase', true, {\n\t\t\ttype: 'boolean',\n\t\t\tenableQuery\n\t\t});\n\n\t\tthis.add('Accounts_Password_Policy_AtLeastOneUppercase', true, {\n\t\t\ttype: 'boolean',\n\t\t\tenableQuery\n\t\t});\n\n\t\tthis.add('Accounts_Password_Policy_AtLeastOneNumber', true, {\n\t\t\ttype: 'boolean',\n\t\t\tenableQuery\n\t\t});\n\n\t\tthis.add('Accounts_Password_Policy_AtLeastOneSpecialCharacter', true, {\n\t\t\ttype: 'boolean',\n\t\t\tenableQuery\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('OAuth', function() {\n\tthis.section('Facebook', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Facebook',\n\t\t\tvalue: true\n\t\t};\n\t\tthis.add('Accounts_OAuth_Facebook', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_OAuth_Facebook_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\tthis.add('Accounts_OAuth_Facebook_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Facebook_callback_url', '_oauth/facebook', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery\n\t\t});\n\t});\n\tthis.section('Google', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Google',\n\t\t\tvalue: true\n\t\t};\n\t\tthis.add('Accounts_OAuth_Google', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_OAuth_Google_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\tthis.add('Accounts_OAuth_Google_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Google_callback_url', '_oauth/google', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery\n\t\t});\n\t});\n\tthis.section('GitHub', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Github',\n\t\t\tvalue: true\n\t\t};\n\t\tthis.add('Accounts_OAuth_Github', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_OAuth_Github_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\tthis.add('Accounts_OAuth_Github_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Github_callback_url', '_oauth/github', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery\n\t\t});\n\t});\n\tthis.section('Linkedin', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Linkedin',\n\t\t\tvalue: true\n\t\t};\n\t\tthis.add('Accounts_OAuth_Linkedin', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_OAuth_Linkedin_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\tthis.add('Accounts_OAuth_Linkedin_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Linkedin_callback_url', '_oauth/linkedin', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery\n\t\t});\n\t});\n\tthis.section('Meteor', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Meteor',\n\t\t\tvalue: true\n\t\t};\n\t\tthis.add('Accounts_OAuth_Meteor', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_OAuth_Meteor_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\tthis.add('Accounts_OAuth_Meteor_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Meteor_callback_url', '_oauth/meteor', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery\n\t\t});\n\t});\n\tthis.section('Twitter', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Twitter',\n\t\t\tvalue: true\n\t\t};\n\t\tthis.add('Accounts_OAuth_Twitter', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Accounts_OAuth_Twitter_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\tthis.add('Accounts_OAuth_Twitter_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Twitter_callback_url', '_oauth/twitter', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery\n\t\t});\n\t});\n\treturn this.section('Proxy', function() {\n\t\tthis.add('Accounts_OAuth_Proxy_host', 'https://oauth-proxy.rocket.chat', {\n\t\t\ttype: 'string',\n\t\t\t'public': true\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Proxy_services', '', {\n\t\t\ttype: 'string',\n\t\t\t'public': true\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('General', function() {\n\tthis.add('Show_Setup_Wizard', 'pending', {\n\t\ttype: 'select',\n\t\tpublic: true,\n\t\tvalues: [\n\t\t\t{\n\t\t\t\tkey: 'pending',\n\t\t\t\ti18nLabel: 'Pending'\n\t\t\t}, {\n\t\t\t\tkey: 'in_progress',\n\t\t\t\ti18nLabel: 'In_progress'\n\t\t\t}, {\n\t\t\t\tkey: 'completed',\n\t\t\t\ti18nLabel: 'Completed'\n\t\t\t}\n\t\t]\n\t});\n\tthis.add('Site_Url', typeof __meteor_runtime_config__ !== 'undefined' && __meteor_runtime_config__ !== null ? __meteor_runtime_config__.ROOT_URL : null, {\n\t\ttype: 'string',\n\t\ti18nDescription: 'Site_Url_Description',\n\t\t'public': true\n\t});\n\tthis.add('Site_Name', 'Rocket.Chat', {\n\t\ttype: 'string',\n\t\t'public': true,\n\t\twizard: {\n\t\t\tstep: 3,\n\t\t\torder: 0\n\t\t}\n\t});\n\tthis.add('Document_Domain', '', {\n\t\ttype: 'string',\n\t\t'public': true\n\t});\n\tthis.add('Language', '', {\n\t\ttype: 'language',\n\t\t'public': true,\n\t\twizard: {\n\t\t\tstep: 3,\n\t\t\torder: 1\n\t\t}\n\t});\n\tthis.add('Allow_Invalid_SelfSigned_Certs', false, {\n\t\ttype: 'boolean'\n\t});\n\tthis.add('Favorite_Rooms', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('First_Channel_After_Login', '', {\n\t\ttype: 'string',\n\t\t'public': true\n\t});\n\tthis.add('Unread_Count', 'user_and_group_mentions_only', {\n\t\ttype: 'select',\n\t\tvalues: [\n\t\t\t{\n\t\t\t\tkey: 'all_messages',\n\t\t\t\ti18nLabel: 'All_messages'\n\t\t\t}, {\n\t\t\t\tkey: 'user_mentions_only',\n\t\t\t\ti18nLabel: 'User_mentions_only'\n\t\t\t}, {\n\t\t\t\tkey: 'group_mentions_only',\n\t\t\t\ti18nLabel: 'Group_mentions_only'\n\t\t\t}, {\n\t\t\t\tkey: 'user_and_group_mentions_only',\n\t\t\t\ti18nLabel: 'User_and_group_mentions_only'\n\t\t\t}\n\t\t],\n\t\t'public': true\n\t});\n\tthis.add('Unread_Count_DM', 'all_messages', {\n\t\ttype: 'select',\n\t\tvalues: [\n\t\t\t{\n\t\t\t\tkey: 'all_messages',\n\t\t\t\ti18nLabel: 'All_messages'\n\t\t\t}, {\n\t\t\t\tkey: 'mentions_only',\n\t\t\t\ti18nLabel: 'Mentions_only'\n\t\t\t}\n\t\t],\n\t\t'public': true\n\t});\n\tthis.add('CDN_PREFIX', '', {\n\t\ttype: 'string',\n\t\t'public': true\n\t});\n\tthis.add('Force_SSL', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('GoogleTagManager_id', '', {\n\t\ttype: 'string',\n\t\t'public': true\n\t});\n\tthis.add('Bugsnag_api_key', '', {\n\t\ttype: 'string',\n\t\t'public': false\n\t});\n\tthis.add('Force_Disable_OpLog_For_Cache', false, {\n\t\ttype: 'boolean',\n\t\t'public': false\n\t});\n\tthis.add('Restart', 'restart_server', {\n\t\ttype: 'action',\n\t\tactionText: 'Restart_the_server'\n\t});\n\tthis.add('Store_Last_Message', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t\ti18nDescription: 'Store_Last_Message_Sent_per_Room'\n\t});\n\tthis.section('UTF8', function() {\n\t\tthis.add('UTF8_Names_Validation', '[0-9a-zA-Z-_.]+', {\n\t\t\ttype: 'string',\n\t\t\t'public': true,\n\t\t\ti18nDescription: 'UTF8_Names_Validation_Description'\n\t\t});\n\t\treturn this.add('UTF8_Names_Slugify', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t});\n\tthis.section('Reporting', function() {\n\t\treturn this.add('Statistics_reporting', true, {\n\t\t\ttype: 'boolean'\n\t\t});\n\t});\n\tthis.section('Notifications', function() {\n\t\tthis.add('Notifications_Max_Room_Members', 100, {\n\t\t\ttype: 'int',\n\t\t\tpublic: true,\n\t\t\ti18nDescription: 'Notifications_Max_Room_Members_Description'\n\t\t});\n\n\t\tthis.add('Notifications_Always_Notify_Mobile', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nDescription: 'Notifications_Always_Notify_Mobile_Description'\n\t\t});\n\t});\n\tthis.section('REST API', function() {\n\t\treturn this.add('API_User_Limit', 500, {\n\t\t\ttype: 'int',\n\t\t\t'public': true,\n\t\t\ti18nDescription: 'API_User_Limit'\n\t\t});\n\t});\n\tthis.section('Iframe_Integration', function() {\n\t\tthis.add('Iframe_Integration_send_enable', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Iframe_Integration_send_target_origin', '*', {\n\t\t\ttype: 'string',\n\t\t\t'public': true,\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Iframe_Integration_send_enable',\n\t\t\t\tvalue: true\n\t\t\t}\n\t\t});\n\t\tthis.add('Iframe_Integration_receive_enable', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\treturn this.add('Iframe_Integration_receive_origin', '*', {\n\t\t\ttype: 'string',\n\t\t\t'public': true,\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Iframe_Integration_receive_enable',\n\t\t\t\tvalue: true\n\t\t\t}\n\t\t});\n\t});\n\tthis.section('Translations', function() {\n\t\treturn this.add('Custom_Translations', '', {\n\t\t\ttype: 'code',\n\t\t\t'public': true\n\t\t});\n\t});\n\treturn this.section('Stream_Cast', function() {\n\t\treturn this.add('Stream_Cast_Address', '', {\n\t\t\ttype: 'string'\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('Email', function() {\n\tthis.section('Subject', function() {\n\t\tthis.add('Offline_DM_Email', '[[Site_Name]] You have been direct messaged by [User]', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Offline_DM_Email',\n\t\t\ti18nDescription: 'Offline_Email_Subject_Description'\n\t\t});\n\t\tthis.add('Offline_Mention_Email', '[[Site_Name]] You have been mentioned by [User] in #[Room]', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Offline_Mention_Email',\n\t\t\ti18nDescription: 'Offline_Email_Subject_Description'\n\t\t});\n\t\treturn this.add('Offline_Mention_All_Email', '[User] has posted a message in #[Room]', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Offline_Mention_All_Email',\n\t\t\ti18nDescription: 'Offline_Email_Subject_Description'\n\t\t});\n\t});\n\tthis.section('Header_and_Footer', function() {\n\t\tthis.add('Email_Header', '<html><table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" bgcolor=\"#f3f3f3\" style=\"color:#4a4a4a;font-family: Helvetica,Arial,sans-serif;font-size:14px;line-height:20px;border-collapse:collapse;border-spacing:0;margin:0 auto\"><tr><td style=\"padding:1em\"><table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" width=\"100%\" style=\"width:100%;margin:0 auto;max-width:800px\"><tr><td bgcolor=\"#ffffff\" style=\"background-color:#ffffff; border: 1px solid #DDD; font-size: 10pt; font-family: Helvetica,Arial,sans-serif;\"><table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><tr><td style=\"background-color: #04436a;\"><h1 style=\"font-family: Helvetica,Arial,sans-serif; padding: 0 1em; margin: 0; line-height: 70px; color: #FFF;\">[Site_Name]</h1></td></tr><tr><td style=\"padding: 1em; font-size: 10pt; font-family: Helvetica,Arial,sans-serif;\">', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Header'\n\t\t});\n\t\tthis.add('Email_Footer', '</td></tr></table></td></tr><tr><td border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" style=\"font-family: Helvetica,Arial,sans-serif; max-width: 800px; margin: 0 auto; padding: 1.5em; text-align: center; font-size: 8pt; color: #999;\">Powered by <a href=\"https://rocket.chat\" target=\"_blank\">Rocket.Chat</a></td></tr></table></td></tr></table></html>', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Footer'\n\t\t});\n\t\treturn this.add('Email_Footer_Direct_Reply', '</td></tr></table></td></tr><tr><td border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" style=\"font-family: Helvetica,Arial,sans-serif; max-width: 800px; margin: 0 auto; padding: 1.5em; text-align: center; font-size: 8pt; color: #999;\">You can directly reply to this email.<br>Do not modify previous emails in the thread.<br>Powered by <a href=\"https://rocket.chat\" target=\"_blank\">Rocket.Chat</a></td></tr></table></td></tr></table></html>', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Footer_Direct_Reply'\n\t\t});\n\t});\n\tthis.section('Direct_Reply', function() {\n\t\tthis.add('Direct_Reply_Enable', false, {\n\t\t\ttype: 'boolean',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Direct_Reply_Enable'\n\t\t});\n\t\tthis.add('Direct_Reply_Debug', false, {\n\t\t\ttype: 'boolean',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Direct_Reply_Debug',\n\t\t\ti18nDescription: 'Direct_Reply_Debug_Description'\n\t\t});\n\t\tthis.add('Direct_Reply_Protocol', 'IMAP', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'IMAP',\n\t\t\t\t\ti18nLabel: 'IMAP'\n\t\t\t\t}, {\n\t\t\t\t\tkey: 'POP',\n\t\t\t\t\ti18nLabel: 'POP'\n\t\t\t\t}\n\t\t\t],\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Protocol'\n\t\t});\n\t\tthis.add('Direct_Reply_Host', '', {\n\t\t\ttype: 'string',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Host'\n\t\t});\n\t\tthis.add('Direct_Reply_Port', '', {\n\t\t\ttype: 'string',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Port'\n\t\t});\n\t\tthis.add('Direct_Reply_IgnoreTLS', false, {\n\t\t\ttype: 'boolean',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'IgnoreTLS'\n\t\t});\n\t\tthis.add('Direct_Reply_Frequency', 5, {\n\t\t\ttype: 'int',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Direct_Reply_Frequency',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Direct_Reply_Protocol',\n\t\t\t\tvalue: 'POP'\n\t\t\t}\n\t\t});\n\t\tthis.add('Direct_Reply_Delete', true, {\n\t\t\ttype: 'boolean',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Direct_Reply_Delete',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Direct_Reply_Protocol',\n\t\t\t\tvalue: 'IMAP'\n\t\t\t}\n\t\t});\n\t\tthis.add('Direct_Reply_Separator', '+', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: '!',\n\t\t\t\t\ti18nLabel: '!'\n\t\t\t\t}, {\n\t\t\t\t\tkey: '#',\n\t\t\t\t\ti18nLabel: '#'\n\t\t\t\t}, {\n\t\t\t\t\tkey: '$',\n\t\t\t\t\ti18nLabel: '$'\n\t\t\t\t}, {\n\t\t\t\t\tkey: '%',\n\t\t\t\t\ti18nLabel: '%'\n\t\t\t\t}, {\n\t\t\t\t\tkey: '&',\n\t\t\t\t\ti18nLabel: '&'\n\t\t\t\t}, {\n\t\t\t\t\tkey: '\\'',\n\t\t\t\t\ti18nLabel: '\\''\n\t\t\t\t}, {\n\t\t\t\t\tkey: '*',\n\t\t\t\t\ti18nLabel: '*'\n\t\t\t\t}, {\n\t\t\t\t\tkey: '+',\n\t\t\t\t\ti18nLabel: '+'\n\t\t\t\t}, {\n\t\t\t\t\tkey: '-',\n\t\t\t\t\ti18nLabel: '-'\n\t\t\t\t}, {\n\t\t\t\t\tkey: '/',\n\t\t\t\t\ti18nLabel: '/'\n\t\t\t\t}, {\n\t\t\t\t\tkey: '=',\n\t\t\t\t\ti18nLabel: '='\n\t\t\t\t}, {\n\t\t\t\t\tkey: '?',\n\t\t\t\t\ti18nLabel: '?'\n\t\t\t\t}, {\n\t\t\t\t\tkey: '^',\n\t\t\t\t\ti18nLabel: '^'\n\t\t\t\t}, {\n\t\t\t\t\tkey: '_',\n\t\t\t\t\ti18nLabel: '_'\n\t\t\t\t}, {\n\t\t\t\t\tkey: '`',\n\t\t\t\t\ti18nLabel: '`'\n\t\t\t\t}, {\n\t\t\t\t\tkey: '{',\n\t\t\t\t\ti18nLabel: '{'\n\t\t\t\t}, {\n\t\t\t\t\tkey: '|',\n\t\t\t\t\ti18nLabel: '|'\n\t\t\t\t}, {\n\t\t\t\t\tkey: '}',\n\t\t\t\t\ti18nLabel: '}'\n\t\t\t\t}, {\n\t\t\t\t\tkey: '~',\n\t\t\t\t\ti18nLabel: '~'\n\t\t\t\t}\n\t\t\t],\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Direct_Reply_Separator'\n\t\t});\n\t\tthis.add('Direct_Reply_Username', '', {\n\t\t\ttype: 'string',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Username',\n\t\t\tplaceholder: 'email@domain'\n\t\t});\n\t\tthis.add('Direct_Reply_ReplyTo', '', {\n\t\t\ttype: 'string',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'ReplyTo',\n\t\t\tplaceholder: 'email@domain'\n\t\t});\n\t\treturn this.add('Direct_Reply_Password', '', {\n\t\t\ttype: 'password',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Password'\n\t\t});\n\t});\n\tthis.section('SMTP', function() {\n\t\tthis.add('SMTP_Protocol', 'smtp', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'smtp',\n\t\t\t\t\ti18nLabel: 'smtp'\n\t\t\t\t}, {\n\t\t\t\t\tkey: 'smtps',\n\t\t\t\t\ti18nLabel: 'smtps'\n\t\t\t\t}\n\t\t\t],\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Protocol'\n\t\t});\n\t\tthis.add('SMTP_Host', '', {\n\t\t\ttype: 'string',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Host'\n\t\t});\n\t\tthis.add('SMTP_Port', '', {\n\t\t\ttype: 'string',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Port'\n\t\t});\n\t\tthis.add('SMTP_IgnoreTLS', false, {\n\t\t\ttype: 'boolean',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'IgnoreTLS',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'SMTP_Protocol',\n\t\t\t\tvalue: 'smtp'\n\t\t\t}\n\t\t});\n\t\tthis.add('SMTP_Pool', true, {\n\t\t\ttype: 'boolean',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Pool'\n\t\t});\n\t\tthis.add('SMTP_Username', '', {\n\t\t\ttype: 'string',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Username',\n\t\t\tautocomplete: false\n\t\t});\n\t\tthis.add('SMTP_Password', '', {\n\t\t\ttype: 'password',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Password',\n\t\t\tautocomplete: false\n\t\t});\n\t\tthis.add('From_Email', '', {\n\t\t\ttype: 'string',\n\t\t\tplaceholder: 'email@domain'\n\t\t});\n\t\treturn this.add('SMTP_Test_Button', 'sendSMTPTestEmail', {\n\t\t\ttype: 'action',\n\t\t\tactionText: 'Send_a_test_mail_to_my_user'\n\t\t});\n\t});\n\tthis.section('Invitation', function() {\n\t\tthis.add('Invitation_Customized', false, {\n\t\t\ttype: 'boolean',\n\t\t\ti18nLabel: 'Custom'\n\t\t});\n\t\tthis.add('Invitation_Subject', '', {\n\t\t\ttype: 'string',\n\t\t\ti18nLabel: 'Subject',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Invitation_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Invitation_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t\treturn this.add('Invitation_HTML', '', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Body',\n\t\t\ti18nDescription: 'Invitation_HTML_Description',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Invitation_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Invitation_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t});\n\tthis.section('Registration', function() {\n\t\tthis.add('Accounts_Enrollment_Customized', false, {\n\t\t\ttype: 'boolean',\n\t\t\ti18nLabel: 'Custom'\n\t\t});\n\t\tthis.add('Accounts_Enrollment_Email_Subject', '', {\n\t\t\ttype: 'string',\n\t\t\ti18nLabel: 'Subject',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Accounts_Enrollment_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Accounts_Enrollment_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t\treturn this.add('Accounts_Enrollment_Email', '', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Body',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Accounts_Enrollment_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Accounts_Enrollment_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t});\n\tthis.section('Registration_via_Admin', function() {\n\t\tthis.add('Accounts_UserAddedEmail_Customized', false, {\n\t\t\ttype: 'boolean',\n\t\t\ti18nLabel: 'Custom'\n\t\t});\n\t\tthis.add('Accounts_UserAddedEmailSubject', '', {\n\t\t\ttype: 'string',\n\t\t\ti18nLabel: 'Subject',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Accounts_UserAddedEmail_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Accounts_UserAddedEmail_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t\treturn this.add('Accounts_UserAddedEmail', '', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Body',\n\t\t\ti18nDescription: 'Accounts_UserAddedEmail_Description',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Accounts_UserAddedEmail_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Accounts_UserAddedEmail_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t});\n\tthis.section('Forgot_password_section', function() {\n\t\tthis.add('Forgot_Password_Customized', false, {\n\t\t\ttype: 'boolean',\n\t\t\ti18nLabel: 'Custom'\n\t\t});\n\t\tthis.add('Forgot_Password_Email_Subject', '', {\n\t\t\ttype: 'string',\n\t\t\ti18nLabel: 'Subject',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Forgot_Password_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Forgot_Password_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t\treturn this.add('Forgot_Password_Email', '', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Body',\n\t\t\ti18nDescription: 'Forgot_Password_Description',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Forgot_Password_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Forgot_Password_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t});\n\treturn this.section('Verification', function() {\n\t\tthis.add('Verification_Customized', false, {\n\t\t\ttype: 'boolean',\n\t\t\ti18nLabel: 'Custom'\n\t\t});\n\t\tthis.add('Verification_Email_Subject', '', {\n\t\t\ttype: 'string',\n\t\t\ti18nLabel: 'Subject',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Verification_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Verification_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t\treturn this.add('Verification_Email', '', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Body',\n\t\t\ti18nDescription: 'Verification_Description',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Verification_Customized',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nDefaultQuery: {\n\t\t\t\t_id: 'Verification_Customized',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('Message', function() {\n\tthis.section('Message_Attachments', function() {\n\t\tthis.add('Message_Attachments_GroupAttach', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nDescription: 'Message_Attachments_GroupAttachDescription'\n\t\t});\n\t});\n\tthis.section('Message_Audio', function() {\n\t\tthis.add('Message_AudioRecorderEnabled', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true,\n\t\t\ti18nDescription: 'Message_AudioRecorderEnabledDescription'\n\t\t});\n\t\tthis.add('Message_Audio_bitRate', 32, {\n\t\t\ttype: 'int',\n\t\t\t'public': true\n\t\t});\n\t});\n\tthis.add('Message_AllowEditing', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_AllowEditing_BlockEditInMinutes', 0, {\n\t\ttype: 'int',\n\t\t'public': true,\n\t\ti18nDescription: 'Message_AllowEditing_BlockEditInMinutesDescription'\n\t});\n\tthis.add('Message_AllowDeleting', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_AllowDeleting_BlockDeleteInMinutes', 0, {\n\t\ttype: 'int',\n\t\t'public': true,\n\t\ti18nDescription: 'Message_AllowDeleting_BlockDeleteInMinutes'\n\t});\n\tthis.add('Message_AllowUnrecognizedSlashCommand', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_AllowDirectMessagesToYourself', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_AlwaysSearchRegExp', false, {\n\t\ttype: 'boolean'\n\t});\n\tthis.add('Message_ShowEditedStatus', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_ShowDeletedStatus', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_AllowBadWordsFilter', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_BadWordsFilterList', '', {\n\t\ttype: 'string',\n\t\t'public': true\n\t});\n\tthis.add('Message_KeepHistory', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_MaxAll', 0, {\n\t\ttype: 'int',\n\t\t'public': true\n\t});\n\tthis.add('Message_MaxAllowedSize', 5000, {\n\t\ttype: 'int',\n\t\t'public': true\n\t});\n\tthis.add('Message_ShowFormattingTips', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_SetNameToAliasEnabled', false, {\n\t\ttype: 'boolean',\n\t\t'public': false,\n\t\ti18nDescription: 'Message_SetNameToAliasEnabled_Description'\n\t});\n\tthis.add('Message_GroupingPeriod', 300, {\n\t\ttype: 'int',\n\t\t'public': true,\n\t\ti18nDescription: 'Message_GroupingPeriodDescription'\n\t});\n\tthis.add('API_Embed', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('API_Embed_UserAgent', 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2227.0 Safari/537.36', {\n\t\ttype: 'string',\n\t\t'public': true\n\t});\n\tthis.add('API_EmbedCacheExpirationDays', 30, {\n\t\ttype: 'int',\n\t\t'public': false\n\t});\n\tthis.add('API_Embed_clear_cache_now', 'OEmbedCacheCleanup', {\n\t\ttype: 'action',\n\t\tactionText: 'clear',\n\t\ti18nLabel: 'clear_cache_now'\n\t});\n\tthis.add('API_EmbedDisabledFor', '', {\n\t\ttype: 'string',\n\t\t'public': true,\n\t\ti18nDescription: 'API_EmbedDisabledFor_Description'\n\t});\n\tthis.add('API_EmbedIgnoredHosts', 'localhost, 127.0.0.1, 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16', {\n\t\ttype: 'string',\n\t\ti18nDescription: 'API_EmbedIgnoredHosts_Description'\n\t});\n\tthis.add('API_EmbedSafePorts', '80, 443', {\n\t\ttype: 'string'\n\t});\n\tthis.add('Message_TimeFormat', 'LT', {\n\t\ttype: 'string',\n\t\t'public': true,\n\t\ti18nDescription: 'Message_TimeFormat_Description'\n\t});\n\tthis.add('Message_DateFormat', 'LL', {\n\t\ttype: 'string',\n\t\t'public': true,\n\t\ti18nDescription: 'Message_DateFormat_Description'\n\t});\n\tthis.add('Message_TimeAndDateFormat', 'LLL', {\n\t\ttype: 'string',\n\t\t'public': true,\n\t\ti18nDescription: 'Message_TimeAndDateFormat_Description'\n\t});\n\tthis.add('Message_QuoteChainLimit', 2, {\n\t\ttype: 'int',\n\t\t'public': true\n\t});\n\tthis.add('Message_HideType_uj', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_HideType_ul', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_HideType_ru', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Message_HideType_au', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\n\tthis.add('Message_HideType_mute_unmute', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\n\tthis.add('Message_ErasureType', 'Delete', {\n\t\ttype: 'select',\n\t\t'public': true,\n\t\tvalues: [\n\t\t\t{\n\t\t\t\tkey: 'Keep',\n\t\t\t\ti18nLabel: 'Message_ErasureType_Keep'\n\t\t\t}, {\n\t\t\t\tkey: 'Delete',\n\t\t\t\ti18nLabel: 'Message_ErasureType_Delete'\n\t\t\t}, {\n\t\t\t\tkey: 'Unlink',\n\t\t\t\ti18nLabel: 'Message_ErasureType_Unlink'\n\t\t\t}\n\t\t]\n\t});\n});\n\nRocketChat.settings.addGroup('Meta', function() {\n\tthis.add('Meta_language', '', {\n\t\ttype: 'string'\n\t});\n\tthis.add('Meta_fb_app_id', '', {\n\t\ttype: 'string'\n\t});\n\tthis.add('Meta_robots', 'INDEX,FOLLOW', {\n\t\ttype: 'string'\n\t});\n\tthis.add('Meta_google-site-verification', '', {\n\t\ttype: 'string'\n\t});\n\tthis.add('Meta_msvalidate01', '', {\n\t\ttype: 'string'\n\t});\n\treturn this.add('Meta_custom', '', {\n\t\ttype: 'code',\n\t\tcode: 'text/html',\n\t\tmultiline: true\n\t});\n});\n\nRocketChat.settings.addGroup('Push', function() {\n\tthis.add('Push_enable', true, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Push_debug', false, {\n\t\ttype: 'boolean',\n\t\t'public': true,\n\t\tenableQuery: {\n\t\t\t_id: 'Push_enable',\n\t\t\tvalue: true\n\t\t}\n\t});\n\tthis.add('Push_enable_gateway', true, {\n\t\ttype: 'boolean',\n\t\tenableQuery: {\n\t\t\t_id: 'Push_enable',\n\t\t\tvalue: true\n\t\t}\n\t});\n\tthis.add('Push_gateway', 'https://gateway.rocket.chat', {\n\t\ttype: 'string',\n\t\tenableQuery: [\n\t\t\t{\n\t\t\t\t_id: 'Push_enable',\n\t\t\t\tvalue: true\n\t\t\t}, {\n\t\t\t\t_id: 'Push_enable_gateway',\n\t\t\t\tvalue: true\n\t\t\t}\n\t\t]\n\t});\n\tthis.add('Push_production', true, {\n\t\ttype: 'boolean',\n\t\t'public': true,\n\t\tenableQuery: [\n\t\t\t{\n\t\t\t\t_id: 'Push_enable',\n\t\t\t\tvalue: true\n\t\t\t}, {\n\t\t\t\t_id: 'Push_enable_gateway',\n\t\t\t\tvalue: false\n\t\t\t}\n\t\t]\n\t});\n\tthis.add('Push_test_push', 'push_test', {\n\t\ttype: 'action',\n\t\tactionText: 'Send_a_test_push_to_my_user',\n\t\tenableQuery: {\n\t\t\t_id: 'Push_enable',\n\t\t\tvalue: true\n\t\t}\n\t});\n\tthis.section('Certificates_and_Keys', function() {\n\t\tthis.add('Push_apn_passphrase', '', {\n\t\t\ttype: 'string'\n\t\t});\n\t\tthis.add('Push_apn_key', '', {\n\t\t\ttype: 'string',\n\t\t\tmultiline: true\n\t\t});\n\t\tthis.add('Push_apn_cert', '', {\n\t\t\ttype: 'string',\n\t\t\tmultiline: true\n\t\t});\n\t\tthis.add('Push_apn_dev_passphrase', '', {\n\t\t\ttype: 'string'\n\t\t});\n\t\tthis.add('Push_apn_dev_key', '', {\n\t\t\ttype: 'string',\n\t\t\tmultiline: true\n\t\t});\n\t\tthis.add('Push_apn_dev_cert', '', {\n\t\t\ttype: 'string',\n\t\t\tmultiline: true\n\t\t});\n\t\tthis.add('Push_gcm_api_key', '', {\n\t\t\ttype: 'string'\n\t\t});\n\t\treturn this.add('Push_gcm_project_number', '', {\n\t\t\ttype: 'string',\n\t\t\t'public': true\n\t\t});\n\t});\n\treturn this.section('Privacy', function() {\n\t\tthis.add('Push_show_username_room', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\treturn this.add('Push_show_message', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('Layout', function() {\n\tthis.section('Content', function() {\n\t\tthis.add('Layout_Home_Title', 'Home', {\n\t\t\ttype: 'string',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Layout_Home_Body', '<p>Welcome to Rocket.Chat!</p>\\n<p>The Rocket.Chat desktops apps for Windows, macOS and Linux are available to download <a title=\"Rocket.Chat desktop apps\" href=\"https://rocket.chat/download\" target=\"_blank\" rel=\"noopener\">here</a>.</p><p>The native mobile app, Rocket.Chat+,\\n  for Android and iOS is available from <a title=\"Rocket.Chat+ on Google Play\" href=\"https://play.google.com/store/apps/details?id=chat.rocket.android\" target=\"_blank\" rel=\"noopener\">Google Play</a> and the <a title=\"Rocket.Chat+ on the App Store\" href=\"https://itunes.apple.com/app/rocket-chat/id1148741252\" target=\"_blank\" rel=\"noopener\">App Store</a>.</p>\\n<p>For further help, please consult the <a title=\"Rocket.Chat Documentation\" href=\"https://rocket.chat/docs/\" target=\"_blank\" rel=\"noopener\">documentation</a>.</p>\\n<p>If you\\'re an admin, feel free to change this content via <strong>Administration</strong> -> <strong>Layout</strong> -> <strong>Home Body</strong>. Or clicking <a title=\"Home Body Layout\" href=\"/admin/Layout\">here</a>.</p>', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Layout_Terms_of_Service', 'Terms of Service <br> Go to APP SETTINGS -> Layout to customize this page.', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Layout_Login_Terms', 'By proceeding you are agreeing to our <a href=\"terms-of-service\">Terms of Service</a> and <a href=\"privacy-policy\">Privacy Policy</a>.', {\n\t\t\ttype: 'string',\n\t\t\tmultiline: true,\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('Layout_Privacy_Policy', 'Privacy Policy <br> Go to APP SETTINGS -> Layout to customize this page.', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\t'public': true\n\t\t});\n\t\treturn this.add('Layout_Sidenav_Footer', '<a href=\"/home\"><img src=\"assets/logo\"/></a>', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\t'public': true,\n\t\t\ti18nDescription: 'Layout_Sidenav_Footer_description'\n\t\t});\n\t});\n\tthis.section('Custom_Scripts', function() {\n\t\tthis.add('Custom_Script_Logged_Out', '//Add your script', {\n\t\t\ttype: 'code',\n\t\t\tmultiline: true,\n\t\t\t'public': true\n\t\t});\n\t\treturn this.add('Custom_Script_Logged_In', '//Add your script', {\n\t\t\ttype: 'code',\n\t\t\tmultiline: true,\n\t\t\t'public': true\n\t\t});\n\t});\n\treturn this.section('User_Interface', function() {\n\t\tthis.add('UI_DisplayRoles', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('UI_Group_Channels_By_Type', true, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': false\n\t\t});\n\t\tthis.add('UI_Use_Name_Avatar', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('UI_Use_Real_Name', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('UI_Click_Direct_Message', false, {\n\t\t\ttype: 'boolean',\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('UI_Unread_Counter_Style', 'Different_Style_For_User_Mentions', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'Same_Style_For_Mentions',\n\t\t\t\t\ti18nLabel: 'Same_Style_For_Mentions'\n\t\t\t\t}, {\n\t\t\t\t\tkey: 'Different_Style_For_User_Mentions',\n\t\t\t\t\ti18nLabel: 'Different_Style_For_User_Mentions'\n\t\t\t\t}\n\t\t\t],\n\t\t\t'public': true\n\t\t});\n\t\tthis.add('UI_Allow_room_names_with_special_chars', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('Logs', function() {\n\tthis.add('Log_Level', '0', {\n\t\ttype: 'select',\n\t\tvalues: [\n\t\t\t{\n\t\t\t\tkey: '0',\n\t\t\t\ti18nLabel: '0_Errors_Only'\n\t\t\t}, {\n\t\t\t\tkey: '1',\n\t\t\t\ti18nLabel: '1_Errors_and_Information'\n\t\t\t}, {\n\t\t\t\tkey: '2',\n\t\t\t\ti18nLabel: '2_Erros_Information_and_Debug'\n\t\t\t}\n\t\t],\n\t\t'public': true\n\t});\n\tthis.add('Log_Package', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Log_File', false, {\n\t\ttype: 'boolean',\n\t\t'public': true\n\t});\n\tthis.add('Log_View_Limit', 1000, {\n\t\ttype: 'int'\n\t});\n\n\tthis.add('Log_Trace_Methods', false, {\n\t\ttype: 'boolean'\n\t});\n\n\tthis.add('Log_Trace_Methods_Filter', '', {\n\t\ttype: 'string',\n\t\tenableQuery: {\n\t\t\t_id: 'Log_Trace_Methods',\n\t\t\tvalue: true\n\t\t}\n\t});\n\n\tthis.add('Log_Trace_Subscriptions', false, {\n\t\ttype: 'boolean'\n\t});\n\n\tthis.add('Log_Trace_Subscriptions_Filter', '', {\n\t\ttype: 'string',\n\t\tenableQuery: {\n\t\t\t_id: 'Log_Trace_Subscriptions',\n\t\t\tvalue: true\n\t\t}\n\t});\n\n\tthis.section('Prometheus', function() {\n\t\tthis.add('Prometheus_Enabled', false, {\n\t\t\ttype: 'boolean',\n\t\t\ti18nLabel: 'Enabled'\n\t\t});\n\t\tthis.add('Prometheus_Port', 9100, {\n\t\t\ttype: 'string',\n\t\t\ti18nLabel: 'Port'\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('Setup_Wizard', function() {\n\tthis.section('Organization_Info', function() {\n\t\tthis.add('Organization_Type', '', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'nonprofit',\n\t\t\t\t\ti18nLabel: 'Nonprofit'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'enterprise',\n\t\t\t\t\ti18nLabel: 'Enterprise'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'government',\n\t\t\t\t\ti18nLabel: 'Government'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'community',\n\t\t\t\t\ti18nLabel: 'Community'\n\t\t\t\t}\n\t\t\t],\n\t\t\twizard: {\n\t\t\t\tstep: 2,\n\t\t\t\torder: 0\n\t\t\t}\n\t\t});\n\t\tthis.add('Organization_Name', '', {\n\t\t\ttype: 'string',\n\t\t\twizard: {\n\t\t\t\tstep: 2,\n\t\t\t\torder: 1\n\t\t\t}\n\t\t});\n\t\tthis.add('Industry', '', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'advocacy',\n\t\t\t\t\ti18nLabel: 'Advocacy'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'blockchain',\n\t\t\t\t\ti18nLabel: 'Blockchain'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'helpCenter',\n\t\t\t\t\ti18nLabel: 'Help_Center'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'manufacturing',\n\t\t\t\t\ti18nLabel: 'Manufacturing'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'education',\n\t\t\t\t\ti18nLabel: 'Education'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'insurance',\n\t\t\t\t\ti18nLabel: 'Insurance'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'logistics',\n\t\t\t\t\ti18nLabel: 'Logistics'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'consulting',\n\t\t\t\t\ti18nLabel: 'Consulting'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'entertainment',\n\t\t\t\t\ti18nLabel: 'Entertainment'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'publicRelations',\n\t\t\t\t\ti18nLabel: 'Public_Relations'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'religious',\n\t\t\t\t\ti18nLabel: 'Religious'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'gaming',\n\t\t\t\t\ti18nLabel: 'Gaming'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'socialNetwork',\n\t\t\t\t\ti18nLabel: 'Social_Network'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'realEstate',\n\t\t\t\t\ti18nLabel: 'Real_Estate'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'tourism',\n\t\t\t\t\ti18nLabel: 'Tourism'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'telecom',\n\t\t\t\t\ti18nLabel: 'Telecom'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'consumerGoods',\n\t\t\t\t\ti18nLabel: 'Consumer_Goods'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'financialServices',\n\t\t\t\t\ti18nLabel: 'Financial_Services'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'healthcarePharmaceutical',\n\t\t\t\t\ti18nLabel: 'Healthcare_and_Pharmaceutical'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'industry',\n\t\t\t\t\ti18nLabel: 'Industry'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'media',\n\t\t\t\t\ti18nLabel: 'Media'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'retail',\n\t\t\t\t\ti18nLabel: 'Retail'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'technologyServices',\n\t\t\t\t\ti18nLabel: 'Technology_Services'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'technologyProvider',\n\t\t\t\t\ti18nLabel: 'Technology_Provider'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'other',\n\t\t\t\t\ti18nLabel: 'Other'\n\t\t\t\t}\n\t\t\t],\n\t\t\twizard: {\n\t\t\t\tstep: 2,\n\t\t\t\torder: 2\n\t\t\t}\n\t\t});\n\t\tthis.add('Size', '', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: '0',\n\t\t\t\t\ti18nLabel: '1-10 people'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: '1',\n\t\t\t\t\ti18nLabel: '11-50 people'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: '2',\n\t\t\t\t\ti18nLabel: '51-100 people'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: '3',\n\t\t\t\t\ti18nLabel: '101-250 people'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: '4',\n\t\t\t\t\ti18nLabel: '251-500 people'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: '5',\n\t\t\t\t\ti18nLabel: '501-1000 people'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: '6',\n\t\t\t\t\ti18nLabel: '1001-4000 people'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: '7',\n\t\t\t\t\ti18nLabel: '4000 or more people'\n\t\t\t\t}\n\t\t\t],\n\t\t\twizard: {\n\t\t\t\tstep: 2,\n\t\t\t\torder: 3\n\t\t\t}\n\t\t});\n\t\tthis.add('Country', '', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'worldwide',\n\t\t\t\t\ti18nLabel: 'Worldwide'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'afghanistan',\n\t\t\t\t\ti18nLabel: 'Country_Afghanistan'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'albania',\n\t\t\t\t\ti18nLabel: 'Country_Albania'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'algeria',\n\t\t\t\t\ti18nLabel: 'Country_Algeria'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'americanSamoa',\n\t\t\t\t\ti18nLabel: 'Country_American_Samoa'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'andorra',\n\t\t\t\t\ti18nLabel: 'Country_Andorra'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'angola',\n\t\t\t\t\ti18nLabel: 'Country_Angola'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'anguilla',\n\t\t\t\t\ti18nLabel: 'Country_Anguilla'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'antarctica',\n\t\t\t\t\ti18nLabel: 'Country_Antarctica'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'antiguaAndBarbuda',\n\t\t\t\t\ti18nLabel: 'Country_Antigua_and_Barbuda'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'argentina',\n\t\t\t\t\ti18nLabel: 'Country_Argentina'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'armenia',\n\t\t\t\t\ti18nLabel: 'Country_Armenia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'aruba',\n\t\t\t\t\ti18nLabel: 'Country_Aruba'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'australia',\n\t\t\t\t\ti18nLabel: 'Country_Australia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'austria',\n\t\t\t\t\ti18nLabel: 'Country_Austria'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'azerbaijan',\n\t\t\t\t\ti18nLabel: 'Country_Azerbaijan'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bahamas',\n\t\t\t\t\ti18nLabel: 'Country_Bahamas'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bahrain',\n\t\t\t\t\ti18nLabel: 'Country_Bahrain'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bangladesh',\n\t\t\t\t\ti18nLabel: 'Country_Bangladesh'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'barbados',\n\t\t\t\t\ti18nLabel: 'Country_Barbados'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'belarus',\n\t\t\t\t\ti18nLabel: 'Country_Belarus'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'belgium',\n\t\t\t\t\ti18nLabel: 'Country_Belgium'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'belize',\n\t\t\t\t\ti18nLabel: 'Country_Belize'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'benin',\n\t\t\t\t\ti18nLabel: 'Country_Benin'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bermuda',\n\t\t\t\t\ti18nLabel: 'Country_Bermuda'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bhutan',\n\t\t\t\t\ti18nLabel: 'Country_Bhutan'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bolivia',\n\t\t\t\t\ti18nLabel: 'Country_Bolivia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bosniaAndHerzegovina',\n\t\t\t\t\ti18nLabel: 'Country_Bosnia_and_Herzegovina'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'botswana',\n\t\t\t\t\ti18nLabel: 'Country_Botswana'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bouvetIsland',\n\t\t\t\t\ti18nLabel: 'Country_Bouvet_Island'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'brazil',\n\t\t\t\t\ti18nLabel: 'Country_Brazil'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'britishIndianOceanTerritory',\n\t\t\t\t\ti18nLabel: 'Country_British_Indian_Ocean_Territory'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bruneiDarussalam',\n\t\t\t\t\ti18nLabel: 'Country_Brunei_Darussalam'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bulgaria',\n\t\t\t\t\ti18nLabel: 'Country_Bulgaria'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'burkinaFaso',\n\t\t\t\t\ti18nLabel: 'Country_Burkina_Faso'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'burundi',\n\t\t\t\t\ti18nLabel: 'Country_Burundi'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'cambodia',\n\t\t\t\t\ti18nLabel: 'Country_Cambodia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'cameroon',\n\t\t\t\t\ti18nLabel: 'Country_Cameroon'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'canada',\n\t\t\t\t\ti18nLabel: 'Country_Canada'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'capeVerde',\n\t\t\t\t\ti18nLabel: 'Country_Cape_Verde'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'caymanIslands',\n\t\t\t\t\ti18nLabel: 'Country_Cayman_Islands'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'centralAfricanRepublic',\n\t\t\t\t\ti18nLabel: 'Country_Central_African_Republic'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'chad',\n\t\t\t\t\ti18nLabel: 'Country_Chad'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'chile',\n\t\t\t\t\ti18nLabel: 'Country_Chile'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'china',\n\t\t\t\t\ti18nLabel: 'Country_China'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'christmasIsland',\n\t\t\t\t\ti18nLabel: 'Country_Christmas_Island'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'cocosKeelingIslands',\n\t\t\t\t\ti18nLabel: 'Country_Cocos_Keeling_Islands'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'colombia',\n\t\t\t\t\ti18nLabel: 'Country_Colombia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'comoros',\n\t\t\t\t\ti18nLabel: 'Country_Comoros'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'congo',\n\t\t\t\t\ti18nLabel: 'Country_Congo'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'congoTheDemocraticRepublicOfThe',\n\t\t\t\t\ti18nLabel: 'Country_Congo_The_Democratic_Republic_of_The'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'cookIslands',\n\t\t\t\t\ti18nLabel: 'Country_Cook_Islands'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'costaRica',\n\t\t\t\t\ti18nLabel: 'Country_Costa_Rica'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'coteDivoire',\n\t\t\t\t\ti18nLabel: 'Country_Cote_Divoire'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'croatia',\n\t\t\t\t\ti18nLabel: 'Country_Croatia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'cuba',\n\t\t\t\t\ti18nLabel: 'Country_Cuba'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'cyprus',\n\t\t\t\t\ti18nLabel: 'Country_Cyprus'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'czechRepublic',\n\t\t\t\t\ti18nLabel: 'Country_Czech_Republic'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'denmark',\n\t\t\t\t\ti18nLabel: 'Country_Denmark'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'djibouti',\n\t\t\t\t\ti18nLabel: 'Country_Djibouti'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'dominica',\n\t\t\t\t\ti18nLabel: 'Country_Dominica'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'dominicanRepublic',\n\t\t\t\t\ti18nLabel: 'Country_Dominican_Republic'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'ecuador',\n\t\t\t\t\ti18nLabel: 'Country_Ecuador'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'egypt',\n\t\t\t\t\ti18nLabel: 'Country_Egypt'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'elSalvador',\n\t\t\t\t\ti18nLabel: 'Country_El_Salvador'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'equatorialGuinea',\n\t\t\t\t\ti18nLabel: 'Country_Equatorial_Guinea'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'eritrea',\n\t\t\t\t\ti18nLabel: 'Country_Eritrea'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'estonia',\n\t\t\t\t\ti18nLabel: 'Country_Estonia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'ethiopia',\n\t\t\t\t\ti18nLabel: 'Country_Ethiopia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'falklandIslandsMalvinas',\n\t\t\t\t\ti18nLabel: 'Country_Falkland_Islands_Malvinas'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'faroeIslands',\n\t\t\t\t\ti18nLabel: 'Country_Faroe_Islands'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'fiji',\n\t\t\t\t\ti18nLabel: 'Country_Fiji'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'finland',\n\t\t\t\t\ti18nLabel: 'Country_Finland'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'france',\n\t\t\t\t\ti18nLabel: 'Country_France'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'frenchGuiana',\n\t\t\t\t\ti18nLabel: 'Country_French_Guiana'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'frenchPolynesia',\n\t\t\t\t\ti18nLabel: 'Country_French_Polynesia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'frenchSouthernTerritories',\n\t\t\t\t\ti18nLabel: 'Country_French_Southern_Territories'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'gabon',\n\t\t\t\t\ti18nLabel: 'Country_Gabon'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'gambia',\n\t\t\t\t\ti18nLabel: 'Country_Gambia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'georgia',\n\t\t\t\t\ti18nLabel: 'Country_Georgia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'germany',\n\t\t\t\t\ti18nLabel: 'Country_Germany'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'ghana',\n\t\t\t\t\ti18nLabel: 'Country_Ghana'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'gibraltar',\n\t\t\t\t\ti18nLabel: 'Country_Gibraltar'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'greece',\n\t\t\t\t\ti18nLabel: 'Country_Greece'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'greenland',\n\t\t\t\t\ti18nLabel: 'Country_Greenland'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'grenada',\n\t\t\t\t\ti18nLabel: 'Country_Grenada'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'guadeloupe',\n\t\t\t\t\ti18nLabel: 'Country_Guadeloupe'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'guam',\n\t\t\t\t\ti18nLabel: 'Country_Guam'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'guatemala',\n\t\t\t\t\ti18nLabel: 'Country_Guatemala'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'guinea',\n\t\t\t\t\ti18nLabel: 'Country_Guinea'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'guineaBissau',\n\t\t\t\t\ti18nLabel: 'Country_Guinea_bissau'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'guyana',\n\t\t\t\t\ti18nLabel: 'Country_Guyana'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'haiti',\n\t\t\t\t\ti18nLabel: 'Country_Haiti'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'heardIslandAndMcdonaldIslands',\n\t\t\t\t\ti18nLabel: 'Country_Heard_Island_and_Mcdonald_Islands'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'holySeeVaticanCityState',\n\t\t\t\t\ti18nLabel: 'Country_Holy_See_Vatican_City_State'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'honduras',\n\t\t\t\t\ti18nLabel: 'Country_Honduras'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'hongKong',\n\t\t\t\t\ti18nLabel: 'Country_Hong_Kong'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'hungary',\n\t\t\t\t\ti18nLabel: 'Country_Hungary'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'iceland',\n\t\t\t\t\ti18nLabel: 'Country_Iceland'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'india',\n\t\t\t\t\ti18nLabel: 'Country_India'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'indonesia',\n\t\t\t\t\ti18nLabel: 'Country_Indonesia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'iranIslamicRepublicOf',\n\t\t\t\t\ti18nLabel: 'Country_Iran_Islamic_Republic_of'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'iraq',\n\t\t\t\t\ti18nLabel: 'Country_Iraq'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'ireland',\n\t\t\t\t\ti18nLabel: 'Country_Ireland'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'israel',\n\t\t\t\t\ti18nLabel: 'Country_Israel'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'italy',\n\t\t\t\t\ti18nLabel: 'Country_Italy'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'jamaica',\n\t\t\t\t\ti18nLabel: 'Country_Jamaica'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'japan',\n\t\t\t\t\ti18nLabel: 'Country_Japan'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'jordan',\n\t\t\t\t\ti18nLabel: 'Country_Jordan'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'kazakhstan',\n\t\t\t\t\ti18nLabel: 'Country_Kazakhstan'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'kenya',\n\t\t\t\t\ti18nLabel: 'Country_Kenya'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'kiribati',\n\t\t\t\t\ti18nLabel: 'Country_Kiribati'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'koreaDemocraticPeoplesRepublicOf',\n\t\t\t\t\ti18nLabel: 'Country_Korea_Democratic_Peoples_Republic_of'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'koreaRepublicOf',\n\t\t\t\t\ti18nLabel: 'Country_Korea_Republic_of'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'kuwait',\n\t\t\t\t\ti18nLabel: 'Country_Kuwait'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'kyrgyzstan',\n\t\t\t\t\ti18nLabel: 'Country_Kyrgyzstan'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'laoPeoplesDemocraticRepublic',\n\t\t\t\t\ti18nLabel: 'Country_Lao_Peoples_Democratic_Republic'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'latvia',\n\t\t\t\t\ti18nLabel: 'Country_Latvia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'lebanon',\n\t\t\t\t\ti18nLabel: 'Country_Lebanon'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'lesotho',\n\t\t\t\t\ti18nLabel: 'Country_Lesotho'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'liberia',\n\t\t\t\t\ti18nLabel: 'Country_Liberia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'libyanArabJamahiriya',\n\t\t\t\t\ti18nLabel: 'Country_Libyan_Arab_Jamahiriya'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'liechtenstein',\n\t\t\t\t\ti18nLabel: 'Country_Liechtenstein'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'lithuania',\n\t\t\t\t\ti18nLabel: 'Country_Lithuania'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'luxembourg',\n\t\t\t\t\ti18nLabel: 'Country_Luxembourg'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'macao',\n\t\t\t\t\ti18nLabel: 'Country_Macao'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'macedoniaTheFormerYugoslavRepublicOf',\n\t\t\t\t\ti18nLabel: 'Country_Macedonia_The_Former_Yugoslav_Republic_of'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'madagascar',\n\t\t\t\t\ti18nLabel: 'Country_Madagascar'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'malawi',\n\t\t\t\t\ti18nLabel: 'Country_Malawi'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'malaysia',\n\t\t\t\t\ti18nLabel: 'Country_Malaysia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'maldives',\n\t\t\t\t\ti18nLabel: 'Country_Maldives'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mali',\n\t\t\t\t\ti18nLabel: 'Country_Mali'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'malta',\n\t\t\t\t\ti18nLabel: 'Country_Malta'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'marshallIslands',\n\t\t\t\t\ti18nLabel: 'Country_Marshall_Islands'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'martinique',\n\t\t\t\t\ti18nLabel: 'Country_Martinique'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mauritania',\n\t\t\t\t\ti18nLabel: 'Country_Mauritania'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mauritius',\n\t\t\t\t\ti18nLabel: 'Country_Mauritius'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mayotte',\n\t\t\t\t\ti18nLabel: 'Country_Mayotte'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mexico',\n\t\t\t\t\ti18nLabel: 'Country_Mexico'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'micronesiaFederatedStatesOf',\n\t\t\t\t\ti18nLabel: 'Country_Micronesia_Federated_States_of'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'moldovaRepublicOf',\n\t\t\t\t\ti18nLabel: 'Country_Moldova_Republic_of'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'monaco',\n\t\t\t\t\ti18nLabel: 'Country_Monaco'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mongolia',\n\t\t\t\t\ti18nLabel: 'Country_Mongolia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'montserrat',\n\t\t\t\t\ti18nLabel: 'Country_Montserrat'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'morocco',\n\t\t\t\t\ti18nLabel: 'Country_Morocco'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mozambique',\n\t\t\t\t\ti18nLabel: 'Country_Mozambique'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'myanmar',\n\t\t\t\t\ti18nLabel: 'Country_Myanmar'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'namibia',\n\t\t\t\t\ti18nLabel: 'Country_Namibia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'nauru',\n\t\t\t\t\ti18nLabel: 'Country_Nauru'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'nepal',\n\t\t\t\t\ti18nLabel: 'Country_Nepal'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'netherlands',\n\t\t\t\t\ti18nLabel: 'Country_Netherlands'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'netherlandsAntilles',\n\t\t\t\t\ti18nLabel: 'Country_Netherlands_Antilles'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'newCaledonia',\n\t\t\t\t\ti18nLabel: 'Country_New_Caledonia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'newZealand',\n\t\t\t\t\ti18nLabel: 'Country_New_Zealand'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'nicaragua',\n\t\t\t\t\ti18nLabel: 'Country_Nicaragua'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'niger',\n\t\t\t\t\ti18nLabel: 'Country_Niger'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'nigeria',\n\t\t\t\t\ti18nLabel: 'Country_Nigeria'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'niue',\n\t\t\t\t\ti18nLabel: 'Country_Niue'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'norfolkIsland',\n\t\t\t\t\ti18nLabel: 'Country_Norfolk_Island'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'northernMarianaIslands',\n\t\t\t\t\ti18nLabel: 'Country_Northern_Mariana_Islands'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'norway',\n\t\t\t\t\ti18nLabel: 'Country_Norway'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'oman',\n\t\t\t\t\ti18nLabel: 'Country_Oman'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'pakistan',\n\t\t\t\t\ti18nLabel: 'Country_Pakistan'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'palau',\n\t\t\t\t\ti18nLabel: 'Country_Palau'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'palestinianTerritoryOccupied',\n\t\t\t\t\ti18nLabel: 'Country_Palestinian_Territory_Occupied'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'panama',\n\t\t\t\t\ti18nLabel: 'Country_Panama'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'papuaNewGuinea',\n\t\t\t\t\ti18nLabel: 'Country_Papua_New_Guinea'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'paraguay',\n\t\t\t\t\ti18nLabel: 'Country_Paraguay'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'peru',\n\t\t\t\t\ti18nLabel: 'Country_Peru'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'philippines',\n\t\t\t\t\ti18nLabel: 'Country_Philippines'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'pitcairn',\n\t\t\t\t\ti18nLabel: 'Country_Pitcairn'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'poland',\n\t\t\t\t\ti18nLabel: 'Country_Poland'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'portugal',\n\t\t\t\t\ti18nLabel: 'Country_Portugal'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'puertoRico',\n\t\t\t\t\ti18nLabel: 'Country_Puerto_Rico'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'qatar',\n\t\t\t\t\ti18nLabel: 'Country_Qatar'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'reunion',\n\t\t\t\t\ti18nLabel: 'Country_Reunion'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'romania',\n\t\t\t\t\ti18nLabel: 'Country_Romania'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'russianFederation',\n\t\t\t\t\ti18nLabel: 'Country_Russian_Federation'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'rwanda',\n\t\t\t\t\ti18nLabel: 'Country_Rwanda'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'saintHelena',\n\t\t\t\t\ti18nLabel: 'Country_Saint_Helena'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'saintKittsAndNevis',\n\t\t\t\t\ti18nLabel: 'Country_Saint_Kitts_and_Nevis'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'saintLucia',\n\t\t\t\t\ti18nLabel: 'Country_Saint_Lucia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'saintPierreAndMiquelon',\n\t\t\t\t\ti18nLabel: 'Country_Saint_Pierre_and_Miquelon'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'saintVincentAndTheGrenadines',\n\t\t\t\t\ti18nLabel: 'Country_Saint_Vincent_and_The_Grenadines'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'samoa',\n\t\t\t\t\ti18nLabel: 'Country_Samoa'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'sanMarino',\n\t\t\t\t\ti18nLabel: 'Country_San_Marino'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'saoTomeAndPrincipe',\n\t\t\t\t\ti18nLabel: 'Country_Sao_Tome_and_Principe'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'saudiArabia',\n\t\t\t\t\ti18nLabel: 'Country_Saudi_Arabia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'senegal',\n\t\t\t\t\ti18nLabel: 'Country_Senegal'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'serbiaAndMontenegro',\n\t\t\t\t\ti18nLabel: 'Country_Serbia_and_Montenegro'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'seychelles',\n\t\t\t\t\ti18nLabel: 'Country_Seychelles'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'sierraLeone',\n\t\t\t\t\ti18nLabel: 'Country_Sierra_Leone'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'singapore',\n\t\t\t\t\ti18nLabel: 'Country_Singapore'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'slovakia',\n\t\t\t\t\ti18nLabel: 'Country_Slovakia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'slovenia',\n\t\t\t\t\ti18nLabel: 'Country_Slovenia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'solomonIslands',\n\t\t\t\t\ti18nLabel: 'Country_Solomon_Islands'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'somalia',\n\t\t\t\t\ti18nLabel: 'Country_Somalia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'southAfrica',\n\t\t\t\t\ti18nLabel: 'Country_South_Africa'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'southGeorgiaAndTheSouthSandwichIslands',\n\t\t\t\t\ti18nLabel: 'Country_South_Georgia_and_The_South_Sandwich_Islands'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'spain',\n\t\t\t\t\ti18nLabel: 'Country_Spain'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'sriLanka',\n\t\t\t\t\ti18nLabel: 'Country_Sri_Lanka'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'sudan',\n\t\t\t\t\ti18nLabel: 'Country_Sudan'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'suriname',\n\t\t\t\t\ti18nLabel: 'Country_Suriname'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'svalbardAndJanMayen',\n\t\t\t\t\ti18nLabel: 'Country_Svalbard_and_Jan_Mayen'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'swaziland',\n\t\t\t\t\ti18nLabel: 'Country_Swaziland'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'sweden',\n\t\t\t\t\ti18nLabel: 'Country_Sweden'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'switzerland',\n\t\t\t\t\ti18nLabel: 'Country_Switzerland'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'syrianArabRepublic',\n\t\t\t\t\ti18nLabel: 'Country_Syrian_Arab_Republic'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'taiwanProvinceOfChina',\n\t\t\t\t\ti18nLabel: 'Country_Taiwan_Province_of_China'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'tajikistan',\n\t\t\t\t\ti18nLabel: 'Country_Tajikistan'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'tanzaniaUnitedRepublicOf',\n\t\t\t\t\ti18nLabel: 'Country_Tanzania_United_Republic_of'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'thailand',\n\t\t\t\t\ti18nLabel: 'Country_Thailand'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'timorLeste',\n\t\t\t\t\ti18nLabel: 'Country_Timor_leste'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'togo',\n\t\t\t\t\ti18nLabel: 'Country_Togo'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'tokelau',\n\t\t\t\t\ti18nLabel: 'Country_Tokelau'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'tonga',\n\t\t\t\t\ti18nLabel: 'Country_Tonga'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'trinidadAndTobago',\n\t\t\t\t\ti18nLabel: 'Country_Trinidad_and_Tobago'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'tunisia',\n\t\t\t\t\ti18nLabel: 'Country_Tunisia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'turkey',\n\t\t\t\t\ti18nLabel: 'Country_Turkey'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'turkmenistan',\n\t\t\t\t\ti18nLabel: 'Country_Turkmenistan'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'turksAndCaicosIslands',\n\t\t\t\t\ti18nLabel: 'Country_Turks_and_Caicos_Islands'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'tuvalu',\n\t\t\t\t\ti18nLabel: 'Country_Tuvalu'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'uganda',\n\t\t\t\t\ti18nLabel: 'Country_Uganda'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'ukraine',\n\t\t\t\t\ti18nLabel: 'Country_Ukraine'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'unitedArabEmirates',\n\t\t\t\t\ti18nLabel: 'Country_United_Arab_Emirates'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'unitedKingdom',\n\t\t\t\t\ti18nLabel: 'Country_United_Kingdom'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'unitedStates',\n\t\t\t\t\ti18nLabel: 'Country_United_States'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'unitedStatesMinorOutlyingIslands',\n\t\t\t\t\ti18nLabel: 'Country_United_States_Minor_Outlying_Islands'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'uruguay',\n\t\t\t\t\ti18nLabel: 'Country_Uruguay'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'uzbekistan',\n\t\t\t\t\ti18nLabel: 'Country_Uzbekistan'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'vanuatu',\n\t\t\t\t\ti18nLabel: 'Country_Vanuatu'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'venezuela',\n\t\t\t\t\ti18nLabel: 'Country_Venezuela'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'vietNam',\n\t\t\t\t\ti18nLabel: 'Country_Viet_Nam'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'virginIslandsBritish',\n\t\t\t\t\ti18nLabel: 'Country_Virgin_Islands_British'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'virginIslandsUS',\n\t\t\t\t\ti18nLabel: 'Country_Virgin_Islands_US'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'wallisAndFutuna',\n\t\t\t\t\ti18nLabel: 'Country_Wallis_and_Futuna'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'westernSahara',\n\t\t\t\t\ti18nLabel: 'Country_Western_Sahara'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'yemen',\n\t\t\t\t\ti18nLabel: 'Country_Yemen'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'zambia',\n\t\t\t\t\ti18nLabel: 'Country_Zambia'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'zimbabwe',\n\t\t\t\t\ti18nLabel: 'Country_Zimbabwe'\n\t\t\t\t}\n\t\t\t],\n\t\t\twizard: {\n\t\t\t\tstep: 2,\n\t\t\t\torder: 4\n\t\t\t}\n\t\t});\n\t\tthis.add('Website', '', {\n\t\t\ttype: 'string',\n\t\t\twizard: {\n\t\t\t\tstep: 2,\n\t\t\t\torder: 5\n\t\t\t}\n\t\t});\n\t\tthis.add('Server_Type', '', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'privateTeam',\n\t\t\t\t\ti18nLabel: 'Private_Team'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'publicCommunity',\n\t\t\t\t\ti18nLabel: 'Public_Community'\n\t\t\t\t}\n\t\t\t],\n\t\t\twizard: {\n\t\t\t\tstep: 3,\n\t\t\t\torder: 2\n\t\t\t}\n\t\t});\n\t});\n});\n\nRocketChat.settings.init();\n\n","import _ from 'underscore';\n\nMeteor.methods({\n\t'public-settings/get'(updatedAt) {\n\t\tthis.unblock();\n\t\tconst records = RocketChat.models.Settings.find().fetch().filter(function(record) {\n\t\t\treturn record.hidden !== true && record['public'] === true;\n\t\t});\n\t\tif (updatedAt instanceof Date) {\n\t\t\treturn {\n\t\t\t\tupdate: records.filter(function(record) {\n\t\t\t\t\treturn record._updatedAt > updatedAt;\n\t\t\t\t}),\n\t\t\t\tremove: RocketChat.models.Settings.trashFindDeletedAfter(updatedAt, {\n\t\t\t\t\thidden: {\n\t\t\t\t\t\t$ne: true\n\t\t\t\t\t},\n\t\t\t\t\t'public': true\n\t\t\t\t}, {\n\t\t\t\t\tfields: {\n\t\t\t\t\t\t_id: 1,\n\t\t\t\t\t\t_deletedAt: 1\n\t\t\t\t\t}\n\t\t\t\t}).fetch()\n\t\t\t};\n\t\t}\n\t\treturn records;\n\t},\n\t'private-settings/get'(updatedAt) {\n\t\tif (!Meteor.userId()) {\n\t\t\treturn [];\n\t\t}\n\t\tthis.unblock();\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'view-privileged-setting')) {\n\t\t\treturn [];\n\t\t}\n\t\tconst records = RocketChat.models.Settings.find().fetch().filter(function(record) {\n\t\t\treturn record.hidden !== true;\n\t\t});\n\t\tif (updatedAt instanceof Date) {\n\t\t\treturn {\n\t\t\t\tupdate: records.filter(function(record) {\n\t\t\t\t\treturn record._updatedAt > updatedAt;\n\t\t\t\t}),\n\t\t\t\tremove: RocketChat.models.Settings.trashFindDeletedAfter(updatedAt, {\n\t\t\t\t\thidden: {\n\t\t\t\t\t\t$ne: true\n\t\t\t\t\t}\n\t\t\t\t}, {\n\t\t\t\t\tfields: {\n\t\t\t\t\t\t_id: 1,\n\t\t\t\t\t\t_deletedAt: 1\n\t\t\t\t\t}\n\t\t\t\t}).fetch()\n\t\t\t};\n\t\t}\n\t\treturn records;\n\t}\n});\n\nRocketChat.models.Settings.cache.on('changed', function(type, setting) {\n\tif (setting['public'] === true) {\n\t\tRocketChat.Notifications.notifyAllInThisInstance('public-settings-changed', type, _.pick(setting, '_id', 'value', 'editor', 'properties'));\n\t}\n\treturn RocketChat.Notifications.notifyLoggedInThisInstance('private-settings-changed', type, setting);\n});\n\nRocketChat.Notifications.streamAll.allowRead('private-settings-changed', function() {\n\tif (this.userId == null) {\n\t\treturn false;\n\t}\n\treturn RocketChat.authz.hasPermission(this.userId, 'view-privileged-setting');\n});\n","/* eslint no-multi-spaces: 0 */\n/* eslint comma-spacing: 0 */\nimport s from 'underscore.string';\n\nMeteor.methods({\n\taddOAuthService(name) {\n\n\t\tcheck(name, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'addOAuthService' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasPermission(Meteor.userId(), 'add-oauth-service') !== true) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Adding OAuth Services is not allowed', { method: 'addOAuthService', action: 'Adding_OAuth_Services' });\n\t\t}\n\n\t\tname = name.toLowerCase().replace(/[^a-z0-9_]/g, '');\n\t\tname = s.capitalize(name);\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }`                        , false             , { type: 'boolean', group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Enable', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-url`                    , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'URL', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-token_path`             , '/oauth/token'    , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Token_Path', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-token_sent_via`         , 'payload'         , { type: 'select' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Token_Sent_Via', persistent: true, values: [ { key: 'header', i18nLabel: 'Header' }, { key: 'payload', i18nLabel: 'Payload' } ] });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-identity_token_sent_via`, 'default'         , { type: 'select' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Identity_Token_Sent_Via', persistent: true, values: [ { key: 'default', i18nLabel: 'Same_As_Token_Sent_Via' }, { key: 'header', i18nLabel: 'Header' }, { key: 'payload', i18nLabel: 'Payload' } ] });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-identity_path`          , '/me'             , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Identity_Path', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-authorize_path`         , '/oauth/authorize', { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Authorize_Path', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-scope`                  , 'openid'          , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Scope', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-id`                     , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_id', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-secret`                 , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Secret', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-login_style`            , 'popup'           , { type: 'select' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Login_Style', persistent: true, values: [ { key: 'redirect', i18nLabel: 'Redirect' }, { key: 'popup', i18nLabel: 'Popup' }, { key: '', i18nLabel: 'Default' } ] });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-button_label_text`      , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Button_Label_Text', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-button_label_color`     , '#FFFFFF'         , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Button_Label_Color', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-button_color`           , '#13679A'         , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Button_Color', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-username_field`         , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Username_Field', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-merge_users`            , false             , { type: 'boolean', group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Merge_Users', persistent: true });\n\t}});\n","Meteor.methods({\n\trefreshOAuthService() {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'refreshOAuthService' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasPermission(Meteor.userId(), 'add-oauth-service') !== true) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Refresh OAuth Services is not allowed', { method: 'refreshOAuthService', action: 'Refreshing_OAuth_Services' });\n\t\t}\n\n\t\tServiceConfiguration.configurations.remove({});\n\n\t\tRocketChat.models.Settings.update({_id: /^Accounts_OAuth_.+/}, {$set: {_updatedAt: new Date}}, {multi: true});\n\t}\n});\n","Meteor.methods({\n\taddUserToRoom(data) {\n\t\treturn Meteor.call('addUsersToRoom', {\n\t\t\trid: data.rid,\n\t\t\tusers: [ data.username ]\n\t\t});\n\t}\n});\n","Meteor.methods({\n\taddUsersToRoom(data = {}) {\n\t\t// Validate user and room\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'addUsersToRoom'\n\t\t\t});\n\t\t}\n\n\t\tif (!Match.test(data.rid, String)) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', {\n\t\t\t\tmethod: 'addUsersToRoom'\n\t\t\t});\n\t\t}\n\n\t\t// Get user and room details\n\t\tconst room = RocketChat.models.Rooms.findOneById(data.rid);\n\t\tconst userId = Meteor.userId();\n\t\tconst user = Meteor.user();\n\t\tconst userInRoom = Array.isArray(room.usernames) && room.usernames.includes(user.username);\n\n\t\t// Can't add to direct room ever\n\t\tif (room.t === 'd') {\n\t\t\tthrow new Meteor.Error('error-cant-invite-for-direct-room', 'Can\\'t invite user to direct rooms', {\n\t\t\t\tmethod: 'addUsersToRoom'\n\t\t\t});\n\t\t}\n\n\t\t// Can add to any room you're in, with permission, otherwise need specific room type permission\n\t\tlet canAddUser = false;\n\t\tif (userInRoom && RocketChat.authz.hasPermission(userId, 'add-user-to-joined-room', room._id)) {\n\t\t\tcanAddUser = true;\n\t\t} else if (room.t === 'c' && RocketChat.authz.hasPermission(userId, 'add-user-to-any-c-room')) {\n\t\t\tcanAddUser = true;\n\t\t} else if (room.t === 'p' && RocketChat.authz.hasPermission(userId, 'add-user-to-any-p-room')) {\n\t\t\tcanAddUser = true;\n\t\t}\n\n\t\t// Adding wasn't allowed\n\t\tif (!canAddUser) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', {\n\t\t\t\tmethod: 'addUsersToRoom'\n\t\t\t});\n\t\t}\n\n\t\t// Missing the users to be added\n\t\tif (!Array.isArray(data.users)) {\n\t\t\tthrow new Meteor.Error('error-invalid-arguments', 'Invalid arguments', {\n\t\t\t\tmethod: 'addUsersToRoom'\n\t\t\t});\n\t\t}\n\n\t\t// Validate each user, then add to room\n\t\tdata.users.forEach((username) => {\n\t\t\tconst newUser = RocketChat.models.Users.findOneByUsername(username);\n\t\t\tif (!newUser) {\n\t\t\t\tthrow new Meteor.Error('error-invalid-username', 'Invalid username', {\n\t\t\t\t\tmethod: 'addUsersToRoom'\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tRocketChat.addUserToRoom(data.rid, newUser, user);\n\t\t});\n\n\t\treturn true;\n\t}\n});\n","Meteor.methods({\n\tarchiveRoom(rid) {\n\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'archiveRoom' });\n\t\t}\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\t\tif (!room) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'archiveRoom' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'archive-room', room._id)) {\n\t\t\tthrow new Meteor.Error('error-not-authorized', 'Not authorized', { method: 'archiveRoom' });\n\t\t}\n\n\t\tif (room.t === 'd') {\n\t\t\tthrow new Meteor.Error('error-direct-message-room', 'Direct Messages can not be archived', { method: 'archiveRoom' });\n\t\t}\n\n\t\treturn RocketChat.archiveRoom(rid);\n\t}\n});\n","Meteor.methods({\n\tblockUser({rid, blocked}) {\n\n\t\tcheck(rid, String);\n\t\tcheck(blocked, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'blockUser' });\n\t\t}\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, Meteor.userId());\n\t\tconst subscription2 = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, blocked);\n\n\t\tif (!subscription || !subscription2) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'blockUser' });\n\t\t}\n\n\t\tRocketChat.models.Subscriptions.setBlockedByRoomId(rid, blocked, Meteor.userId());\n\n\t\treturn true;\n\t}\n});\n","Meteor.methods({\n\tcheckRegistrationSecretURL(hash) {\n\n\t\tcheck(hash, String);\n\n\t\treturn hash === RocketChat.settings.get('Accounts_RegistrationForm_SecretURL');\n\t}\n});\n","Meteor.methods({\n\tcheckUsernameAvailability(username) {\n\t\tcheck(username, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'setUsername' });\n\t\t}\n\n\t\tconst user = Meteor.user();\n\n\t\tif (user.username && !RocketChat.settings.get('Accounts_AllowUsernameChange')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'setUsername' });\n\t\t}\n\n\t\tif (user.username === username) {\n\t\t\treturn true;\n\t\t}\n\t\treturn RocketChat.checkUsernameAvailability(username);\n\t}\n});\n\nRocketChat.RateLimiter.limitMethod('checkUsernameAvailability', 1, 1000, {\n\tuserId() { return true; }\n});\n","Meteor.methods({\n\t/**\n\t DEPRECATED\n\t // TODO: Remove this after three versions have been released. That means at 0.67 this should be gone.\n\t */\n\tcleanChannelHistory({ roomId, latest, oldest, inclusive }) {\n\t\tconsole.warn('The method \"cleanChannelHistory\" is deprecated and will be removed after version 0.67, please use \"cleanRoomHistory\" instead');\n\t\tMeteor.call('cleanRoomHistory', { roomId, latest, oldest, inclusive });\n\t}\n});\n","Meteor.methods({\n\tcleanRoomHistory({ roomId, latest, oldest, inclusive }) {\n\t\tcheck(roomId, String);\n\t\tcheck(latest, Date);\n\t\tcheck(oldest, Date);\n\t\tcheck(inclusive, Boolean);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'cleanRoomHistory' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'clean-channel-history')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'cleanRoomHistory' });\n\t\t}\n\n\t\tif (inclusive) {\n\t\t\tRocketChat.models.Messages.remove({\n\t\t\t\trid: roomId,\n\t\t\t\tts: {\n\t\t\t\t\t$gte: oldest,\n\t\t\t\t\t$lte: latest\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tRocketChat.models.Messages.remove({\n\t\t\t\trid: roomId,\n\t\t\t\tts: {\n\t\t\t\t\t$gt: oldest,\n\t\t\t\t\t$lt: latest\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n});\n","Meteor.methods({\n\tcreateChannel(name, members, readOnly = false, customFields = {}, extraData = {}) {\n\t\tcheck(name, String);\n\t\tcheck(members, Match.Optional([String]));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'createChannel' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'create-c')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'createChannel' });\n\t\t}\n\t\treturn RocketChat.createRoom('c', name, Meteor.user() && Meteor.user().username, members, readOnly, {customFields, ...extraData});\n\t}\n});\n","Meteor.methods({\n\tcreateToken(userId) {\n\t\tif (Meteor.userId() !== userId && !RocketChat.authz.hasPermission(Meteor.userId(), 'user-generate-access-token')) {\n\t\t\tthrow new Meteor.Error('error-not-authorized', 'Not authorized', { method: 'createToken' });\n\t\t}\n\t\tconst token = Accounts._generateStampedLoginToken();\n\t\tAccounts._insertLoginToken(userId, token);\n\t\treturn {\n\t\t\tuserId,\n\t\t\tauthToken: token.token\n\t\t};\n\t}\n});\n","Meteor.methods({\n\tcreatePrivateGroup(name, members, readOnly = false, customFields = {}, extraData = {}) {\n\t\tcheck(name, String);\n\t\tcheck(members, Match.Optional([String]));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'createPrivateGroup' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'create-p')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'createPrivateGroup' });\n\t\t}\n\n\t\t// validate extra data schema\n\t\tcheck(extraData, Match.ObjectIncluding({\n\t\t\ttokenpass: Match.Maybe({\n\t\t\t\trequire: String,\n\t\t\t\ttokens: [{\n\t\t\t\t\ttoken: String,\n\t\t\t\t\tbalance: String\n\t\t\t\t}]\n\t\t\t})\n\t\t}));\n\n\t\treturn RocketChat.createRoom('p', name, Meteor.user() && Meteor.user().username, members, readOnly, {customFields, ...extraData});\n\t}\n});\n","import moment from 'moment';\n\nMeteor.methods({\n\tdeleteMessage(message) {\n\t\tcheck(message, Match.ObjectIncluding({\n\t\t\t_id: String\n\t\t}));\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'deleteMessage'\n\t\t\t});\n\t\t}\n\t\tconst originalMessage = RocketChat.models.Messages.findOneById(message._id, {\n\t\t\tfields: {\n\t\t\t\tu: 1,\n\t\t\t\trid: 1,\n\t\t\t\tfile: 1,\n\t\t\t\tts: 1\n\t\t\t}\n\t\t});\n\t\tif (originalMessage == null) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Not allowed', {\n\t\t\t\tmethod: 'deleteMessage',\n\t\t\t\taction: 'Delete_message'\n\t\t\t});\n\t\t}\n\t\tconst forceDelete = RocketChat.authz.hasPermission(Meteor.userId(), 'force-delete-message', originalMessage.rid);\n\t\tconst hasPermission = RocketChat.authz.hasPermission(Meteor.userId(), 'delete-message', originalMessage.rid);\n\t\tconst deleteAllowed = RocketChat.settings.get('Message_AllowDeleting');\n\t\tconst deleteOwn = originalMessage && originalMessage.u && originalMessage.u._id === Meteor.userId();\n\t\tif (!(hasPermission || (deleteAllowed && deleteOwn)) && !(forceDelete)) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Not allowed', {\n\t\t\t\tmethod: 'deleteMessage',\n\t\t\t\taction: 'Delete_message'\n\t\t\t});\n\t\t}\n\t\tconst blockDeleteInMinutes = RocketChat.settings.get('Message_AllowDeleting_BlockDeleteInMinutes');\n\t\tif (blockDeleteInMinutes != null && blockDeleteInMinutes !== 0 && !forceDelete) {\n\t\t\tif (originalMessage.ts == null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst msgTs = moment(originalMessage.ts);\n\t\t\tif (msgTs == null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst currentTsDiff = moment().diff(msgTs, 'minutes');\n\t\t\tif (currentTsDiff > blockDeleteInMinutes) {\n\t\t\t\tthrow new Meteor.Error('error-message-deleting-blocked', 'Message deleting is blocked', {\n\t\t\t\t\tmethod: 'deleteMessage'\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn RocketChat.deleteMessage(originalMessage, Meteor.user());\n\t}\n});\n","import s from 'underscore.string';\n\nMeteor.methods({\n\tdeleteUserOwnAccount(password) {\n\n\t\tcheck(password, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'deleteUserOwnAccount' });\n\t\t}\n\n\t\tif (!RocketChat.settings.get('Accounts_AllowDeleteOwnAccount')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'deleteUserOwnAccount' });\n\t\t}\n\n\t\tconst userId = Meteor.userId();\n\t\tconst user = RocketChat.models.Users.findOneById(userId);\n\n\t\tif (!user) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'deleteUserOwnAccount' });\n\t\t}\n\n\t\tif (user.services && user.services.password && s.trim(user.services.password.bcrypt)) {\n\t\t\tconst result = Accounts._checkPassword(user, { digest: password, algorithm: 'sha-256' });\n\t\t\tif (result.error) {\n\t\t\t\tthrow new Meteor.Error('error-invalid-password', 'Invalid password', { method: 'deleteUserOwnAccount' });\n\t\t\t}\n\t\t} else if (user.username !== s.trim(password)) {\n\t\t\tthrow new Meteor.Error('error-invalid-username', 'Invalid username', { method: 'deleteUserOwnAccount' });\n\t\t}\n\n\t\tMeteor.defer(function() {\n\t\t\tRocketChat.deleteUser(userId);\n\t\t});\n\n\t\treturn true;\n\t}\n});\n","Meteor.methods({\n\texecuteSlashCommandPreview(command, preview) {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'getSlashCommandPreview'\n\t\t\t});\n\t\t}\n\n\t\tif (!command || !command.cmd || !RocketChat.slashCommands.commands[command.cmd]) {\n\t\t\tthrow new Meteor.Error('error-invalid-command', 'Invalid Command Provided', {\n\t\t\t\tmethod: 'executeSlashCommandPreview'\n\t\t\t});\n\t\t}\n\n\t\tconst theCmd = RocketChat.slashCommands.commands[command.cmd];\n\t\tif (!theCmd.providesPreview) {\n\t\t\tthrow new Meteor.Error('error-invalid-command', 'Command Does Not Provide Previews', {\n\t\t\t\tmethod: 'executeSlashCommandPreview'\n\t\t\t});\n\t\t}\n\n\t\tif (!preview) {\n\t\t\tthrow new Meteor.Error('error-invalid-command-preview', 'Invalid Preview Provided', {\n\t\t\t\tmethod: 'executeSlashCommandPreview'\n\t\t\t});\n\t\t}\n\n\t\treturn RocketChat.slashCommands.executePreview(command.cmd, command.params, command.msg, preview);\n\t}\n});\n","import Filter from 'bad-words';\n\nRocketChat.callbacks.add('beforeSaveMessage', function(message) {\n\n\tif (RocketChat.settings.get('Message_AllowBadWordsFilter')) {\n\t\tconst badWordsList = RocketChat.settings.get('Message_BadWordsFilterList');\n\t\tlet options;\n\n\t\t// Add words to the blacklist\n\t\tif (!!badWordsList && badWordsList.length) {\n\t\t\toptions = {\n\t\t\t\tlist: badWordsList.split(',')\n\t\t\t};\n\t\t}\n\t\tconst filter = new Filter(options);\n\t\tmessage.msg = filter.clean(message.msg);\n\t}\n\n\treturn message;\n\n}, 1, 'filterBadWords');\n","import _ from 'underscore';\n\nRocketChat.callbacks.add('beforeSaveMessage', function(message) {\n\t// Test if the message mentions include @all.\n\tif (message.mentions != null &&\n\t\t_.pluck(message.mentions, '_id').some((item) => item === 'all')) {\n\n\t\t// Check if the user has permissions to use @all in both global and room scopes.\n\t\tif (!RocketChat.authz.hasPermission(message.u._id, 'mention-all') && !RocketChat.authz.hasPermission(message.u._id, 'mention-all', message.rid)) {\n\n\t\t\t// Get the language of the user for the error notification.\n\t\t\tconst language = RocketChat.models.Users.findOneById(message.u._id).language;\n\t\t\tconst action = TAPi18n.__('Notify_all_in_this_room', {}, language);\n\n\t\t\t// Add a notification to the chat, informing the user that this\n\t\t\t// action is not allowed.\n\t\t\tRocketChat.Notifications.notifyUser(message.u._id, 'message', {\n\t\t\t\t_id: Random.id(),\n\t\t\t\trid: message.rid,\n\t\t\t\tts: new Date,\n\t\t\t\tmsg: TAPi18n.__('error-action-not-allowed', { action }, language)\n\t\t\t});\n\n\t\t\t// Also throw to stop propagation of 'sendMessage'.\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Notify all in this room not allowed', {\n\t\t\t\tmethod: 'filterATAllTag',\n\t\t\t\taction: 'Notify_all_in_this_room'\n\t\t\t});\n\t\t}\n\t}\n\n\treturn message;\n\n}, 1, 'filterATAllTag');\n","import _ from 'underscore';\n\nRocketChat.callbacks.add('beforeSaveMessage', function(message) {\n\t// Test if the message mentions include @here.\n\tif (message.mentions != null &&\n\t\t_.pluck(message.mentions, '_id').some((item) => item === 'here')) {\n\n\t\t// Check if the user has permissions to use @here in both global and room scopes.\n\t\tif (!RocketChat.authz.hasPermission(message.u._id, 'mention-here') && !RocketChat.authz.hasPermission(message.u._id, 'mention-here', message.rid)) {\n\n\t\t\t// Get the language of the user for the error notification.\n\t\t\tconst language = RocketChat.models.Users.findOneById(message.u._id).language;\n\t\t\tconst action = TAPi18n.__('Notify_active_in_this_room', {}, language);\n\n\t\t\t// Add a notification to the chat, informing the user that this\n\t\t\t// action is not allowed.\n\t\t\tRocketChat.Notifications.notifyUser(message.u._id, 'message', {\n\t\t\t\t_id: Random.id(),\n\t\t\t\trid: message.rid,\n\t\t\t\tts: new Date,\n\t\t\t\tmsg: TAPi18n.__('error-action-not-allowed', { action }, language)\n\t\t\t});\n\n\t\t\t// Also throw to stop propagation of 'sendMessage'.\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Notify here in this room not allowed', {\n\t\t\t\tmethod: 'filterATHereTag',\n\t\t\t\taction: 'Notify_active_in_this_room'\n\t\t\t});\n\t\t}\n\t}\n\n\treturn message;\n\n}, 1, 'filterATHereTag');\n","import _ from 'underscore';\n\nMeteor.methods({\n\tgetChannelHistory({rid, latest, oldest, inclusive, count = 20, unreads}) {\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'getChannelHistory' });\n\t\t}\n\n\t\tconst fromUserId = Meteor.userId();\n\t\tconst room = Meteor.call('canAccessRoom', rid, fromUserId);\n\t\tif (!room) {\n\t\t\treturn false;\n\t\t}\n\n\t\t//Make sure they can access the room\n\t\tif (room.t === 'c' && !RocketChat.authz.hasPermission(fromUserId, 'preview-c-room') && room.usernames.indexOf(room.username) === -1) {\n\t\t\treturn false;\n\t\t}\n\n\t\t//Ensure latest is always defined.\n\t\tif (_.isUndefined(latest)) {\n\t\t\tlatest = new Date();\n\t\t}\n\n\t\t//Verify oldest is a date if it exists\n\t\tif (!_.isUndefined(oldest) && !_.isDate(oldest)) {\n\t\t\tthrow new Meteor.Error('error-invalid-date', 'Invalid date', { method: 'getChannelHistory' });\n\t\t}\n\n\t\tconst options = {\n\t\t\tsort: {\n\t\t\t\tts: -1\n\t\t\t},\n\t\t\tlimit: count\n\t\t};\n\n\t\tif (!RocketChat.settings.get('Message_ShowEditedStatus')) {\n\t\t\toptions.fields = { 'editedAt': 0 };\n\t\t}\n\n\t\tlet records = [];\n\t\tif (_.isUndefined(oldest) && inclusive) {\n\t\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdBeforeTimestampInclusive(rid, latest, options).fetch();\n\t\t} else if (_.isUndefined(oldest) && !inclusive) {\n\t\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdBeforeTimestamp(rid, latest, options).fetch();\n\t\t} else if (!_.isUndefined(oldest) && inclusive) {\n\t\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdBetweenTimestampsInclusive(rid, oldest, latest, options).fetch();\n\t\t} else {\n\t\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdBetweenTimestamps(rid, oldest, latest, options).fetch();\n\t\t}\n\n\t\tconst UI_Use_Real_Name = RocketChat.settings.get('UI_Use_Real_Name') === true;\n\n\t\tconst messages = _.map(records, (message) => {\n\t\t\tmessage.starred = _.findWhere(message.starred, { _id: fromUserId });\n\t\t\tif (message.u && message.u._id && UI_Use_Real_Name) {\n\t\t\t\tconst user = RocketChat.models.Users.findOneById(message.u._id);\n\t\t\t\tmessage.u.name = user && user.name;\n\t\t\t}\n\t\t\tif (message.mentions && message.mentions.length && UI_Use_Real_Name) {\n\t\t\t\tmessage.mentions.forEach((mention) => {\n\t\t\t\t\tconst user = RocketChat.models.Users.findOneById(mention._id);\n\t\t\t\t\tmention.name = user && user.name;\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn message;\n\t\t});\n\n\t\tif (unreads) {\n\t\t\tlet unreadNotLoaded = 0;\n\t\t\tlet firstUnread = undefined;\n\n\t\t\tif (!_.isUndefined(oldest)) {\n\t\t\t\tconst firstMsg = messages[messages.length - 1];\n\t\t\t\tif (!_.isUndefined(firstMsg) && firstMsg.ts > oldest) {\n\t\t\t\t\tconst unreadMessages = RocketChat.models.Messages.findVisibleByRoomIdBetweenTimestamps(rid, oldest, firstMsg.ts, { limit: 1, sort: { ts: 1 } });\n\t\t\t\t\tfirstUnread = unreadMessages.fetch()[0];\n\t\t\t\t\tunreadNotLoaded = unreadMessages.count();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tmessages: messages || [],\n\t\t\t\tfirstUnread,\n\t\t\t\tunreadNotLoaded\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tmessages: messages || []\n\t\t};\n\t}\n});\n","Meteor.methods({\n\tgetFullUserData({ filter = '', limit }) {\n\t\tconst result = RocketChat.getFullUserData({ userId: Meteor.userId(), filter, limit });\n\n\t\tif (!result) {\n\t\t\treturn result;\n\t\t}\n\n\t\treturn result.fetch();\n\t}\n});\n","Meteor.methods({\n\tgetRoomJoinCode(rid) {\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'getJoinCode' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'view-join-code')) {\n\t\t\tthrow new Meteor.Error('error-not-authorized', 'Not authorized', { method: 'getJoinCode' });\n\t\t}\n\n\t\tconst [ room ] = RocketChat.models.Rooms.findById(rid).fetch();\n\n\t\treturn room && room.joinCode;\n\t}\n});\n","import _ from 'underscore';\n\nMeteor.methods({\n\tgetRoomRoles(rid) {\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId() && RocketChat.settings.get('Accounts_AllowAnonymousRead') === false) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'getRoomRoles' });\n\t\t}\n\n\t\tcheck(rid, String);\n\n\t\tconst options = {\n\t\t\tsort: {\n\t\t\t\t'u.username': 1\n\t\t\t},\n\t\t\tfields: {\n\t\t\t\trid: 1,\n\t\t\t\tu: 1,\n\t\t\t\troles: 1\n\t\t\t}\n\t\t};\n\n\t\tconst UI_Use_Real_Name = RocketChat.settings.get('UI_Use_Real_Name') === true;\n\n\t\tconst roles = RocketChat.models.Roles.find({ scope: 'Subscriptions', description: { $exists: 1, $ne: '' } }).fetch();\n\t\tconst subscriptions = RocketChat.models.Subscriptions.findByRoomIdAndRoles(rid, _.pluck(roles, '_id'), options).fetch();\n\n\t\tif (!UI_Use_Real_Name) {\n\t\t\treturn subscriptions;\n\t\t} else {\n\t\t\treturn subscriptions.map(subscription => {\n\t\t\t\tconst user = RocketChat.models.Users.findOneById(subscription.u._id);\n\t\t\t\tsubscription.u.name = user && user.name;\n\t\t\t\treturn subscription;\n\t\t\t});\n\t\t}\n\t}\n});\n","Meteor.methods({\n\tgetServerInfo() {\n\t\treturn RocketChat.Info;\n\t}\n});\n","Meteor.methods({\n\tgetSingleMessage(msgId) {\n\t\tcheck(msgId, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'getSingleMessage' });\n\t\t}\n\n\t\tconst msg = RocketChat.models.Messages.findOneById(msgId);\n\n\t\tif (!msg && !msg.rid) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tMeteor.call('canAccessRoom', msg.rid, Meteor.userId());\n\n\t\treturn msg;\n\t}\n});\n","Meteor.methods({\n\tgetSlashCommandPreviews(command) {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'getSlashCommandPreview'\n\t\t\t});\n\t\t}\n\n\t\tif (!command || !command.cmd || !RocketChat.slashCommands.commands[command.cmd]) {\n\t\t\tthrow new Meteor.Error('error-invalid-command', 'Invalid Command Provided', {\n\t\t\t\tmethod: 'executeSlashCommandPreview'\n\t\t\t});\n\t\t}\n\n\t\tconst theCmd = RocketChat.slashCommands.commands[command.cmd];\n\t\tif (!theCmd.providesPreview) {\n\t\t\tthrow new Meteor.Error('error-invalid-command', 'Command Does Not Provide Previews', {\n\t\t\t\tmethod: 'executeSlashCommandPreview'\n\t\t\t});\n\t\t}\n\n\t\treturn RocketChat.slashCommands.getPreviews(command.cmd, command.params, command.msg);\n\t}\n});\n","import _ from 'underscore';\n\nMeteor.methods({\n\tgetUserRoles() {\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'getUserRoles' });\n\t\t}\n\n\t\tconst options = {\n\t\t\tsort: {\n\t\t\t\t'username': 1\n\t\t\t},\n\t\t\tfields: {\n\t\t\t\tusername: 1,\n\t\t\t\troles: 1\n\t\t\t}\n\t\t};\n\n\t\tconst roles = RocketChat.models.Roles.find({ scope: 'Users', description: { $exists: 1, $ne: '' } }).fetch();\n\t\tconst roleIds = _.pluck(roles, '_id');\n\n\t\t// Security issue: we should not send all user's roles to all clients, only the 'public' roles\n\t\t// We must remove all roles that are not part of the query from the returned users\n\t\tconst users = RocketChat.models.Users.findUsersInRoles(roleIds, null, options).fetch();\n\t\tfor (const user of users) {\n\t\t\tuser.roles = _.intersection(user.roles, roleIds);\n\t\t}\n\t\treturn users;\n\t}\n});\n","Meteor.methods({\n\tinsertOrUpdateUser(userData) {\n\n\t\tcheck(userData, Object);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'insertOrUpdateUser' });\n\t\t}\n\n\t\treturn RocketChat.saveUser(Meteor.userId(), userData);\n\t}\n});\n","Meteor.methods({\n\tjoinDefaultChannels(silenced) {\n\t\tcheck(silenced, Match.Optional(Boolean));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'joinDefaultChannels' });\n\t\t}\n\n\t\tthis.unblock();\n\t\treturn RocketChat.addUserToDefaultChannels(Meteor.user(), silenced);\n\t}\n});\n","Meteor.methods({\n\tjoinRoom(rid, code) {\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'joinRoom' });\n\t\t}\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\t\tif (!room) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'joinRoom' });\n\t\t}\n\n\t\t// TODO we should have a 'beforeJoinRoom' call back so external services can do their own validations\n\t\tconst user = Meteor.user();\n\t\tif (room.tokenpass && user && user.services && user.services.tokenpass) {\n\t\t\tconst balances = RocketChat.updateUserTokenpassBalances(user);\n\n\t\t\tif (!RocketChat.Tokenpass.validateAccess(room.tokenpass, balances)) {\n\t\t\t\tthrow new Meteor.Error('error-not-allowed', 'Token required', { method: 'joinRoom' });\n\t\t\t}\n\t\t} else {\n\t\t\tif ((room.t !== 'c') || (RocketChat.authz.hasPermission(Meteor.userId(), 'view-c-room') !== true)) {\n\t\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'joinRoom' });\n\t\t\t}\n\n\t\t\tif ((room.joinCodeRequired === true) && (code !== room.joinCode) && !RocketChat.authz.hasPermission(Meteor.userId(), 'join-without-join-code')) {\n\t\t\t\tthrow new Meteor.Error('error-code-invalid', 'Invalid Room Password', { method: 'joinRoom' });\n\t\t\t}\n\t\t}\n\n\t\treturn RocketChat.addUserToRoom(rid, user);\n\t}\n});\n","Meteor.methods({\n\tleaveRoom(rid) {\n\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'leaveRoom' });\n\t\t}\n\n\t\tthis.unblock();\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\t\tconst user = Meteor.user();\n\n\t\tif (room.t === 'd' || (room.t === 'c' && !RocketChat.authz.hasPermission(user._id, 'leave-c')) || (room.t === 'p' && !RocketChat.authz.hasPermission(user._id, 'leave-p'))) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'leaveRoom' });\n\t\t}\n\n\t\tif (!Array.from(room.usernames || []).includes(user.username)) {\n\t\t\tthrow new Meteor.Error('error-user-not-in-room', 'You are not in this room', { method: 'leaveRoom' });\n\t\t}\n\n\t\t// If user is room owner, check if there are other owners. If there isn't anyone else, warn user to set a new owner.\n\t\tif (RocketChat.authz.hasRole(user._id, 'owner', room._id)) {\n\t\t\tconst numOwners = RocketChat.authz.getUsersInRole('owner', room._id).fetch().length;\n\t\t\tif (numOwners === 1) {\n\t\t\t\tthrow new Meteor.Error('error-you-are-last-owner', 'You are the last owner. Please set new owner before leaving the room.', { method: 'leaveRoom' });\n\t\t\t}\n\t\t}\n\n\t\treturn RocketChat.removeUserFromRoom(rid, Meteor.user());\n\t}\n});\n","import s from 'underscore.string';\n\nMeteor.methods({\n\tremoveOAuthService(name) {\n\n\t\tcheck(name, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'removeOAuthService' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasPermission(Meteor.userId(), 'add-oauth-service') !== true) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'removeOAuthService' });\n\t\t}\n\n\t\tname = name.toLowerCase().replace(/[^a-z0-9_]/g, '');\n\t\tname = s.capitalize(name);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-url`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-token_path`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-identity_path`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-authorize_path`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-scope`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-token_sent_via`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-identity_token_sent_via`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-id`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-secret`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-button_label_text`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-button_label_color`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-button_color`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-login_style`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-username_field`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-merge_users`);\n\t}\n});\n","Meteor.methods({\n\trestart_server() {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'restart_server' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasRole(Meteor.userId(), 'admin') !== true) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'restart_server' });\n\t\t}\n\n\t\tMeteor.setTimeout(() => {\n\t\t\tMeteor.setTimeout(() => {\n\t\t\t\tconsole.warn('Call to process.exit() timed out, aborting.');\n\t\t\t\tprocess.abort();\n\t\t\t}, 1000);\n\t\t\tprocess.exit(1);\n\t\t}, 1000);\n\n\t\treturn {\n\t\t\tmessage: 'The_server_will_restart_in_s_seconds',\n\t\t\tparams: [2]\n\t\t};\n\t}\n});\n","import _ from 'underscore';\n\nMeteor.methods({\n\t'robot.modelCall'(model, method, args) {\n\t\tcheck(model, String);\n\t\tcheck(method, String);\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'robot.modelCall'\n\t\t\t});\n\t\t}\n\t\tif (!RocketChat.authz.hasRole(Meteor.userId(), 'robot')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', {\n\t\t\t\tmethod: 'robot.modelCall'\n\t\t\t});\n\t\t}\n\t\tconst m = RocketChat.models[model];\n\n\t\tif (!m || !_.isFunction(m[method])) {\n\t\t\tthrow new Meteor.Error('error-invalid-method', 'Invalid method', {\n\t\t\t\tmethod: 'robot.modelCall'\n\t\t\t});\n\t\t}\n\t\tconst cursor = RocketChat.models[model][method].apply(RocketChat.models[model], args);\n\t\treturn cursor && cursor.fetch ? cursor.fetch() : cursor;\n\t}\n});\n","/* eslint new-cap: 0 */\n\nMeteor.methods({\n\tsaveSetting(_id, value, editor) {\n\t\tif (Meteor.userId() === null) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Editing settings is not allowed', {\n\t\t\t\tmethod: 'saveSetting'\n\t\t\t});\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'edit-privileged-setting')) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Editing settings is not allowed', {\n\t\t\t\tmethod: 'saveSetting'\n\t\t\t});\n\t\t}\n\n\t\t//Verify the _id passed in is a string.\n\t\tcheck(_id, String);\n\n\t\tconst setting = RocketChat.models.Settings.db.findOneById(_id);\n\n\t\t//Verify the value is what it should be\n\t\tswitch (setting.type) {\n\t\t\tcase 'roomPick':\n\t\t\t\tcheck(value, Match.OneOf([Object], ''));\n\t\t\t\tbreak;\n\t\t\tcase 'boolean':\n\t\t\t\tcheck(value, Boolean);\n\t\t\t\tbreak;\n\t\t\tcase 'int':\n\t\t\t\tcheck(value, Number);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tcheck(value, String);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tRocketChat.settings.updateById(_id, value, editor);\n\t\treturn true;\n\t}\n});\n","import _ from 'underscore';\n\nMeteor.methods({\n\tsendInvitationEmail(emails) {\n\t\tcheck(emails, [String]);\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'sendInvitationEmail'\n\t\t\t});\n\t\t}\n\t\tif (!RocketChat.authz.hasRole(Meteor.userId(), 'admin')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', {\n\t\t\t\tmethod: 'sendInvitationEmail'\n\t\t\t});\n\t\t}\n\t\tconst rfcMailPattern = /^[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n\t\tconst validEmails = _.compact(_.map(emails, function(email) {\n\t\t\tif (rfcMailPattern.test(email)) {\n\t\t\t\treturn email;\n\t\t\t}\n\t\t}));\n\t\tconst header = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Header') || '');\n\t\tconst footer = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Footer') || '');\n\t\tlet html;\n\t\tlet subject;\n\t\tconst user = Meteor.user();\n\t\tconst lng = user.language || RocketChat.settings.get('language') || 'en';\n\t\tif (RocketChat.settings.get('Invitation_Customized')) {\n\t\t\tsubject = RocketChat.settings.get('Invitation_Subject');\n\t\t\thtml = RocketChat.settings.get('Invitation_HTML');\n\t\t} else {\n\t\t\tsubject = TAPi18n.__('Invitation_Subject_Default', {\n\t\t\t\tlng\n\t\t\t});\n\t\t\thtml = TAPi18n.__('Invitation_HTML_Default', {\n\t\t\t\tlng\n\t\t\t});\n\t\t}\n\t\tsubject = RocketChat.placeholders.replace(subject);\n\t\tvalidEmails.forEach(email => {\n\t\t\tthis.unblock();\n\t\t\thtml = RocketChat.placeholders.replace(html, {\n\t\t\t\temail\n\t\t\t});\n\t\t\ttry {\n\t\t\t\tEmail.send({\n\t\t\t\t\tto: email,\n\t\t\t\t\tfrom: RocketChat.settings.get('From_Email'),\n\t\t\t\t\tsubject,\n\t\t\t\t\thtml: header + html + footer\n\t\t\t\t});\n\t\t\t} catch ({message}) {\n\t\t\t\tthrow new Meteor.Error('error-email-send-failed', `Error trying to send email: ${ message }`, {\n\t\t\t\t\tmethod: 'sendInvitationEmail',\n\t\t\t\t\tmessage\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\treturn validEmails;\n\t}\n});\n","import moment from 'moment';\n\nMeteor.methods({\n\tsendMessage(message) {\n\t\tcheck(message, Object);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'sendMessage'\n\t\t\t});\n\t\t}\n\n\t\tif (!message.rid) {\n\t\t\tthrow new Error('The \\'rid\\' property on the message object is missing.');\n\t\t}\n\n\t\tif (message.ts) {\n\t\t\tconst tsDiff = Math.abs(moment(message.ts).diff());\n\t\t\tif (tsDiff > 60000) {\n\t\t\t\tthrow new Meteor.Error('error-message-ts-out-of-sync', 'Message timestamp is out of sync', {\n\t\t\t\t\tmethod: 'sendMessage',\n\t\t\t\t\tmessage_ts: message.ts,\n\t\t\t\t\tserver_ts: new Date().getTime()\n\t\t\t\t});\n\t\t\t} else if (tsDiff > 10000) {\n\t\t\t\tmessage.ts = new Date();\n\t\t\t}\n\t\t} else {\n\t\t\tmessage.ts = new Date();\n\t\t}\n\n\t\tif (message.msg) {\n\t\t\tconst adjustedMessage = RocketChat.messageProperties.messageWithoutEmojiShortnames(message.msg);\n\n\t\t\tif (RocketChat.messageProperties.length(adjustedMessage) > RocketChat.settings.get('Message_MaxAllowedSize')) {\n\t\t\t\tthrow new Meteor.Error('error-message-size-exceeded', 'Message size exceeds Message_MaxAllowedSize', {\n\t\t\t\t\tmethod: 'sendMessage'\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tconst user = RocketChat.models.Users.findOneById(Meteor.userId(), {\n\t\t\tfields: {\n\t\t\t\tusername: 1,\n\t\t\t\tname: 1\n\t\t\t}\n\t\t});\n\n\t\tconst room = Meteor.call('canAccessRoom', message.rid, user._id);\n\t\tif (!room) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(message.rid, Meteor.userId());\n\t\tif (subscription && (subscription.blocked || subscription.blocker)) {\n\t\t\tRocketChat.Notifications.notifyUser(Meteor.userId(), 'message', {\n\t\t\t\t_id: Random.id(),\n\t\t\t\trid: room._id,\n\t\t\t\tts: new Date,\n\t\t\t\tmsg: TAPi18n.__('room_is_blocked', {}, user.language)\n\t\t\t});\n\t\t\tthrow new Meteor.Error('You can\\'t send messages because you are blocked');\n\t\t}\n\n\t\tif ((room.muted || []).includes(user.username)) {\n\t\t\tRocketChat.Notifications.notifyUser(Meteor.userId(), 'message', {\n\t\t\t\t_id: Random.id(),\n\t\t\t\trid: room._id,\n\t\t\t\tts: new Date,\n\t\t\t\tmsg: TAPi18n.__('You_have_been_muted', {}, user.language)\n\t\t\t});\n\t\t\tthrow new Meteor.Error('You can\\'t send messages because you have been muted');\n\t\t}\n\n\t\tif (message.alias == null && RocketChat.settings.get('Message_SetNameToAliasEnabled')) {\n\t\t\tmessage.alias = user.name;\n\t\t}\n\n\t\tif (Meteor.settings['public'].sandstorm) {\n\t\t\tmessage.sandstormSessionId = this.connection.sandstormSessionId();\n\t\t}\n\n\t\tRocketChat.metrics.messagesSent.inc(); // TODO This line needs to be moved to it's proper place. See the comments on: https://github.com/RocketChat/Rocket.Chat/pull/5736\n\t\treturn RocketChat.sendMessage(user, message, room);\n\t}\n});\n// Limit a user, who does not have the \"bot\" role, to sending 5 msgs/second\nRocketChat.RateLimiter.limitMethod('sendMessage', 5, 1000, {\n\tuserId(userId) {\n\t\treturn !RocketChat.authz.hasPermission(userId, 'send-many-messages');\n\t}\n});\n","Meteor.methods({\n\tsendSMTPTestEmail() {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'sendSMTPTestEmail'\n\t\t\t});\n\t\t}\n\t\tconst user = Meteor.user();\n\t\tif (!user.emails && !user.emails[0] && user.emails[0].address) {\n\t\t\tthrow new Meteor.Error('error-invalid-email', 'Invalid email', {\n\t\t\t\tmethod: 'sendSMTPTestEmail'\n\t\t\t});\n\t\t}\n\t\tthis.unblock();\n\t\tconst header = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Header') || '');\n\t\tconst footer = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Footer') || '');\n\t\tconsole.log(`Sending test email to ${ user.emails[0].address }`);\n\t\ttry {\n\t\t\tEmail.send({\n\t\t\t\tto: user.emails[0].address,\n\t\t\t\tfrom: RocketChat.settings.get('From_Email'),\n\t\t\t\tsubject: 'SMTP Test Email',\n\t\t\t\thtml: `${ header }<p>You have successfully sent an email</p>${ footer }`\n\t\t\t});\n\t\t} catch ({message}) {\n\t\t\tthrow new Meteor.Error('error-email-send-failed', `Error trying to send email: ${ message }`, {\n\t\t\t\tmethod: 'sendSMTPTestEmail',\n\t\t\t\tmessage\n\t\t\t});\n\t\t}\n\t\treturn {\n\t\t\tmessage: 'Your_mail_was_sent_to_s',\n\t\t\tparams: [user.emails[0].address]\n\t\t};\n\t}\n});\n\nDDPRateLimiter.addRule({\n\ttype: 'method',\n\tname: 'sendSMTPTestEmail',\n\tuserId() {\n\t\treturn true;\n\t}\n}, 1, 1000);\n","Meteor.methods({\n\tsetAdminStatus(userId, admin) {\n\n\t\tcheck(userId, String);\n\t\tcheck(admin, Match.Optional(Boolean));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'setAdminStatus' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasPermission(Meteor.userId(), 'assign-admin-role') !== true) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'setAdminStatus' });\n\t\t}\n\n\t\tconst user = Meteor.users.findOne({ _id: userId }, { fields: { username: 1 } });\n\n\t\tif (admin) {\n\t\t\treturn Meteor.call('authorization:addUserToRole', 'admin', user.username);\n\t\t} else {\n\t\t\treturn Meteor.call('authorization:removeUserFromRole', 'admin', user.username);\n\t\t}\n\t}\n});\n","Meteor.methods({\n\tsetRealName(name) {\n\n\t\tcheck(name, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'setRealName' });\n\t\t}\n\n\t\tif (!RocketChat.settings.get('Accounts_AllowRealNameChange')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'setRealName' });\n\t\t}\n\n\t\tif (!RocketChat.setRealName(Meteor.userId(), name)) {\n\t\t\tthrow new Meteor.Error('error-could-not-change-name', 'Could not change name', { method: 'setRealName' });\n\t\t}\n\n\t\treturn name;\n\t}\n});\n\nRocketChat.RateLimiter.limitMethod('setRealName', 1, 1000, {\n\tuserId: () => true\n});\n","import _ from 'underscore';\n\nMeteor.methods({\n\tsetUsername(username, param = {}) {\n\t\tconst { joinDefaultChannelsSilenced } = param;\n\t\tcheck(username, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'setUsername' });\n\t\t}\n\n\t\tconst user = Meteor.user();\n\n\t\tif (user.username && !RocketChat.settings.get('Accounts_AllowUsernameChange')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'setUsername' });\n\t\t}\n\n\t\tif (user.username === username || (user.username && user.username.toLowerCase() === username.toLowerCase())) {\n\t\t\treturn username;\n\t\t}\n\n\t\tlet nameValidation;\n\t\ttry {\n\t\t\tnameValidation = new RegExp(`^${ RocketChat.settings.get('UTF8_Names_Validation') }$`);\n\t\t} catch (error) {\n\t\t\tnameValidation = new RegExp('^[0-9a-zA-Z-_.]+$');\n\t\t}\n\n\t\tif (!nameValidation.test(username)) {\n\t\t\tthrow new Meteor.Error('username-invalid', `${ _.escape(username) } is not a valid username, use only letters, numbers, dots, hyphens and underscores`);\n\t\t}\n\n\t\tif (!RocketChat.checkUsernameAvailability(username)) {\n\t\t\tthrow new Meteor.Error('error-field-unavailable', `<strong>${ _.escape(username) }</strong> is already in use :(`, { method: 'setUsername', field: username });\n\t\t}\n\n\t\tif (!RocketChat.setUsername(user._id, username)) {\n\t\t\tthrow new Meteor.Error('error-could-not-change-username', 'Could not change username', { method: 'setUsername' });\n\t\t}\n\n\t\tif (!user.username) {\n\t\t\tMeteor.runAsUser(user._id, () => Meteor.call('joinDefaultChannels', joinDefaultChannelsSilenced));\n\t\t\tMeteor.defer(function() {\n\t\t\t\treturn RocketChat.callbacks.run('afterCreateUser', RocketChat.models.Users.findOneById(user._id));\n\t\t\t});\n\t\t}\n\n\t\treturn username;\n\t}\n});\n\nRocketChat.RateLimiter.limitMethod('setUsername', 1, 1000, {\n\tuserId() { return true; }\n});\n","Meteor.methods({\n\tsetEmail(email) {\n\n\t\tcheck (email, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'setEmail' });\n\t\t}\n\n\t\tconst user = Meteor.user();\n\n\t\tif (!RocketChat.settings.get('Accounts_AllowEmailChange')) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Changing email is not allowed', { method: 'setEmail', action: 'Changing_email' });\n\t\t}\n\n\t\tif (user.emails && user.emails[0] && user.emails[0].address === email) {\n\t\t\treturn email;\n\t\t}\n\n\t\tif (!RocketChat.setEmail(user._id, email)) {\n\t\t\tthrow new Meteor.Error('error-could-not-change-email', 'Could not change email', { method: 'setEmail' });\n\t\t}\n\n\t\treturn email;\n\t}\n});\n\nRocketChat.RateLimiter.limitMethod('setEmail', 1, 1000, {\n\tuserId(/*userId*/) { return true; }\n});\n","Meteor.methods({\n\tunarchiveRoom(rid) {\n\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'unarchiveRoom' });\n\t\t}\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\t\tif (!room) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'unarchiveRoom' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'unarchive-room', room._id)) {\n\t\t\tthrow new Meteor.Error('error-not-authorized', 'Not authorized', { method: 'unarchiveRoom' });\n\t\t}\n\n\t\treturn RocketChat.unarchiveRoom(rid);\n\t}\n});\n","Meteor.methods({\n\tunblockUser({rid, blocked}) {\n\n\t\tcheck(rid, String);\n\t\tcheck(blocked, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'blockUser' });\n\t\t}\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, Meteor.userId());\n\t\tconst subscription2 = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, blocked);\n\n\t\tif (!subscription || !subscription2) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'blockUser' });\n\t\t}\n\n\t\tRocketChat.models.Subscriptions.unsetBlockedByRoomId(rid, blocked, Meteor.userId());\n\n\t\treturn true;\n\t}\n});\n","import moment from 'moment';\n\nMeteor.methods({\n\tupdateMessage(message) {\n\n\t\tcheck(message, Match.ObjectIncluding({_id:String}));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'updateMessage' });\n\t\t}\n\n\t\tconst originalMessage = RocketChat.models.Messages.findOneById(message._id);\n\n\t\tif (!originalMessage || !originalMessage._id) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst hasPermission = RocketChat.authz.hasPermission(Meteor.userId(), 'edit-message', message.rid);\n\t\tconst editAllowed = RocketChat.settings.get('Message_AllowEditing');\n\t\tconst editOwn = originalMessage.u && originalMessage.u._id === Meteor.userId();\n\n\t\tif (!hasPermission && (!editAllowed || !editOwn)) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Message editing not allowed', { method: 'updateMessage', action: 'Message_editing' });\n\t\t}\n\n\t\tconst blockEditInMinutes = RocketChat.settings.get('Message_AllowEditing_BlockEditInMinutes');\n\t\tif (Match.test(blockEditInMinutes, Number) && blockEditInMinutes !== 0) {\n\t\t\tlet currentTsDiff;\n\t\t\tlet msgTs;\n\n\t\t\tif (Match.test(originalMessage.ts, Number)) {\n\t\t\t\tmsgTs = moment(originalMessage.ts);\n\t\t\t}\n\t\t\tif (msgTs) {\n\t\t\t\tcurrentTsDiff = moment().diff(msgTs, 'minutes');\n\t\t\t}\n\t\t\tif (currentTsDiff > blockEditInMinutes) {\n\t\t\t\tthrow new Meteor.Error('error-message-editing-blocked', 'Message editing is blocked', { method: 'updateMessage' });\n\t\t\t}\n\t\t}\n\n\t\t// It is possible to have an empty array as the attachments property, so ensure both things exist\n\t\tif (originalMessage.attachments && originalMessage.attachments.length > 0 && originalMessage.attachments[0].description !== undefined) {\n\t\t\tmessage.attachments = originalMessage.attachments;\n\t\t\tmessage.attachments[0].description = message.msg;\n\t\t\tmessage.msg = originalMessage.msg;\n\t\t}\n\n\t\tmessage.u = originalMessage.u;\n\n\t\treturn RocketChat.updateMessage(message, Meteor.user());\n\t}\n});\n","import {\n\tConversationRoomType,\n\tDirectMessageRoomType,\n\tFavoriteRoomType,\n\tPrivateRoomType,\n\tPublicRoomType,\n\tUnreadRoomType\n} from '../lib/roomTypes';\n\nRocketChat.roomTypes.add(new UnreadRoomType());\nRocketChat.roomTypes.add(new FavoriteRoomType());\nRocketChat.roomTypes.add(new ConversationRoomType());\nRocketChat.roomTypes.add(new PublicRoomType());\nRocketChat.roomTypes.add(new PrivateRoomType());\nRocketChat.roomTypes.add(new DirectMessageRoomType());\n"]}